Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@aurelia/platform"),t=require("@aurelia/platform-browser"),i=require("@aurelia/kernel"),s=require("@aurelia/runtime");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function n(e,t,i,s){var n,r=arguments.length,o=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,i,o):n(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o}function r(e,t){return function(i,s){t(i,s,e)}}function o(e,t){let s;function n(e,t){arguments.length>1&&(s.property=t),i.Metadata.define(l.name,c.create(t,s),e.constructor,t),i.Protocol.annotation.appendTo(e.constructor,l.keyFrom(t))}return arguments.length>1?(s={},void n(e,t)):"string"==typeof e?(s={},n):(s=void 0===e?{}:e,n)}function a(e){return e.startsWith(l.name)}const l={name:i.Protocol.annotation.keyFor("bindable"),keyFrom:e=>`${l.name}:${e}`,from(...e){const t={},i=Array.isArray;function s(e){t[e]=c.create(e)}return e.forEach((function(e){i(e)?e.forEach(s):e instanceof c?t[e.property]=e:void 0!==e&&Object.keys(e).forEach((i=>function(e,i){t[e]=i instanceof c?i:c.create(e,i)}(i,e[i])))})),t},for(e){let t;const s={add(n){let r,o;return"string"==typeof n?(r=n,o={property:r}):(r=n.property,o=n),t=c.create(r,o),i.Metadata.hasOwn(l.name,e,r)||i.Protocol.annotation.appendTo(e,l.keyFrom(r)),i.Metadata.define(l.name,t,e,r),s},mode:e=>(t.mode=e,s),callback:e=>(t.callback=e,s),attribute:e=>(t.attribute=e,s),primary:()=>(t.primary=!0,s),set:e=>(t.set=e,s)};return s},getAll(e){const t=l.name.length+1,s=[],n=i.getPrototypeChain(e);let r,o,c,h=n.length,u=0;for(;--h>=0;){c=n[h],r=i.Protocol.annotation.getKeys(c).filter(a),o=r.length;for(let e=0;e<o;++e)s[u++]=i.Metadata.getOwn(l.name,c,r[e].slice(t))}return s}};class c{constructor(e,t,i,s,n,r){this.attribute=e,this.callback=t,this.mode=i,this.primary=s,this.property=n,this.set=r}static create(e,t={}){return new c(i.firstDefined(t.attribute,i.kebabCase(e)),i.firstDefined(t.callback,`${e}Changed`),i.firstDefined(t.mode,s.BindingMode.toView),i.firstDefined(t.primary,!1),i.firstDefined(t.property,e),i.firstDefined(t.set,i.noop))}}class h{constructor(e,t,s,n,r){this.obj=e,this.propertyKey=t,this.set=n,this.$controller=r,this.value=void 0,this.oldValue=void 0,this.f=0;const o=e[s],a=e.propertyChanged,l=this.hasCb="function"==typeof o,c=this.hasCbAll="function"==typeof a,h=this.hasSetter=n!==i.noop;if(this.cb=l?o:i.noop,this.cbAll=c?a:i.noop,void 0!==this.cb||c||h){this.observing=!0;const i=e[t];this.value=h&&void 0!==i?n(i):i,this.createGetterSetter()}else this.observing=!1}get type(){return 1}getValue(){return this.value}setValue(e,t){if(this.hasSetter&&(e=this.set(e)),this.observing){const i=this.value;if(Object.is(e,i))return;this.value=e,this.oldValue=i,this.f=t,(null==this.$controller||this.$controller.isBound)&&(this.hasCb&&this.cb.call(this.obj,e,i,t),this.hasCbAll&&this.cbAll.call(this.obj,this.propertyKey,e,i,t)),this.queue.add(this)}else this.obj[this.propertyKey]=e}subscribe(e){if(!1==!this.observing){this.observing=!0;const e=this.obj[this.propertyKey];this.value=this.hasSetter?this.set(e):e,this.createGetterSetter()}this.subs.add(e)}flush(){u=this.oldValue,this.oldValue=this.value,this.subs.notify(this.value,u,this.f)}createGetterSetter(){Reflect.defineProperty(this.obj,this.propertyKey,{enumerable:!0,configurable:!0,get:()=>this.value,set:e=>{this.setValue(e,0)}})}}let u;s.subscriberCollection(h),s.withFlushQueue(h);class d{constructor(e,t,i,s){if(this.chars=e,this.repeat=t,this.isSymbol=i,this.isInverted=s,s)switch(e.length){case 0:this.has=this.hasOfNoneInverse;break;case 1:this.has=this.hasOfSingleInverse;break;default:this.has=this.hasOfMultipleInverse}else switch(e.length){case 0:this.has=this.hasOfNone;break;case 1:this.has=this.hasOfSingle;break;default:this.has=this.hasOfMultiple}}equals(e){return this.chars===e.chars&&this.repeat===e.repeat&&this.isSymbol===e.isSymbol&&this.isInverted===e.isInverted}hasOfMultiple(e){return this.chars.includes(e)}hasOfSingle(e){return this.chars===e}hasOfNone(e){return!1}hasOfMultipleInverse(e){return!this.chars.includes(e)}hasOfSingleInverse(e){return this.chars!==e}hasOfNoneInverse(e){return!0}}class p{constructor(){this.parts=i.emptyArray,this._pattern="",this.currentRecord={},this.partsRecord={}}get pattern(){const e=this._pattern;return""===e?null:e}set pattern(e){null==e?(this._pattern="",this.parts=i.emptyArray):(this._pattern=e,this.parts=this.partsRecord[e])}append(e,t){const{currentRecord:i}=this;void 0===i[e]?i[e]=t:i[e]+=t}next(e){const{currentRecord:t}=this;if(void 0!==t[e]){const{partsRecord:i}=this;void 0===i[e]?i[e]=[t[e]]:i[e].push(t[e]),t[e]=void 0}}}class g{constructor(e,...t){this.charSpec=e,this.nextStates=[],this.types=null,this.isEndpoint=!1,this.patterns=t}get pattern(){return this.isEndpoint?this.patterns[0]:null}findChild(e){const t=this.nextStates,i=t.length;let s=null;for(let n=0;n<i;++n)if(s=t[n],e.equals(s.charSpec))return s;return null}append(e,t){const{patterns:i}=this;i.includes(t)||i.push(t);let s=this.findChild(e);return null==s&&(s=new g(e,t),this.nextStates.push(s),e.repeat&&s.nextStates.push(s)),s}findMatches(e,t){const i=[],s=this.nextStates,n=s.length;let r=0,o=null,a=0,l=0;for(;a<n;++a)if(o=s[a],o.charSpec.has(e))if(i.push(o),r=o.patterns.length,l=0,o.charSpec.isSymbol)for(;l<r;++l)t.next(o.patterns[l]);else for(;l<r;++l)t.append(o.patterns[l],e);return i}}class f{constructor(e){this.text=e;const t=this.len=e.length,i=this.specs=[];for(let s=0;s<t;++s)i.push(new d(e[s],!1,!1,!1))}eachChar(e){const{len:t,specs:i}=this;for(let s=0;s<t;++s)e(i[s])}}class m{constructor(e){this.text="PART",this.spec=new d(e,!0,!1,!0)}eachChar(e){e(this.spec)}}class v{constructor(e){this.text=e,this.spec=new d(e,!1,!0,!1)}eachChar(e){e(this.spec)}}class b{constructor(){this.statics=0,this.dynamics=0,this.symbols=0}}const x=i.DI.createInterface("ISyntaxInterpreter",(e=>e.singleton(y)));class y{constructor(){this.rootState=new g(null),this.initialStates=[this.rootState]}add(e){let t=0;if(Array.isArray(e)){const i=e.length;for(;t<i;++t)this.add(e[t]);return}let i=this.rootState;const s=e,n=s.pattern,r=new b,o=this.parse(s,r),a=o.length,l=e=>{i=i.append(e,n)};for(t=0;t<a;++t)o[t].eachChar(l);i.types=r,i.isEndpoint=!0}interpret(e){const t=new p;let i=this.initialStates;const s=e.length;for(let n=0;n<s&&(i=this.getNextStates(i,e.charAt(n),t),0!==i.length);++n);if(i.sort(((e,t)=>{if(!e.isEndpoint)return t.isEndpoint?1:0;if(!t.isEndpoint)return-1;const i=e.types,s=t.types;return i.statics!==s.statics?s.statics-i.statics:i.dynamics!==s.dynamics?s.dynamics-i.dynamics:i.symbols!==s.symbols?s.symbols-i.symbols:0})),i.length>0){const e=i[0];e.charSpec.isSymbol||t.next(e.pattern),t.pattern=e.pattern}return t}getNextStates(e,t,i){const s=[];let n=null;const r=e.length;for(let o=0;o<r;++o)n=e[o],s.push(...n.findMatches(t,i));return s}parse(e,t){const i=[],s=e.pattern,n=s.length;let r=0,o=0,a="";for(;r<n;)a=s.charAt(r),e.symbols.includes(a)?r!==o?(i.push(new f(s.slice(o,r))),++t.statics,o=r):(i.push(new v(s.slice(o,r+1))),++t.symbols,o=++r):r===o&&"P"===a&&"PART"===s.slice(r,r+4)?(o=r+=4,i.push(new m(e.symbols)),++t.dynamics):++r;return o!==r&&(i.push(new f(s.slice(o,r))),++t.statics),i}}class w{constructor(e,t,i,s){this.rawName=e,this.rawValue=t,this.target=i,this.command=s}}const C=i.DI.createInterface("IAttributePattern"),k=i.DI.createInterface("IAttributeParser",(e=>e.singleton(A)));let A=class{constructor(e,t){this.interpreter=e,this.cache={};const i=this.patterns={};t.forEach((t=>{const s=O.getPatternDefinitions(t.constructor);e.add(s),s.forEach((e=>{i[e.pattern]=t}))}))}parse(e,t){let i=this.cache[e];null==i&&(i=this.cache[e]=this.interpreter.interpret(e));const s=i.pattern;return null==s?new w(e,t,e,null):this.patterns[s][s](e,t,i.parts)}};function T(...e){return function(t){return O.define(e,t)}}A=n([r(0,x),r(1,i.all(C))],A);class P{constructor(e){this.Type=e,this.name=void 0}register(e){i.Registration.singleton(C,this.Type).register(e)}}const O=Object.freeze({name:i.Protocol.resource.keyFor("attribute-pattern"),definitionAnnotationKey:"attribute-pattern-definitions",define(e,t){const s=new P(t),{name:n,definitionAnnotationKey:r}=O;return i.Metadata.define(n,s,t),i.Protocol.resource.appendTo(t,n),i.Protocol.annotation.set(t,r,e),i.Protocol.annotation.appendTo(t,r),t},getPatternDefinitions:e=>i.Protocol.annotation.get(e,O.definitionAnnotationKey)});exports.DotSeparatedAttributePattern=class{"PART.PART"(e,t,i){return new w(e,t,i[0],i[1])}"PART.PART.PART"(e,t,i){return new w(e,t,i[0],i[2])}},exports.DotSeparatedAttributePattern=n([T({pattern:"PART.PART",symbols:"."},{pattern:"PART.PART.PART",symbols:"."})],exports.DotSeparatedAttributePattern),exports.RefAttributePattern=class{ref(e,t,i){return new w(e,t,"element","ref")}"PART.ref"(e,t,i){return new w(e,t,i[0],"ref")}},exports.RefAttributePattern=n([T({pattern:"ref",symbols:""},{pattern:"PART.ref",symbols:"."})],exports.RefAttributePattern),exports.ColonPrefixedBindAttributePattern=class{":PART"(e,t,i){return new w(e,t,i[0],"bind")}},exports.ColonPrefixedBindAttributePattern=n([T({pattern:":PART",symbols:":"})],exports.ColonPrefixedBindAttributePattern),exports.AtPrefixedTriggerAttributePattern=class{"@PART"(e,t,i){return new w(e,t,i[0],"trigger")}},exports.AtPrefixedTriggerAttributePattern=n([T({pattern:"@PART",symbols:"@"})],exports.AtPrefixedTriggerAttributePattern);const S=E();function B(e,t,i){if(!0===S[t])return!0;if("string"!=typeof t)return!1;const s=t.slice(0,5);return S[t]="aria-"===s||"data-"===s||i.isStandardSvgAttribute(e,t)}function E(){return Object.create(null)}const R=i.IPlatform,I=i.DI.createInterface("ISVGAnalyzer",(e=>e.singleton($)));class ${isStandardSvgAttribute(e,t){return!1}}function D(e){const t=E();let i;for(i of e)t[i]=!0;return t}class M{constructor(e){this.svgElements=Object.assign(E(),{a:D(["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","target","transform","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),altGlyph:D(["class","dx","dy","externalResourcesRequired","format","glyphRef","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"]),altglyph:E(),altGlyphDef:D(["id","xml:base","xml:lang","xml:space"]),altglyphdef:E(),altGlyphItem:D(["id","xml:base","xml:lang","xml:space"]),altglyphitem:E(),animate:D(["accumulate","additive","attributeName","attributeType","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),animateColor:D(["accumulate","additive","attributeName","attributeType","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),animateMotion:D(["accumulate","additive","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keyPoints","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","origin","path","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","rotate","systemLanguage","to","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),animateTransform:D(["accumulate","additive","attributeName","attributeType","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","type","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),circle:D(["class","cx","cy","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","r","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"]),clipPath:D(["class","clipPathUnits","externalResourcesRequired","id","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"]),"color-profile":D(["id","local","name","rendering-intent","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),cursor:D(["externalResourcesRequired","id","requiredExtensions","requiredFeatures","systemLanguage","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"]),defs:D(["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"]),desc:D(["class","id","style","xml:base","xml:lang","xml:space"]),ellipse:D(["class","cx","cy","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rx","ry","style","systemLanguage","transform","xml:base","xml:lang","xml:space"]),feBlend:D(["class","height","id","in","in2","mode","result","style","width","x","xml:base","xml:lang","xml:space","y"]),feColorMatrix:D(["class","height","id","in","result","style","type","values","width","x","xml:base","xml:lang","xml:space","y"]),feComponentTransfer:D(["class","height","id","in","result","style","width","x","xml:base","xml:lang","xml:space","y"]),feComposite:D(["class","height","id","in","in2","k1","k2","k3","k4","operator","result","style","width","x","xml:base","xml:lang","xml:space","y"]),feConvolveMatrix:D(["bias","class","divisor","edgeMode","height","id","in","kernelMatrix","kernelUnitLength","order","preserveAlpha","result","style","targetX","targetY","width","x","xml:base","xml:lang","xml:space","y"]),feDiffuseLighting:D(["class","diffuseConstant","height","id","in","kernelUnitLength","result","style","surfaceScale","width","x","xml:base","xml:lang","xml:space","y"]),feDisplacementMap:D(["class","height","id","in","in2","result","scale","style","width","x","xChannelSelector","xml:base","xml:lang","xml:space","y","yChannelSelector"]),feDistantLight:D(["azimuth","elevation","id","xml:base","xml:lang","xml:space"]),feFlood:D(["class","height","id","result","style","width","x","xml:base","xml:lang","xml:space","y"]),feFuncA:D(["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"]),feFuncB:D(["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"]),feFuncG:D(["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"]),feFuncR:D(["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"]),feGaussianBlur:D(["class","height","id","in","result","stdDeviation","style","width","x","xml:base","xml:lang","xml:space","y"]),feImage:D(["class","externalResourcesRequired","height","id","preserveAspectRatio","result","style","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"]),feMerge:D(["class","height","id","result","style","width","x","xml:base","xml:lang","xml:space","y"]),feMergeNode:D(["id","xml:base","xml:lang","xml:space"]),feMorphology:D(["class","height","id","in","operator","radius","result","style","width","x","xml:base","xml:lang","xml:space","y"]),feOffset:D(["class","dx","dy","height","id","in","result","style","width","x","xml:base","xml:lang","xml:space","y"]),fePointLight:D(["id","x","xml:base","xml:lang","xml:space","y","z"]),feSpecularLighting:D(["class","height","id","in","kernelUnitLength","result","specularConstant","specularExponent","style","surfaceScale","width","x","xml:base","xml:lang","xml:space","y"]),feSpotLight:D(["id","limitingConeAngle","pointsAtX","pointsAtY","pointsAtZ","specularExponent","x","xml:base","xml:lang","xml:space","y","z"]),feTile:D(["class","height","id","in","result","style","width","x","xml:base","xml:lang","xml:space","y"]),feTurbulence:D(["baseFrequency","class","height","id","numOctaves","result","seed","stitchTiles","style","type","width","x","xml:base","xml:lang","xml:space","y"]),filter:D(["class","externalResourcesRequired","filterRes","filterUnits","height","id","primitiveUnits","style","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"]),font:D(["class","externalResourcesRequired","horiz-adv-x","horiz-origin-x","horiz-origin-y","id","style","vert-adv-y","vert-origin-x","vert-origin-y","xml:base","xml:lang","xml:space"]),"font-face":D(["accent-height","alphabetic","ascent","bbox","cap-height","descent","font-family","font-size","font-stretch","font-style","font-variant","font-weight","hanging","id","ideographic","mathematical","overline-position","overline-thickness","panose-1","slope","stemh","stemv","strikethrough-position","strikethrough-thickness","underline-position","underline-thickness","unicode-range","units-per-em","v-alphabetic","v-hanging","v-ideographic","v-mathematical","widths","x-height","xml:base","xml:lang","xml:space"]),"font-face-format":D(["id","string","xml:base","xml:lang","xml:space"]),"font-face-name":D(["id","name","xml:base","xml:lang","xml:space"]),"font-face-src":D(["id","xml:base","xml:lang","xml:space"]),"font-face-uri":D(["id","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),foreignObject:D(["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","width","x","xml:base","xml:lang","xml:space","y"]),g:D(["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"]),glyph:D(["arabic-form","class","d","glyph-name","horiz-adv-x","id","lang","orientation","style","unicode","vert-adv-y","vert-origin-x","vert-origin-y","xml:base","xml:lang","xml:space"]),glyphRef:D(["class","dx","dy","format","glyphRef","id","style","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"]),glyphref:E(),hkern:D(["g1","g2","id","k","u1","u2","xml:base","xml:lang","xml:space"]),image:D(["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","preserveAspectRatio","requiredExtensions","requiredFeatures","style","systemLanguage","transform","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"]),line:D(["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","x1","x2","xml:base","xml:lang","xml:space","y1","y2"]),linearGradient:D(["class","externalResourcesRequired","gradientTransform","gradientUnits","id","spreadMethod","style","x1","x2","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y1","y2"]),marker:D(["class","externalResourcesRequired","id","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","style","viewBox","xml:base","xml:lang","xml:space"]),mask:D(["class","externalResourcesRequired","height","id","maskContentUnits","maskUnits","requiredExtensions","requiredFeatures","style","systemLanguage","width","x","xml:base","xml:lang","xml:space","y"]),metadata:D(["id","xml:base","xml:lang","xml:space"]),"missing-glyph":D(["class","d","horiz-adv-x","id","style","vert-adv-y","vert-origin-x","vert-origin-y","xml:base","xml:lang","xml:space"]),mpath:D(["externalResourcesRequired","id","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),path:D(["class","d","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","pathLength","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"]),pattern:D(["class","externalResourcesRequired","height","id","patternContentUnits","patternTransform","patternUnits","preserveAspectRatio","requiredExtensions","requiredFeatures","style","systemLanguage","viewBox","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"]),polygon:D(["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","points","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"]),polyline:D(["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","points","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"]),radialGradient:D(["class","cx","cy","externalResourcesRequired","fx","fy","gradientTransform","gradientUnits","id","r","spreadMethod","style","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),rect:D(["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rx","ry","style","systemLanguage","transform","width","x","xml:base","xml:lang","xml:space","y"]),script:D(["externalResourcesRequired","id","type","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),set:D(["attributeName","attributeType","begin","dur","end","externalResourcesRequired","fill","id","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),stop:D(["class","id","offset","style","xml:base","xml:lang","xml:space"]),style:D(["id","media","title","type","xml:base","xml:lang","xml:space"]),svg:D(["baseProfile","class","contentScriptType","contentStyleType","externalResourcesRequired","height","id","onabort","onactivate","onclick","onerror","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onresize","onscroll","onunload","onzoom","preserveAspectRatio","requiredExtensions","requiredFeatures","style","systemLanguage","version","viewBox","width","x","xml:base","xml:lang","xml:space","y","zoomAndPan"]),switch:D(["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"]),symbol:D(["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","preserveAspectRatio","style","viewBox","xml:base","xml:lang","xml:space"]),text:D(["class","dx","dy","externalResourcesRequired","id","lengthAdjust","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","textLength","transform","x","xml:base","xml:lang","xml:space","y"]),textPath:D(["class","externalResourcesRequired","id","lengthAdjust","method","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","spacing","startOffset","style","systemLanguage","textLength","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space"]),title:D(["class","id","style","xml:base","xml:lang","xml:space"]),tref:D(["class","dx","dy","externalResourcesRequired","id","lengthAdjust","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","textLength","x","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"]),tspan:D(["class","dx","dy","externalResourcesRequired","id","lengthAdjust","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","textLength","x","xml:base","xml:lang","xml:space","y"]),use:D(["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"]),view:D(["externalResourcesRequired","id","preserveAspectRatio","viewBox","viewTarget","xml:base","xml:lang","xml:space","zoomAndPan"]),vkern:D(["g1","g2","id","k","u1","u2","xml:base","xml:lang","xml:space"])}),this.svgPresentationElements=D(["a","altGlyph","animate","animateColor","circle","clipPath","defs","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","filter","font","foreignObject","g","glyph","glyphRef","image","line","linearGradient","marker","mask","missing-glyph","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","switch","symbol","text","textPath","tref","tspan","use"]),this.svgPresentationAttributes=D(["alignment-baseline","baseline-shift","clip-path","clip-rule","clip","color-interpolation-filters","color-interpolation","color-profile","color-rendering","color","cursor","direction","display","dominant-baseline","enable-background","fill-opacity","fill-rule","fill","filter","flood-color","flood-opacity","font-family","font-size-adjust","font-size","font-stretch","font-style","font-variant","font-weight","glyph-orientation-horizontal","glyph-orientation-vertical","image-rendering","kerning","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","pointer-events","shape-rendering","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","stroke","text-anchor","text-decoration","text-rendering","unicode-bidi","visibility","word-spacing","writing-mode"]),this.SVGElement=e.globalThis.SVGElement;const t=e.document.createElement("div");if(t.innerHTML="<svg><altGlyph /></svg>","altglyph"===t.firstElementChild.nodeName){const e=this.svgElements;let t=e.altGlyph;e.altGlyph=e.altglyph,e.altglyph=t,t=e.altGlyphDef,e.altGlyphDef=e.altglyphdef,e.altglyphdef=t,t=e.altGlyphItem,e.altGlyphItem=e.altglyphitem,e.altglyphitem=t,t=e.glyphRef,e.glyphRef=e.glyphref,e.glyphref=t}}static register(e){return i.Registration.singleton(I,this).register(e)}isStandardSvgAttribute(e,t){var i;return e instanceof this.SVGElement&&(!0===this.svgPresentationElements[e.nodeName]&&!0===this.svgPresentationAttributes[t]||!0===(null===(i=this.svgElements[e.nodeName])||void 0===i?void 0:i[t]))}}M.inject=[R];const j=i.DI.createInterface("IAttrMapper",(e=>e.singleton(L)));class L{constructor(e){this.svg=e,this.fns=[],this.tagAttrMap=E(),this.globalAttrMap=E(),this.useMapping({LABEL:{for:"htmlFor"},IMG:{usemap:"useMap"},INPUT:{maxlength:"maxLength",minlength:"minLength",formaction:"formAction",formenctype:"formEncType",formmethod:"formMethod",formnovalidate:"formNoValidate",formtarget:"formTarget",inputmode:"inputMode"},TEXTAREA:{maxlength:"maxLength"},TD:{rowspan:"rowSpan",colspan:"colSpan"},TH:{rowspan:"rowSpan",colspan:"colSpan"}}),this.useGlobalMapping({accesskey:"accessKey",contenteditable:"contentEditable",tabindex:"tabIndex",textcontent:"textContent",innerhtml:"innerHTML",scrolltop:"scrollTop",scrollleft:"scrollLeft",readonly:"readOnly"})}static get inject(){return[I]}useMapping(e){var t,i;let s,n,r,o;for(r in e)for(o in s=e[r],n=null!==(t=(i=this.tagAttrMap)[r])&&void 0!==t?t:i[r]=E(),s){if(void 0!==n[o])throw V(o,r);n[o]=s[o]}}useGlobalMapping(e){const t=this.globalAttrMap;for(const i in e){if(void 0!==t[i])throw V(i,"*");t[i]=e[i]}}useTwoWay(e){this.fns.push(e)}isTwoWay(e,t){return function(e,t){switch(e.nodeName){case"INPUT":switch(e.type){case"checkbox":case"radio":return"checked"===t;default:return"value"===t||"files"===t||"value-as-number"===t||"value-as-date"===t}case"TEXTAREA":case"SELECT":return"value"===t;default:switch(t){case"textcontent":case"innerhtml":return e.hasAttribute("contenteditable");case"scrolltop":case"scrollleft":return!0;default:return!1}}}(e,t)||this.fns.length>0&&this.fns.some((i=>i(e,t)))}map(e,t){var i,s,n;return null!==(n=null!==(s=null===(i=this.tagAttrMap[e.nodeName])||void 0===i?void 0:i[t])&&void 0!==s?s:this.globalAttrMap[t])&&void 0!==n?n:B(e,t,this.svg)?t:null}}function V(e,t){return new Error(`Attribute ${e} has been already registered for ${"*"===t?"all elements":`<${t}/>`}`)}class N{constructor(e,t,i,s,n){this.sourceExpression=e,this.target=t,this.targetProperty=i,this.locator=n,this.interceptor=this,this.isBound=!1,this.targetObserver=s.getAccessor(t,i)}callSource(e){const t=this.$scope.overrideContext;t.$event=e;const i=this.sourceExpression.evaluate(8,this.$scope,this.locator,null);return Reflect.deleteProperty(t,"$event"),i}$bind(e,t){if(this.isBound){if(this.$scope===t)return;this.interceptor.$unbind(2|e)}this.$scope=t,this.sourceExpression.hasBind&&this.sourceExpression.bind(e,t,this.interceptor),this.targetObserver.setValue((e=>this.interceptor.callSource(e)),e,this.target,this.targetProperty),this.isBound=!0}$unbind(e){this.isBound&&(this.sourceExpression.hasUnbind&&this.sourceExpression.unbind(e,this.$scope,this.interceptor),this.$scope=void 0,this.targetObserver.setValue(null,e,this.target,this.targetProperty),this.isBound=!1)}observeProperty(e,t){}handleChange(e,t,i){}}class F{constructor(e,t,i,s,n){this.platform=e,this.observerLocator=t,this.obj=i,this.propertyKey=s,this.targetAttribute=n,this.value=null,this.oldValue=null,this.hasChanges=!1,this.type=7,this.f=0}getValue(){return this.value}setValue(e,t){this.value=e,this.hasChanges=e!==this.oldValue,0==(256&t)&&this.flushChanges(t)}flushChanges(e){if(this.hasChanges){this.hasChanges=!1;const e=this.value,t=this.targetAttribute;switch(this.oldValue=e,t){case"class":this.obj.classList.toggle(this.propertyKey,!!e);break;case"style":{let t="",i=e;"string"==typeof i&&i.includes("!important")&&(t="important",i=i.replace("!important","")),this.obj.style.setProperty(this.propertyKey,i,t);break}default:null==e?this.obj.removeAttribute(t):this.obj.setAttribute(t,String(e))}}}handleMutation(e){let t=!1;for(let i=0,s=e.length;s>i;++i){const s=e[i];if("attributes"===s.type&&s.attributeName===this.propertyKey){t=!0;break}}if(t){let e;switch(this.targetAttribute){case"class":e=this.obj.classList.contains(this.propertyKey);break;case"style":e=this.obj.style.getPropertyValue(this.propertyKey);break;default:throw new Error(`Unsupported observation of attribute: ${this.targetAttribute}`)}e!==this.value&&(this.oldValue=this.value,this.value=e,this.hasChanges=!1,this.f=0,this.queue.add(this))}}subscribe(e){this.subs.add(e)&&1===this.subs.count&&(this.value=this.oldValue=this.obj.getAttribute(this.propertyKey),q(this.obj.ownerDocument.defaultView.MutationObserver,this.obj,this))}unsubscribe(e){this.subs.remove(e)&&0===this.subs.count&&z(this.obj,this)}flush(){H=this.oldValue,this.oldValue=this.value,this.subs.notify(this.value,H,this.f)}}s.subscriberCollection(F),s.withFlushQueue(F);const q=(e,t,i)=>{void 0===t.$eMObservers&&(t.$eMObservers=new Set),void 0===t.$mObserver&&(t.$mObserver=new e(W)).observe(t,{attributes:!0}),t.$eMObservers.add(i)},z=(e,t)=>{const i=e.$eMObservers;return!(!i||!i.delete(t))&&(0===i.size&&(e.$mObserver.disconnect(),e.$mObserver=void 0),!0)},W=e=>{e[0].target.$eMObservers.forEach(U,e)};function U(e){e.handleMutation(this)}let H;class K{constructor(e){this.b=e}handleChange(e,t,i){const s=this.b;e!==s.sourceExpression.evaluate(i,s.$scope,s.locator,null)&&s.updateSource(e,i)}}const{oneTime:G,toView:Q,fromView:_}=s.BindingMode,X=Q|G,Y={reusable:!1,preempt:!0};class Z{constructor(e,t,i,s,n,r,o){this.sourceExpression=e,this.targetAttribute=i,this.targetProperty=s,this.mode=n,this.observerLocator=r,this.locator=o,this.interceptor=this,this.isBound=!1,this.$scope=null,this.task=null,this.targetSubscriber=null,this.persistentFlags=0,this.value=void 0,this.target=t,this.$platform=o.get(R)}updateTarget(e,t){this.targetObserver.setValue(e,t|=this.persistentFlags,this.target,this.targetProperty)}updateSource(e,t){this.sourceExpression.assign(t|=this.persistentFlags,this.$scope,this.locator,e)}handleChange(e,t,i){if(!this.isBound)return;const s=this.interceptor,n=this.sourceExpression,r=this.$scope,o=this.locator,a=0==(2&(i|=this.persistentFlags))&&(4&this.targetObserver.type)>0;if(10082!==n.$kind||this.obs.count>1){const t=0==(this.mode&G);t&&this.obs.version++,e=n.evaluate(i,r,o,s),t&&this.obs.clear(!1)}let l;e!==this.value&&(this.value=e,a?(l=this.task,this.task=this.$platform.domWriteQueue.queueTask((()=>{this.task=null,s.updateTarget(e,i)}),Y),null==l||l.cancel()):s.updateTarget(e,i))}$bind(e,t,i){var s;if(this.isBound){if(this.$scope===t)return;this.interceptor.$unbind(2|e)}this.persistentFlags=961&e,this.$scope=t,this.projection=i;let n=this.sourceExpression;n.hasBind&&n.bind(e,t,this.interceptor);let r=this.targetObserver;r||(r=this.targetObserver=new F(this.$platform,this.observerLocator,this.target,this.targetProperty,this.targetAttribute)),n=this.sourceExpression;const o=this.mode,a=this.interceptor;if(o&X){a.updateTarget(this.value=n.evaluate(e,t,this.locator,(o&Q)>0?a:null),e)}o&_&&r.subscribe(null!==(s=this.targetSubscriber)&&void 0!==s?s:this.targetSubscriber=new K(a)),this.isBound=!0}$unbind(e){var t;this.isBound&&(this.persistentFlags=0,this.sourceExpression.hasUnbind&&this.sourceExpression.unbind(e,this.$scope,this.interceptor),this.$scope=null,this.value=void 0,this.targetSubscriber&&this.targetObserver.unsubscribe(this.targetSubscriber),null===(t=this.task)||void 0===t||t.cancel(),this.task=null,this.obs.clear(!0),this.isBound=!1)}}s.connectable(Z);const{toView:J}=s.BindingMode,ee={reusable:!1,preempt:!0};class te{constructor(e,t,i,s,n,r,o){this.observerLocator=e,this.interpolation=t,this.target=i,this.targetProperty=s,this.mode=n,this.locator=r,this.taskQueue=o,this.interceptor=this,this.isBound=!1,this.$scope=void 0,this.task=null,this.targetObserver=e.getAccessor(i,s);const a=t.expressions,l=this.partBindings=Array(a.length);for(let t=0,n=a.length;t<n;++t)l[t]=new ie(a[t],i,s,r,e,this)}updateTarget(e,t){const i=this.partBindings,s=this.interpolation.parts,n=i.length;let r="";if(1===n)r=s[0]+i[0].value+s[1];else{r=s[0];for(let e=0;n>e;++e)r+=i[e].value+s[e+1]}const o=this.targetObserver;if(0==(2&t)&&(4&o.type)>0){const e=this.task;this.task=this.taskQueue.queueTask((()=>{this.task=null,o.setValue(r,t,this.target,this.targetProperty)}),ee),null==e||e.cancel()}else o.setValue(r,t,this.target,this.targetProperty)}$bind(e,t){if(this.isBound){if(this.$scope===t)return;this.interceptor.$unbind(e)}this.isBound=!0,this.$scope=t;const i=this.partBindings;for(let s=0,n=i.length;n>s;++s)i[s].$bind(e,t);this.updateTarget(void 0,e)}$unbind(e){var t;if(!this.isBound)return;this.isBound=!1,this.$scope=void 0;const i=this.partBindings;for(let t=0,s=i.length;t<s;++t)i[t].interceptor.$unbind(e);null===(t=this.task)||void 0===t||t.cancel(),this.task=null}}class ie{constructor(e,t,i,n,r,o){this.sourceExpression=e,this.target=t,this.targetProperty=i,this.locator=n,this.observerLocator=r,this.owner=o,this.interceptor=this,this.mode=s.BindingMode.toView,this.value="",this.task=null,this.isBound=!1}handleChange(e,t,i){if(!this.isBound)return;const s=this.sourceExpression,n=this.obs;if(!(10082===s.$kind&&1===n.count)){const t=(this.mode&J)>0;t&&n.version++,e=s.evaluate(i,this.$scope,this.locator,t?this.interceptor:null),t&&n.clear(!1)}e!=this.value&&(this.value=e,e instanceof Array&&this.observeCollection(e),this.owner.updateTarget(e,i))}handleCollectionChange(e,t){this.owner.updateTarget(void 0,t)}$bind(e,t){if(this.isBound){if(this.$scope===t)return;this.interceptor.$unbind(e)}this.isBound=!0,this.$scope=t,this.sourceExpression.hasBind&&this.sourceExpression.bind(e,t,this.interceptor);const i=this.value=this.sourceExpression.evaluate(e,t,this.locator,(this.mode&J)>0?this.interceptor:null);i instanceof Array&&this.observeCollection(i)}$unbind(e){this.isBound&&(this.isBound=!1,this.sourceExpression.hasUnbind&&this.sourceExpression.unbind(e,this.$scope,this.interceptor),this.$scope=void 0,this.obs.clear(!0))}}s.connectable(ie);class se{constructor(e,t,i,n,r,o){this.sourceExpression=e,this.target=t,this.locator=i,this.observerLocator=n,this.p=r,this.strict=o,this.interceptor=this,this.mode=s.BindingMode.toView,this.value="",this.task=null,this.isBound=!1}updateTarget(e,t){var i,s;const n=this.target,r=this.p.Node,o=this.value;this.value=e,o instanceof r&&(null===(i=o.parentNode)||void 0===i||i.removeChild(o)),e instanceof r?(n.textContent="",null===(s=n.parentNode)||void 0===s||s.insertBefore(e,n)):n.textContent=String(e)}handleChange(e,t,i){var s;if(!this.isBound)return;const n=this.sourceExpression,r=this.obs;if(!(10082===n.$kind&&1===r.count)){const t=(this.mode&J)>0;t&&r.version++,e=n.evaluate(i|=this.strict?1:0,this.$scope,this.locator,t?this.interceptor:null),t&&r.clear(!1)}if(e===this.value)return null===(s=this.task)||void 0===s||s.cancel(),void(this.task=null);0==(2&i)?this.queueUpdate(e,i):this.updateTarget(e,i)}handleCollectionChange(){this.queueUpdate(this.value,0)}$bind(e,t){if(this.isBound){if(this.$scope===t)return;this.interceptor.$unbind(e)}this.isBound=!0,this.$scope=t,this.sourceExpression.hasBind&&this.sourceExpression.bind(e,t,this.interceptor);const i=this.value=this.sourceExpression.evaluate(e|=this.strict?1:0,t,this.locator,(this.mode&J)>0?this.interceptor:null);i instanceof Array&&this.observeCollection(i),this.updateTarget(i,e)}$unbind(e){var t;this.isBound&&(this.isBound=!1,this.sourceExpression.hasUnbind&&this.sourceExpression.unbind(e,this.$scope,this.interceptor),this.$scope=void 0,this.obs.clear(!0),null===(t=this.task)||void 0===t||t.cancel(),this.task=null)}queueUpdate(e,t){const i=this.task;this.task=this.p.domWriteQueue.queueTask((()=>{this.task=null,this.updateTarget(e,t)}),ee),null==i||i.cancel()}}s.connectable(se);class ne{constructor(e,t,i,s,n=!1){this.sourceExpression=e,this.targetProperty=t,this.observerLocator=i,this.locator=s,this.toBindingContext=n,this.interceptor=this,this.isBound=!1,this.$scope=void 0,this.task=null,this.target=null}handleChange(e,t,i){if(!this.isBound)return;const s=this.target,n=this.targetProperty,r=s[n];this.obs.version++,e=this.sourceExpression.evaluate(i,this.$scope,this.locator,this.interceptor),this.obs.clear(!1),e!==r&&(s[n]=e)}$bind(e,t){if(this.isBound){if(this.$scope===t)return;this.interceptor.$unbind(2|e)}this.$scope=t,this.target=this.toBindingContext?t.bindingContext:t.overrideContext;const i=this.sourceExpression;i.hasBind&&i.bind(e,t,this.interceptor),this.target[this.targetProperty]=this.sourceExpression.evaluate(2|e,t,this.locator,this.interceptor),this.isBound=!0}$unbind(e){if(!this.isBound)return;const t=this.sourceExpression;t.hasUnbind&&t.unbind(e,this.$scope,this.interceptor),this.$scope=void 0,this.obs.clear(!0),this.isBound=!1}}s.connectable(ne);const{oneTime:re,toView:oe,fromView:ae}=s.BindingMode,le=oe|re,ce={reusable:!1,preempt:!0};class he{constructor(e,t,i,s,n,r,o){this.sourceExpression=e,this.target=t,this.targetProperty=i,this.mode=s,this.observerLocator=n,this.locator=r,this.taskQueue=o,this.interceptor=this,this.isBound=!1,this.$scope=void 0,this.targetObserver=void 0,this.persistentFlags=0,this.task=null,this.targetSubscriber=null}updateTarget(e,t){this.targetObserver.setValue(e,t|=this.persistentFlags,this.target,this.targetProperty)}updateSource(e,t){this.sourceExpression.assign(t|=this.persistentFlags,this.$scope,this.locator,e)}handleChange(e,t,i){if(!this.isBound)return;const s=this.interceptor,n=this.sourceExpression,r=this.$scope,o=this.locator,a=0==(2&(i|=this.persistentFlags))&&(4&this.targetObserver.type)>0,l=this.obs;if(10082!==n.$kind||l.count>1){const t=this.mode>re;t&&l.version++,e=n.evaluate(i,r,o,s),t&&l.clear(!1)}if(a){const t=this.task;this.task=this.taskQueue.queueTask((()=>{s.updateTarget(e,i),this.task=null}),ce),null==t||t.cancel()}else s.updateTarget(e,i)}$bind(e,t){var i;if(this.isBound){if(this.$scope===t)return;this.interceptor.$unbind(2|e)}this.persistentFlags=961&(e|=1),this.$scope=t;let s=this.sourceExpression;s.hasBind&&s.bind(e,t,this.interceptor);const n=this.mode;let r=this.targetObserver;if(!r){const e=this.observerLocator;r=n&ae?e.getObserver(this.target,this.targetProperty):e.getAccessor(this.target,this.targetProperty),this.targetObserver=r}s=this.sourceExpression;const o=this.interceptor,a=(n&oe)>0;n&le&&o.updateTarget(s.evaluate(e,t,this.locator,a?o:null),e),n&ae&&(r.subscribe(null!==(i=this.targetSubscriber)&&void 0!==i?i:this.targetSubscriber=new K(o)),a||o.updateSource(r.getValue(this.target,this.targetProperty),e)),this.isBound=!0}$unbind(e){if(!this.isBound)return;this.persistentFlags=0,this.sourceExpression.hasUnbind&&this.sourceExpression.unbind(e,this.$scope,this.interceptor),this.$scope=void 0;const t=this.task;this.targetSubscriber&&this.targetObserver.unsubscribe(this.targetSubscriber),null!=t&&(t.cancel(),this.task=null),this.obs.clear(!0),this.isBound=!1}}s.connectable(he);class ue{constructor(e,t,i){this.sourceExpression=e,this.target=t,this.locator=i,this.interceptor=this,this.isBound=!1,this.$scope=void 0}$bind(e,t){if(this.isBound){if(this.$scope===t)return;this.interceptor.$unbind(2|e)}this.$scope=t,this.sourceExpression.hasBind&&this.sourceExpression.bind(e,t,this),this.sourceExpression.assign(e,this.$scope,this.locator,this.target),this.isBound=!0}$unbind(e){if(!this.isBound)return;let t=this.sourceExpression;t.evaluate(e,this.$scope,this.locator,null)===this.target&&t.assign(e,this.$scope,this.locator,null),t=this.sourceExpression,t.hasUnbind&&t.unbind(e,this.$scope,this.interceptor),this.$scope=void 0,this.isBound=!1}observeProperty(e,t){}handleChange(e,t,i){}}const de=i.DI.createInterface("IAppTask");class pe{constructor(e,t,i){this.c=void 0,this.slot=e,this.k=t,this.cb=i}register(e){return this.c=e.register(i.Registration.instance(de,this))}run(){const e=this.k,t=this.cb;return null===e?t():t(this.c.get(e))}}const ge=Object.freeze({beforeCreate:fe("beforeCreate"),hydrating:fe("hydrating"),hydrated:fe("hydrated"),beforeActivate:fe("beforeActivate"),afterActivate:fe("afterActivate"),beforeDeactivate:fe("beforeDeactivate"),afterDeactivate:fe("afterDeactivate")});function fe(e){return function(t,i){return"function"==typeof i?new pe(e,t,i):new pe(e,null,t)}}function me(e){return e.startsWith(ve.name)}const ve={name:i.Protocol.annotation.keyFor("children-observer"),keyFrom:e=>`${ve.name}:${e}`,from(...e){const t={},i=Array.isArray;function s(e){t[e]=xe.create(e)}return e.forEach((function(e){i(e)?e.forEach(s):e instanceof xe?t[e.property]=e:void 0!==e&&Object.keys(e).forEach((i=>function(e,i){t[e]=xe.create(e,i)}(i,e)))})),t},getAll(e){const t=ve.name.length+1,s=[],n=i.getPrototypeChain(e);let r,o,a,l=n.length,c=0;for(;--l>=0;){a=n[l],r=i.Protocol.annotation.getKeys(a).filter(me),o=r.length;for(let e=0;e<o;++e)s[c++]=i.Metadata.getOwn(ve.name,a,r[e].slice(t))}return s}},be={childList:!0};class xe{constructor(e,t,i,s,n,r){this.callback=e,this.property=t,this.options=i,this.query=s,this.filter=n,this.map=r}static create(e,t={}){var s;return new xe(i.firstDefined(t.callback,`${e}Changed`),i.firstDefined(t.property,e),null!==(s=t.options)&&void 0!==s?s:be,t.query,t.filter,t.map)}}function ye(e){return e.host.childNodes}function we(e,t,i){return!!i}function Ce(e,t,i){return i}exports.ChildrenObserver=class{constructor(e,t,i,s,n=ye,r=we,o=Ce,a){this.controller=e,this.obj=t,this.propertyKey=i,this.query=n,this.filter=r,this.map=o,this.options=a,this.observing=!1,this.children=void 0,this.observer=void 0,this.callback=t[s],Reflect.defineProperty(this.obj,this.propertyKey,{enumerable:!0,configurable:!0,get:()=>this.getValue(),set:()=>{}})}getValue(){return this.observing?this.children:this.get()}setValue(e){}start(){var e;this.observing||(this.observing=!0,this.children=this.get(),(null!==(e=this.observer)&&void 0!==e?e:this.observer=new this.controller.host.ownerDocument.defaultView.MutationObserver((()=>{this.onChildrenChanged()}))).observe(this.controller.host,this.options))}stop(){this.observing&&(this.observing=!1,this.observer.disconnect(),this.children=i.emptyArray)}onChildrenChanged(){this.children=this.get(),void 0!==this.callback&&this.callback.call(this.obj),this.subs.notify(this.children,void 0,0)}get(){return function(e,t,i,s){var n;const r=t(e),o=r.length,a=[];let l,c,h,u=0;for(;u<o;++u)l=r[u],c=Me.for(l,ke),h=null!==(n=null==c?void 0:c.viewModel)&&void 0!==n?n:null,i(l,c,h)&&a.push(s(l,c,h));return a}(this.controller,this.query,this.filter,this.map)}},exports.ChildrenObserver=n([s.subscriberCollection()],exports.ChildrenObserver);const ke={optional:!0};function Ae(e){return function(t){return Oe.define(e,t)}}function Te(e){return function(t){return Oe.define("string"==typeof e?{isTemplateController:!0,name:e}:{isTemplateController:!0,...e},t)}}class Pe{constructor(e,t,i,s,n,r,o,a,l){this.Type=e,this.name=t,this.aliases=i,this.key=s,this.defaultBindingMode=n,this.isTemplateController=r,this.bindables=o,this.noMultiBindings=a,this.watches=l}static create(e,t){let n,r;return"string"==typeof e?(n=e,r={name:n}):(n=e.name,r=e),new Pe(t,i.firstDefined(Oe.getAnnotation(t,"name"),n),i.mergeArrays(Oe.getAnnotation(t,"aliases"),r.aliases,t.aliases),Oe.keyFrom(n),i.firstDefined(Oe.getAnnotation(t,"defaultBindingMode"),r.defaultBindingMode,t.defaultBindingMode,s.BindingMode.toView),i.firstDefined(Oe.getAnnotation(t,"isTemplateController"),r.isTemplateController,t.isTemplateController,!1),l.from(...l.getAll(t),Oe.getAnnotation(t,"bindables"),t.bindables,r.bindables),i.firstDefined(Oe.getAnnotation(t,"noMultiBindings"),r.noMultiBindings,t.noMultiBindings,!1),i.mergeArrays(Ee.getAnnotation(t),t.watches))}register(e){const{Type:t,key:n,aliases:r}=this;i.Registration.transient(n,t).register(e),i.Registration.aliasTo(n,t).register(e),s.registerAliases(r,Oe,n,e)}}const Oe={name:i.Protocol.resource.keyFor("custom-attribute"),keyFrom:e=>`${Oe.name}:${e}`,isType:e=>"function"==typeof e&&i.Metadata.hasOwn(Oe.name,e),for(e,t){var i;return null!==(i=Qt(e,Oe.keyFrom(t)))&&void 0!==i?i:void 0},define(e,t){const s=Pe.create(e,t);return i.Metadata.define(Oe.name,s,s.Type),i.Metadata.define(Oe.name,s,s),i.Protocol.resource.appendTo(t,Oe.name),s.Type},getDefinition(e){const t=i.Metadata.getOwn(Oe.name,e);if(void 0===t)throw new Error(`No definition found for type ${e.name}`);return t},annotate(e,t,s){i.Metadata.define(i.Protocol.annotation.keyFor(t),s,e)},getAnnotation:(e,t)=>i.Metadata.getOwn(i.Protocol.annotation.keyFor(t),e)};class Se{constructor(e,t){this.expression=e,this.callback=t}}const Be=i.emptyArray,Ee={name:i.Protocol.annotation.keyFor("watch"),add(e,t){let s=i.Metadata.getOwn(Ee.name,e);null==s&&i.Metadata.define(Ee.name,s=[],e),s.push(t)},getAnnotation(e){var t;return null!==(t=i.Metadata.getOwn(Ee.name,e))&&void 0!==t?t:Be}};function Re(e){return function(t){return Me.define(e,t)}}const Ie=new WeakMap;class $e{constructor(e,t,i,s,n,r,o,a,l,c,h,u,d,p,g,f,m,v,b,x){this.Type=e,this.name=t,this.aliases=i,this.key=s,this.cache=n,this.template=r,this.instructions=o,this.dependencies=a,this.injectable=l,this.needsCompile=c,this.surrogates=h,this.bindables=u,this.childrenObservers=d,this.containerless=p,this.isStrictBinding=g,this.shadowOptions=f,this.hasSlots=m,this.enhance=v,this.watches=b,this.processContent=x}static create(e,t=null){if(null===t){const s=e;if("string"==typeof s)throw new Error(`Cannot create a custom element definition with only a name and no type: ${e}`);const n=i.fromDefinitionOrDefault("name",s,Me.generateName);return t="function"==typeof s.Type?s.Type:Me.generateType(i.pascalCase(n)),new $e(t,n,i.mergeArrays(s.aliases),i.fromDefinitionOrDefault("key",s,(()=>Me.keyFrom(n))),i.fromDefinitionOrDefault("cache",s,(()=>0)),i.fromDefinitionOrDefault("template",s,(()=>null)),i.mergeArrays(s.instructions),i.mergeArrays(s.dependencies),i.fromDefinitionOrDefault("injectable",s,(()=>null)),i.fromDefinitionOrDefault("needsCompile",s,(()=>!0)),i.mergeArrays(s.surrogates),l.from(s.bindables),ve.from(s.childrenObservers),i.fromDefinitionOrDefault("containerless",s,(()=>!1)),i.fromDefinitionOrDefault("isStrictBinding",s,(()=>!1)),i.fromDefinitionOrDefault("shadowOptions",s,(()=>null)),i.fromDefinitionOrDefault("hasSlots",s,(()=>!1)),i.fromDefinitionOrDefault("enhance",s,(()=>!1)),i.fromDefinitionOrDefault("watches",s,(()=>i.emptyArray)),i.fromAnnotationOrTypeOrDefault("processContent",t,(()=>null)))}if("string"==typeof e)return new $e(t,e,i.mergeArrays(Me.getAnnotation(t,"aliases"),t.aliases),Me.keyFrom(e),i.fromAnnotationOrTypeOrDefault("cache",t,(()=>0)),i.fromAnnotationOrTypeOrDefault("template",t,(()=>null)),i.mergeArrays(Me.getAnnotation(t,"instructions"),t.instructions),i.mergeArrays(Me.getAnnotation(t,"dependencies"),t.dependencies),i.fromAnnotationOrTypeOrDefault("injectable",t,(()=>null)),i.fromAnnotationOrTypeOrDefault("needsCompile",t,(()=>!0)),i.mergeArrays(Me.getAnnotation(t,"surrogates"),t.surrogates),l.from(...l.getAll(t),Me.getAnnotation(t,"bindables"),t.bindables),ve.from(...ve.getAll(t),Me.getAnnotation(t,"childrenObservers"),t.childrenObservers),i.fromAnnotationOrTypeOrDefault("containerless",t,(()=>!1)),i.fromAnnotationOrTypeOrDefault("isStrictBinding",t,(()=>!1)),i.fromAnnotationOrTypeOrDefault("shadowOptions",t,(()=>null)),i.fromAnnotationOrTypeOrDefault("hasSlots",t,(()=>!1)),i.fromAnnotationOrTypeOrDefault("enhance",t,(()=>!1)),i.mergeArrays(Ee.getAnnotation(t),t.watches),i.fromAnnotationOrTypeOrDefault("processContent",t,(()=>null)));const s=i.fromDefinitionOrDefault("name",e,Me.generateName);return new $e(t,s,i.mergeArrays(Me.getAnnotation(t,"aliases"),e.aliases,t.aliases),Me.keyFrom(s),i.fromAnnotationOrDefinitionOrTypeOrDefault("cache",e,t,(()=>0)),i.fromAnnotationOrDefinitionOrTypeOrDefault("template",e,t,(()=>null)),i.mergeArrays(Me.getAnnotation(t,"instructions"),e.instructions,t.instructions),i.mergeArrays(Me.getAnnotation(t,"dependencies"),e.dependencies,t.dependencies),i.fromAnnotationOrDefinitionOrTypeOrDefault("injectable",e,t,(()=>null)),i.fromAnnotationOrDefinitionOrTypeOrDefault("needsCompile",e,t,(()=>!0)),i.mergeArrays(Me.getAnnotation(t,"surrogates"),e.surrogates,t.surrogates),l.from(...l.getAll(t),Me.getAnnotation(t,"bindables"),t.bindables,e.bindables),ve.from(...ve.getAll(t),Me.getAnnotation(t,"childrenObservers"),t.childrenObservers,e.childrenObservers),i.fromAnnotationOrDefinitionOrTypeOrDefault("containerless",e,t,(()=>!1)),i.fromAnnotationOrDefinitionOrTypeOrDefault("isStrictBinding",e,t,(()=>!1)),i.fromAnnotationOrDefinitionOrTypeOrDefault("shadowOptions",e,t,(()=>null)),i.fromAnnotationOrDefinitionOrTypeOrDefault("hasSlots",e,t,(()=>!1)),i.fromAnnotationOrDefinitionOrTypeOrDefault("enhance",e,t,(()=>!1)),i.mergeArrays(e.watches,Ee.getAnnotation(t),t.watches),i.fromAnnotationOrDefinitionOrTypeOrDefault("processContent",e,t,(()=>null)))}static getOrCreate(e){if(e instanceof $e)return e;if(Ie.has(e))return Ie.get(e);const t=$e.create(e);return Ie.set(e,t),i.Metadata.define(Me.name,t,t.Type),t}register(e){const{Type:t,key:n,aliases:r}=this;e.has(n,!1)||(i.Registration.transient(n,t).register(e),i.Registration.aliasTo(n,t).register(e),s.registerAliases(r,Me,n,e))}}const De={name:void 0,searchParents:!1,optional:!1},Me={name:i.Protocol.resource.keyFor("custom-element"),keyFrom:e=>`${Me.name}:${e}`,isType:e=>"function"==typeof e&&i.Metadata.hasOwn(Me.name,e),for(e,t=De){if(void 0===t.name&&!0!==t.searchParents){const i=Qt(e,Me.name);if(null===i){if(!0===t.optional)return null;throw new Error("The provided node is not a custom element or containerless host.")}return i}if(void 0!==t.name){if(!0!==t.searchParents){const i=Qt(e,Me.name);if(null===i)throw new Error("The provided node is not a custom element or containerless host.");return i.is(t.name)?i:void 0}let i=e,s=!1;for(;null!==i;){const e=Qt(i,Me.name);if(null!==e&&(s=!0,e.is(t.name)))return e;i=ti(i)}if(s)return;throw new Error("The provided node does does not appear to be part of an Aurelia app DOM tree, or it was added to the DOM in a way that Aurelia cannot properly resolve its position in the component tree.")}let i=e;for(;null!==i;){const e=Qt(i,Me.name);if(null!==e)return e;i=ti(i)}throw new Error("The provided node does does not appear to be part of an Aurelia app DOM tree, or it was added to the DOM in a way that Aurelia cannot properly resolve its position in the component tree.")},define(e,t){const s=$e.create(e,t);return i.Metadata.define(Me.name,s,s.Type),i.Metadata.define(Me.name,s,s),i.Protocol.resource.appendTo(s.Type,Me.name),s.Type},getDefinition(e){const t=i.Metadata.getOwn(Me.name,e);if(void 0===t)throw new Error(`No definition found for type ${e.name}`);return t},annotate(e,t,s){i.Metadata.define(i.Protocol.annotation.keyFor(t),s,e)},getAnnotation:(e,t)=>i.Metadata.getOwn(i.Protocol.annotation.keyFor(t),e),generateName:function(){let e=0;return function(){return"unnamed-"+ ++e}}(),createInjectable(){const e=function(t,s,n){return i.DI.getOrCreateAnnotationParamTypes(t)[n]=e,t};return e.register=function(t){return{resolve:(t,i)=>i.has(e,!0)?i.get(e):null}},e},generateType:function(){const e={value:"",writable:!1,enumerable:!1,configurable:!0},t={};return function(i,s=t){const n=class{};return e.value=i,Reflect.defineProperty(n,"name",e),s!==t&&Object.assign(n.prototype,s),n}}()},je=i.Protocol.annotation.keyFor("processContent");function Le(e,t){"string"==typeof t&&(t=e[t]);const i=typeof t;if("function"!==i)throw new Error(`Invalid @processContent hook. Expected the hook to be a function (when defined in a class, it needs to be a static function) but got a ${i}.`);return t}const Ve=i.DI.createInterface("IViewFactory");class Ne{constructor(e,t){this.name=e,this.context=t,this.isCaching=!1,this.cache=null,this.cacheSize=-1,this.container=t.container}setCacheSize(e,t){e&&("*"===e?e=Ne.maxCacheSize:"string"==typeof e&&(e=parseInt(e,10)),-1!==this.cacheSize&&t||(this.cacheSize=e)),this.cache=this.cacheSize>0?[]:null,this.isCaching=this.cacheSize>0}canReturnToCache(e){return null!=this.cache&&this.cache.length<this.cacheSize}tryReturnToCache(e){return!!this.canReturnToCache(e)&&(this.cache.push(e),!0)}create(e,t){const i=this.cache;let s;return null!=i&&i.length>0?(s=i.pop(),s):(s=St.forSyntheticView(null,this.context,this,e,t),s)}}Ne.maxCacheSize=65535;const Fe=new WeakSet;function qe(e){return!Fe.has(e)}function ze(e){return Fe.add(e),$e.create(e)}const We={name:i.Protocol.resource.keyFor("views"),has:e=>"function"==typeof e&&(i.Metadata.hasOwn(We.name,e)||"$views"in e),get(e){if("function"==typeof e&&"$views"in e){const t=e.$views.filter(qe).map(ze);for(const i of t)We.add(e,i)}let t=i.Metadata.getOwn(We.name,e);return void 0===t&&i.Metadata.define(We.name,t=[],e),t},add(e,t){const s=$e.create(t);let n=i.Metadata.getOwn(We.name,e);return void 0===n?i.Metadata.define(We.name,n=[s],e):n.push(s),n}};const Ue=i.DI.createInterface("IViewLocator",(e=>e.singleton(He)));class He{constructor(){this.modelInstanceToBoundComponent=new WeakMap,this.modelTypeToUnboundComponent=new Map}getViewComponentForObject(e,t){if(e){const i=We.has(e.constructor)?We.get(e.constructor):[],s="function"==typeof t?t(e,i):this.getViewName(i,t);return this.getOrCreateBoundComponent(e,i,s)}return null}getOrCreateBoundComponent(e,t,i){let s,n=this.modelInstanceToBoundComponent.get(e);if(void 0===n?(n={},this.modelInstanceToBoundComponent.set(e,n)):s=n[i],void 0===s){const r=this.getOrCreateUnboundComponent(e,t,i);s=Me.define(Me.getDefinition(r),class extends r{constructor(){super(e)}}),n[i]=s}return s}getOrCreateUnboundComponent(e,t,i){let n,r=this.modelTypeToUnboundComponent.get(e.constructor);if(void 0===r?(r={},this.modelTypeToUnboundComponent.set(e.constructor,r)):n=r[i],void 0===n){n=Me.define(this.getView(t,i),class{constructor(e){this.viewModel=e}define(e,t,i){const n=this.viewModel;if(e.scope=s.Scope.fromParent(e.scope,n),void 0!==n.define)return n.define(e,t,i)}});const o=n.prototype;"hydrating"in e&&(o.hydrating=function(e){this.viewModel.hydrating(e)}),"hydrated"in e&&(o.hydrated=function(e){this.viewModel.hydrated(e)}),"created"in e&&(o.created=function(e){this.viewModel.created(e)}),"binding"in e&&(o.binding=function(e,t,i){return this.viewModel.binding(e,t,i)}),"bound"in e&&(o.bound=function(e,t,i){return this.viewModel.bound(e,t,i)}),"attaching"in e&&(o.attaching=function(e,t,i){return this.viewModel.attaching(e,t,i)}),"attached"in e&&(o.attached=function(e,t){return this.viewModel.attached(e,t)}),"detaching"in e&&(o.detaching=function(e,t,i){return this.viewModel.detaching(e,t,i)}),"unbinding"in e&&(o.unbinding=function(e,t,i){return this.viewModel.unbinding(e,t,i)}),"dispose"in e&&(o.dispose=function(){this.viewModel.dispose()}),r[i]=n}return n}getViewName(e,t){return t||(1===e.length?e[0].name:"default-view")}getView(e,t){const i=e.find((e=>e.name===t));if(void 0===i)throw new Error(`Could not find view: ${t}`);return i}}const Ke=new WeakMap,Ge=new WeakMap;let Qe=0;function _e(e,t){const i=$e.getOrCreate(e);let s=Ke.get(i);void 0===s&&Ke.set(i,s=new WeakMap);let n=s.get(t);return void 0===n&&s.set(t,n=new Je(i,t)),n}_e.count=0,Reflect.defineProperty(_e,"count",{get:()=>Qe});const Xe=new WeakMap,Ye=Symbol(),Ze=new WeakMap;class Je{constructor(e,t){var i,s;this.definition=e,this.fragment=null,this.factory=void 0,this.isCompiled=!1,this.renderers=Object.create(null),this.compiledDefinition=void 0,++Qe,this.container=t;const n=null!==(i=(s=t.root)[Ye])&&void 0!==i?i:s[Ye]=t.root.getAll(qi);let r,o=0;for(;o<n.length;++o)r=n[o],this.renderers[r.instructionType]=r;this.root=t.root,this.platform=t.get(R)}get id(){return this.container.id}compile(e){let t;if(this.isCompiled)return this;this.isCompiled=!0;const i=this.definition;if(i.needsCompile){const s=this.container,n=s.get(Fi);let r=Ze.get(s.root);null==r&&Ze.set(s.root,r=new WeakMap);let o=r.get(i);null==o?r.set(i,o=n.compile(i,s,e)):s.register(...o.dependencies),t=this.compiledDefinition=o}else t=this.compiledDefinition=i;if(t.register(this.container),Ge.has(t))this.fragment=Ge.get(t);else{const e=this.platform.document,i=t.template;if(null===i||!0===this.definition.enhance)this.fragment=null;else if(i instanceof this.platform.Node)"TEMPLATE"===i.nodeName?this.fragment=e.adoptNode(i.content):(this.fragment=e.adoptNode(e.createDocumentFragment())).appendChild(i);else{const t=e.createElement("template");e.adoptNode(t.content),"string"==typeof i&&(t.innerHTML=i),this.fragment=t.content}Ge.set(t,this.fragment)}return this}getViewFactory(e){let t=this.factory;return void 0===t&&(void 0===e&&(e=this.definition.name),t=this.factory=new Ne(e,this)),t}createNodes(){if(!0===this.compiledDefinition.enhance)return new ri(this.platform,this.compiledDefinition.template);if(null===this.fragment){let e=Xe.get(this.platform);return void 0===e&&Xe.set(this.platform,e=new ri(this.platform,this.platform.document.createDocumentFragment())),e}return new ri(this.platform,this.fragment.cloneNode(!0))}render(e,t,i,s,n){if(i.length!==s.instructions.length)throw new Error(`The compiled template is not aligned with the render instructions. There are ${i.length} targets and ${s.instructions.length} instructions.`);for(let n=0;n<i.length;++n)this.renderChildren(e,s.instructions[n],t,i[n]);null!=n&&this.renderChildren(e,s.surrogates,t,n)}renderChildren(e,t,i,s){for(let n=0;n<t.length;++n){const r=t[n];this.renderers[r.type].render(e,this,i,s,r)}}dispose(){throw new Error("Cannot dispose a render context")}}class et{constructor(e){this.obj=e,this.value="",this.oldValue="",this.doNotCache=!0,this.nameIndex={},this.version=0,this.hasChanges=!1,this.isActive=!1,this.type=6}getValue(){return this.value}setValue(e,t){this.value=e,this.hasChanges=e!==this.oldValue,0==(256&t)&&this.flushChanges(t)}flushChanges(e){if(this.hasChanges){this.hasChanges=!1;const e=this.value,t=this.nameIndex;let i=this.version;this.oldValue=e;const s=tt(e);if(s.length>0&&this.addClassesAndUpdateIndex(s),this.version+=1,0===i)return;i-=1;for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&t[e]===i&&this.obj.classList.remove(e)}}addClassesAndUpdateIndex(e){const t=this.obj;for(let i=0,s=e.length;i<s;i++){const s=e[i];0!==s.length&&(this.nameIndex[s]=this.version,t.classList.add(s))}}}function tt(e){if("string"==typeof e)return it(e);if("object"!=typeof e)return i.emptyArray;if(e instanceof Array){const t=e.length;if(t>0){const i=[];for(let s=0;s<t;++s)i.push(...tt(e[s]));return i}return i.emptyArray}const t=[];for(const i in e)Boolean(e[i])&&(i.includes(" ")?t.push(...it(i)):t.push(i));return t}function it(e){const t=e.match(/\S+/g);return null===t?i.emptyArray:t}class st{constructor(e){this.modules=e}register(e){var t;const i=Object.assign({},...this.modules),s=Oe.define({name:"class",bindables:["value"]},((t=class{constructor(e){this.element=e}binding(){this.valueChanged()}valueChanged(){this.element.className=this.value?tt(this.value).map((e=>i[e]||e)).join(" "):""}}).inject=[Xt],t));e.register(s)}}const nt=i.DI.createInterface("IShadowDOMStyleFactory",(e=>e.cachedCallback((e=>ht.supported(e.get(R))?e.get(ot):e.get(at)))));class rt{constructor(e){this.css=e}register(e){const t=e.get(ct),s=e.get(nt);e.register(i.Registration.instance(lt,s.createStyles(this.css,t)))}}let ot=class{constructor(e){this.p=e,this.cache=new Map}createStyles(e,t){return new ht(this.p,e,this.cache,t)}};ot=n([r(0,R)],ot);let at=class{constructor(e){this.p=e}createStyles(e,t){return new ut(this.p,e,t)}};at=n([r(0,R)],at);const lt=i.DI.createInterface("IShadowDOMStyles"),ct=i.DI.createInterface("IShadowDOMGlobalStyles",(e=>e.instance({applyTo:i.noop})));class ht{constructor(e,t,i,s=null){this.sharedStyles=s,this.styleSheets=t.map((t=>{let s;return t instanceof e.CSSStyleSheet?s=t:(s=i.get(t),void 0===s&&(s=new e.CSSStyleSheet,s.replaceSync(t),i.set(t,s))),s}))}static supported(e){return"adoptedStyleSheets"in e.ShadowRoot.prototype}applyTo(e){null!==this.sharedStyles&&this.sharedStyles.applyTo(e),e.adoptedStyleSheets=[...e.adoptedStyleSheets,...this.styleSheets]}}class ut{constructor(e,t,i=null){this.p=e,this.localStyles=t,this.sharedStyles=i}applyTo(e){const t=this.localStyles,i=this.p;for(let s=t.length-1;s>-1;--s){const n=i.document.createElement("style");n.innerHTML=t[s],e.prepend(n)}null!==this.sharedStyles&&this.sharedStyles.applyTo(e)}}const dt={shadowDOM:e=>ge.beforeCreate(i.IContainer,(t=>{if(null!=e.sharedStyles){const s=t.get(nt);t.register(i.Registration.instance(ct,s.createStyles(e.sharedStyles,null)))}}))},{enter:pt,exit:gt}=s.ConnectableSwitcher,{wrap:ft,unwrap:mt}=s.ProxyObservable;class vt{constructor(e,t,i,s,n){this.obj=e,this.observerLocator=t,this.get=i,this.cb=s,this.useProxy=n,this.interceptor=this,this.value=void 0,this.isBound=!1,this.running=!1}handleChange(){this.run()}handleCollectionChange(){this.run()}$bind(){this.isBound||(this.isBound=!0,this.compute())}$unbind(){this.isBound&&(this.isBound=!1,this.obs.clear(!0))}run(){if(!this.isBound||this.running)return;const e=this.obj,t=this.value,i=this.compute();Object.is(i,t)||this.cb.call(e,i,t,e)}compute(){this.running=!0,this.obs.version++;try{return pt(this),this.value=mt(this.get.call(void 0,this.useProxy?ft(this.obj):this.obj,this))}finally{this.obs.clear(!1),this.running=!1,gt(this)}}}class bt{constructor(e,t,i,s,n){this.scope=e,this.locator=t,this.observerLocator=i,this.expression=s,this.callback=n,this.interceptor=this,this.isBound=!1,this.obj=e.bindingContext}handleChange(e){const t=this.expression,i=this.obj,s=this.value;10082===t.$kind&&1===this.obs.count||(this.obs.version++,e=t.evaluate(0,this.scope,this.locator,this),this.obs.clear(!1)),Object.is(e,s)||(this.value=e,this.callback.call(i,e,s,i))}$bind(){this.isBound||(this.isBound=!0,this.obs.version++,this.value=this.expression.evaluate(0,this.scope,this.locator,this),this.obs.clear(!1))}$unbind(){this.isBound&&(this.isBound=!1,this.obs.clear(!0),this.value=void 0)}}s.connectable(vt),s.connectable(bt);const xt=i.DI.createInterface("ILifecycleHooks");class yt{constructor(e,t){this.definition=e,this.instance=t}}class wt{constructor(e,t){this.Type=e,this.propertyNames=t}static create(e,t){const i=new Set;let s=t.prototype;for(;s!==Object.prototype;){for(const e of Object.getOwnPropertyNames(s))"constructor"!==e&&i.add(e);s=Object.getPrototypeOf(s)}return new wt(t,i)}register(e){i.Registration.singleton(xt,this.Type).register(e)}}const Ct=new WeakMap,kt={name:i.Protocol.annotation.keyFor("lifecycle-hooks"),define(e,t){const s=wt.create(e,t);return i.Metadata.define(kt.name,s,t),i.Protocol.resource.appendTo(t,kt.name),s.Type},resolve(e){let t=Ct.get(e);if(void 0===t){t=new At;const s=e.root,n=s.id===e.id?e.getAll(xt):e.has(xt,!1)?[...s.getAll(xt),...e.getAll(xt)]:s.getAll(xt);let r,o,a,l,c;for(r of n)for(l of(o=i.Metadata.getOwn(kt.name,r.constructor),a=new yt(o,r),o.propertyNames))c=t[l],void 0===c?t[l]=[a]:c.push(a)}return t}};class At{}var Tt;!function(e){e[e.none=0]="none",e[e.host=1]="host",e[e.shadowRoot=2]="shadowRoot",e[e.location=3]="location"}(Tt||(Tt={}));const Pt={optional:!0},Ot=new WeakMap;class St{constructor(e,t,s,n,r,o,a,l,c){switch(this.root=e,this.ctxCt=t,this.container=s,this.vmKind=n,this.flags=r,this.definition=o,this.viewFactory=a,this.viewModel=l,this.host=c,this.id=i.nextId("au$component"),this.head=null,this.tail=null,this.next=null,this.parent=null,this.bindings=null,this.children=null,this.hasLockedScope=!1,this.isStrictBinding=!1,this.scope=null,this.isBound=!1,this.hostController=null,this.mountTarget=0,this.shadowRoot=null,this.nodes=null,this.context=null,this.location=null,this.lifecycleHooks=null,this.state=0,this.logger=null,this.debug=!1,this.fullyNamed=!1,this.childrenObs=i.emptyArray,this.$initiator=null,this.$flags=0,this.$resolve=void 0,this.$reject=void 0,this.$promise=void 0,this.activatingStack=0,this.detachingStack=0,this.unbindingStack=0,null===e&&s.has(Wt,!0)&&(this.root=s.get(Wt)),this.platform=s.get(R),n){case 1:case 0:this.hooks=new Dt(l);break;case 2:this.hooks=Dt.none}}get isActive(){return(3&this.state)>0&&0==(4&this.state)}get name(){var e;if(null===this.parent)switch(this.vmKind){case 1:return`[${this.definition.name}]`;case 0:return this.definition.name;case 2:return this.viewFactory.name}switch(this.vmKind){case 1:return`${this.parent.name}>[${this.definition.name}]`;case 0:return`${this.parent.name}>${this.definition.name}`;case 2:return this.viewFactory.name===(null===(e=this.parent.definition)||void 0===e?void 0:e.name)?`${this.parent.name}[view]`:`${this.parent.name}[view:${this.viewFactory.name}]`}}static getCached(e){return Ot.get(e)}static getCachedOrThrow(e){const t=St.getCached(e);if(void 0===t)throw new Error(`There is no cached controller for the provided ViewModel: ${String(e)}`);return t}static forCustomElement(e,t,s,n,r,o,a=0,l=!0,c){if(Ot.has(n))return Ot.get(n);c=null!=c?c:Me.getDefinition(n.constructor);const h=new St(e,t,s,0,a,c,null,n,r);return s.register(...c.dependencies),s.registerResolver(Ft,new i.InstanceProvider("IHydrationContext",new qt(h,o,t.get(i.optional(Ft))))),Ot.set(n,h),l&&h.hydrateCustomElement(o),h}static forCustomAttribute(e,t,i,s,n=0,r){if(Ot.has(i))return Ot.get(i);r=null!=r?r:Oe.getDefinition(i.constructor);const o=new St(e,t,t,1,n,r,null,i,s);return Ot.set(i,o),o.hydrateCustomAttribute(),o}static forSyntheticView(e,t,i,s=0,n){const r=new St(e,t.container,t.container,2,s,null,i,null,null);return r.parent=null!=n?n:null,r.hydrateSynthetic(t),r}hydrateCustomElement(e){var t;this.logger=this.container.get(i.ILogger).root,this.debug=this.logger.config.level<=1,this.debug&&(this.logger=this.logger.scopeTo(this.name));const n=this.container,r=this.flags,o=this.viewModel;let a=this.definition;if(this.scope=s.Scope.create(o,null,!0),a.watches.length>0&&$t(this,n,a,o),Et(this,a,r,o),this.childrenObs=function(e,t,s,n){const r=t.childrenObservers,o=Object.getOwnPropertyNames(r),a=o.length;if(a>0){const t=Bt(n),i=[];let s,l,c=0;for(;c<a;++c)s=o[c],null==t[s]&&(l=r[s],i[i.length]=t[s]=new exports.ChildrenObserver(e,n,s,l.callback,l.query,l.filter,l.map,l.options));return i}return i.emptyArray}(this,a,0,o),this.hooks.hasDefine){this.debug&&this.logger.trace("invoking define() hook");const e=o.define(this,this.ctxCt,a);void 0!==e&&e!==a&&(a=$e.getOrCreate(e))}this.context=_e(a,n),this.lifecycleHooks=kt.resolve(n),a.register(n),null!==a.injectable&&n.registerResolver(a.injectable,new i.InstanceProvider("definition.injectable",o)),(null===(t=this.root)||void 0===t?void 0:t.controller)!==this&&(this.hydrate(e),this.hydrateChildren())}hydrate(e){this.hooks.hasHydrating&&(this.debug&&this.logger.trace("invoking hydrating() hook"),this.viewModel.hydrating(this));const t=this.context.compile(e),{shadowOptions:i,isStrictBinding:s,hasSlots:n,containerless:r}=t.compiledDefinition;if(this.isStrictBinding=s,null!==(this.hostController=Me.for(this.host,Pt))&&(this.host=this.platform.document.createElement(this.context.definition.name)),_t(this.host,Me.name,this),_t(this.host,this.definition.key,this),null!==i||n){if(r)throw new Error("You cannot combine the containerless custom element option with Shadow DOM.");_t(this.shadowRoot=this.host.attachShadow(null!=i?i:Mt),Me.name,this),_t(this.shadowRoot,this.definition.key,this),this.mountTarget=2}else r?(_t(this.location=si(this.host),Me.name,this),_t(this.location,this.definition.key,this),this.mountTarget=3):this.mountTarget=1;this.viewModel.$controller=this,this.nodes=t.createNodes(),this.hooks.hasHydrated&&(this.debug&&this.logger.trace("invoking hydrated() hook"),this.viewModel.hydrated(this))}hydrateChildren(){const e=this.nodes.findTargets();this.context.render(this.flags,this,e,this.context.compiledDefinition,this.host),this.hooks.hasCreated&&(this.debug&&this.logger.trace("invoking created() hook"),this.viewModel.created(this))}hydrateCustomAttribute(){const e=this.definition,t=this.viewModel;e.watches.length>0&&$t(this,this.container,e,t),Et(this,e,this.flags,t),t.$controller=this,this.lifecycleHooks=kt.resolve(this.container),this.hooks.hasCreated&&(this.debug&&this.logger.trace("invoking created() hook"),this.viewModel.created(this))}hydrateSynthetic(e){this.context=e;const t=e.compile(null),i=t.compiledDefinition;this.isStrictBinding=i.isStrictBinding;const s=(this.nodes=t.createNodes()).findTargets();t.render(this.flags,this,s,i,void 0)}activate(e,t,s,n){var r;switch(this.state){case 0:case 8:if(null!==t&&!t.isActive)return;this.state=1;break;case 2:return;case 32:throw new Error(`${this.name} trying to activate a controller that is disposed.`);default:throw new Error(`${this.name} unexpected state: ${Vt(this.state)}.`)}switch(this.parent=t,this.debug&&!this.fullyNamed&&(this.fullyNamed=!0,(null!==(r=this.logger)&&void 0!==r?r:this.logger=this.container.get(i.ILogger).root.scopeTo(this.name)).trace("activate()")),s|=2,this.vmKind){case 0:this.scope.parentScope=null!=n?n:null;break;case 1:this.scope=null!=n?n:null;break;case 2:if(null==n)throw new Error("Scope is null or undefined");this.hasLockedScope||(this.scope=n)}if(this.isStrictBinding&&(s|=1),this.$initiator=e,this.$flags=s,this.enterActivating(),this.hooks.hasBinding){this.debug&&this.logger.trace("binding()");const e=this.viewModel.binding(this.$initiator,this.parent,this.$flags);if(e instanceof Promise)return this.ensurePromise(),e.then((()=>{this.bind()})).catch((e=>{this.reject(e)})),this.$promise}return this.bind(),this.$promise}bind(){if(this.debug&&this.logger.trace("bind()"),this.childrenObs.length)for(let e=0;e<this.childrenObs.length;++e)this.childrenObs[e].start();if(null!==this.bindings)for(let e=0;e<this.bindings.length;++e)this.bindings[e].$bind(this.$flags,this.scope);if(this.hooks.hasBound){this.debug&&this.logger.trace("bound()");const e=this.viewModel.bound(this.$initiator,this.parent,this.$flags);if(e instanceof Promise)return this.ensurePromise(),void e.then((()=>{this.isBound=!0,this.attach()})).catch((e=>{this.reject(e)}))}this.isBound=!0,this.attach()}append(...e){switch(this.mountTarget){case 1:this.host.append(...e);break;case 2:this.shadowRoot.append(...e);break;case 3:for(let t=0;t<e.length;++t)this.location.parentNode.insertBefore(e[t],this.location)}}attach(){var e;if(this.debug&&this.logger.trace("attach()"),null!==this.hostController)switch(this.mountTarget){case 1:case 2:this.hostController.append(this.host);break;case 3:this.hostController.append(this.location.$start,this.location)}switch(this.mountTarget){case 1:this.nodes.appendTo(this.host,null===(e=this.definition)||void 0===e?void 0:e.enhance);break;case 2:{const e=this.container;(e.has(lt,!1)?e.get(lt):e.get(ct)).applyTo(this.shadowRoot),this.nodes.appendTo(this.shadowRoot);break}case 3:this.nodes.insertBefore(this.location)}if(this.hooks.hasAttaching){this.debug&&this.logger.trace("attaching()");const e=this.viewModel.attaching(this.$initiator,this.parent,this.$flags);e instanceof Promise&&(this.ensurePromise(),this.enterActivating(),e.then((()=>{this.leaveActivating()})).catch((e=>{this.reject(e)})))}if(null!==this.children)for(let e=0;e<this.children.length;++e)this.children[e].activate(this.$initiator,this,this.$flags,this.scope);this.leaveActivating()}deactivate(e,t,i){switch(-17&this.state){case 2:this.state=4;break;case 0:case 8:case 32:case 40:return;default:throw new Error(`${this.name} unexpected state: ${Vt(this.state)}.`)}if(this.debug&&this.logger.trace("deactivate()"),this.$initiator=e,this.$flags=i,e===this&&this.enterDetaching(),this.childrenObs.length)for(let e=0;e<this.childrenObs.length;++e)this.childrenObs[e].stop();if(null!==this.children)for(let t=0;t<this.children.length;++t)this.children[t].deactivate(e,this,i);if(this.hooks.hasDetaching){this.debug&&this.logger.trace("detaching()");const t=this.viewModel.detaching(this.$initiator,this.parent,this.$flags);t instanceof Promise&&(this.ensurePromise(),e.enterDetaching(),t.then((()=>{e.leaveDetaching()})).catch((t=>{e.reject(t)})))}if(null===e.head?e.head=this:e.tail.next=this,e.tail=this,e===this)return this.leaveDetaching(),this.$promise}removeNodes(){switch(this.vmKind){case 0:case 2:this.nodes.remove(),this.nodes.unlink()}if(null!==this.hostController)switch(this.mountTarget){case 1:case 2:this.host.remove();break;case 3:this.location.$start.remove(),this.location.remove()}}unbind(){this.debug&&this.logger.trace("unbind()");const e=4|this.$flags;if(null!==this.bindings)for(let t=0;t<this.bindings.length;++t)this.bindings[t].$unbind(e);switch(this.parent=null,this.vmKind){case 1:this.scope=null;break;case 2:this.hasLockedScope||(this.scope=null),16!=(16&this.state)||this.viewFactory.tryReturnToCache(this)||this.$initiator!==this||this.dispose();break;case 0:this.scope.parentScope=null}32==(32&e)&&this.$initiator===this&&this.dispose(),this.state=32&this.state|8,this.$initiator=null,this.resolve()}ensurePromise(){void 0===this.$promise&&(this.$promise=new Promise(((e,t)=>{this.$resolve=e,this.$reject=t})),this.$initiator!==this&&this.parent.ensurePromise())}resolve(){if(void 0!==this.$promise){const e=this.$resolve;this.$resolve=this.$reject=this.$promise=void 0,e()}}reject(e){if(void 0!==this.$promise){const t=this.$reject;this.$resolve=this.$reject=this.$promise=void 0,t(e)}this.$initiator!==this&&this.parent.reject(e)}enterActivating(){++this.activatingStack,this.$initiator!==this&&this.parent.enterActivating()}leaveActivating(){if(0==--this.activatingStack){if(this.hooks.hasAttached){this.debug&&this.logger.trace("attached()");const e=this.viewModel.attached(this.$initiator,this.$flags);if(e instanceof Promise)return this.ensurePromise(),void e.then((()=>{this.state=2,this.resolve(),this.$initiator!==this&&this.parent.leaveActivating()})).catch((e=>{this.reject(e)}))}this.state=2,this.resolve()}this.$initiator!==this&&this.parent.leaveActivating()}enterDetaching(){++this.detachingStack}leaveDetaching(){if(0==--this.detachingStack){this.debug&&this.logger.trace("detach()"),this.enterUnbinding(),this.removeNodes();let e=this.$initiator.head;for(;null!==e;){if(e!==this&&(e.debug&&e.logger.trace("detach()"),e.removeNodes()),e.hooks.hasUnbinding){e.debug&&e.logger.trace("unbinding()");const t=e.viewModel.unbinding(e.$initiator,e.parent,e.$flags);t instanceof Promise&&(this.ensurePromise(),this.enterUnbinding(),t.then((()=>{this.leaveUnbinding()})).catch((e=>{this.reject(e)})))}e=e.next}this.leaveUnbinding()}}enterUnbinding(){++this.unbindingStack}leaveUnbinding(){if(0==--this.unbindingStack){this.debug&&this.logger.trace("unbind()");let e=this.$initiator.head,t=null;for(;null!==e;)e!==this&&(e.isBound=!1,e.unbind()),t=e.next,e.next=null,e=t;this.head=this.tail=null,this.isBound=!1,this.unbind()}}addBinding(e){null===this.bindings?this.bindings=[e]:this.bindings[this.bindings.length]=e}addChild(e){null===this.children?this.children=[e]:this.children[this.children.length]=e}is(e){switch(this.vmKind){case 1:return Oe.getDefinition(this.viewModel.constructor).name===e;case 0:return Me.getDefinition(this.viewModel.constructor).name===e;case 2:return this.viewFactory.name===e}}lockScope(e){this.scope=e,this.hasLockedScope=!0}setHost(e){return 0===this.vmKind&&(_t(e,Me.name,this),_t(e,this.definition.key,this)),this.host=e,this.mountTarget=1,this}setShadowRoot(e){return 0===this.vmKind&&(_t(e,Me.name,this),_t(e,this.definition.key,this)),this.shadowRoot=e,this.mountTarget=2,this}setLocation(e){return 0===this.vmKind&&(_t(e,Me.name,this),_t(e,this.definition.key,this)),this.location=e,this.mountTarget=3,this}release(){this.state|=16}dispose(){this.debug&&this.logger.trace("dispose()"),32!=(32&this.state)&&(this.state|=32,this.hooks.hasDispose&&this.viewModel.dispose(),null!==this.children&&(this.children.forEach(zt),this.children=null),this.hostController=null,this.scope=null,this.nodes=null,this.context=null,this.location=null,this.viewFactory=null,null!==this.viewModel&&(Ot.delete(this.viewModel),this.viewModel=null),this.viewModel=null,this.host=null,this.shadowRoot=null,this.root=null)}accept(e){if(!0===e(this))return!0;if(this.hooks.hasAccept&&!0===this.viewModel.accept(e))return!0;if(null!==this.children){const{children:t}=this;for(let i=0,s=t.length;i<s;++i)if(!0===t[i].accept(e))return!0}}}function Bt(e){let t=e.$observers;return void 0===t&&Reflect.defineProperty(e,"$observers",{enumerable:!1,value:t={}}),t}function Et(e,t,i,s){const n=t.bindables,r=Object.getOwnPropertyNames(n),o=r.length;if(o>0){let t,i,a=0;const l=Bt(s);for(;a<o;++a)t=r[a],void 0===l[t]&&(i=n[t],l[t]=new h(s,t,i.callback,i.set,e))}}const Rt=new Map,It=e=>{let t=Rt.get(e);return null==t&&(t=new s.AccessScopeExpression(e,0),Rt.set(e,t)),t};function $t(e,t,i,n){const r=t.get(s.IObserverLocator),o=t.get(s.IExpressionParser),a=i.watches,l=0===e.vmKind?e.scope:s.Scope.create(n,null,!0),c=a.length;let h,u,d,p=0;for(;c>p;++p){if(({expression:h,callback:u}=a[p]),u="function"==typeof u?u:Reflect.get(n,u),"function"!=typeof u)throw new Error(`Invalid callback for @watch decorator: ${String(u)}`);"function"==typeof h?e.addBinding(new vt(n,r,h,u,!0)):(d="string"==typeof h?o.parse(h,53):It(h),e.addBinding(new bt(l,t,r,d,u)))}}class Dt{constructor(e){this.hasDefine="define"in e,this.hasHydrating="hydrating"in e,this.hasHydrated="hydrated"in e,this.hasCreated="created"in e,this.hasBinding="binding"in e,this.hasBound="bound"in e,this.hasAttaching="attaching"in e,this.hasAttached="attached"in e,this.hasDetaching="detaching"in e,this.hasUnbinding="unbinding"in e,this.hasDispose="dispose"in e,this.hasAccept="accept"in e}}Dt.none=new Dt({});const Mt={mode:"open"};var jt,Lt;function Vt(e){const t=[];return 1==(1&e)&&t.push("activating"),2==(2&e)&&t.push("activated"),4==(4&e)&&t.push("deactivating"),8==(8&e)&&t.push("deactivated"),16==(16&e)&&t.push("released"),32==(32&e)&&t.push("disposed"),0===t.length?"none":t.join("|")}exports.ViewModelKind=void 0,(jt=exports.ViewModelKind||(exports.ViewModelKind={}))[jt.customElement=0]="customElement",jt[jt.customAttribute=1]="customAttribute",jt[jt.synthetic=2]="synthetic",function(e){e[e.none=0]="none",e[e.activating=1]="activating",e[e.activated=2]="activated",e[e.deactivating=4]="deactivating",e[e.deactivated=8]="deactivated",e[e.released=16]="released",e[e.disposed=32]="disposed"}(Lt||(Lt={}));const Nt=i.DI.createInterface("IController"),Ft=i.DI.createInterface("IHydrationContext");class qt{constructor(e,t,i){this.instruction=t,this.parent=i,this.controller=e}}function zt(e){e.dispose()}const Wt=i.DI.createInterface("IAppRoot"),Ut=i.DI.createInterface("IWorkTracker",(e=>e.singleton(Ht)));let Ht=class{constructor(e){this.logger=e,this.stack=0,this.promise=null,this.resolve=null,this.logger=e.scopeTo("WorkTracker")}start(){this.logger.trace(`start(stack:${this.stack})`),++this.stack}finish(){if(this.logger.trace(`finish(stack:${this.stack})`),0==--this.stack){const e=this.resolve;null!==e&&(this.resolve=this.promise=null,e())}}wait(){if(this.logger.trace(`wait(stack:${this.stack})`),null===this.promise){if(0===this.stack)return Promise.resolve();this.promise=new Promise((e=>{this.resolve=e}))}return this.promise}};Ht=n([r(0,i.ILogger)],Ht);class Kt{constructor(e,t,s,n,r=!1){if(this.config=e,this.platform=t,this.container=s,this.controller=void 0,this.hydratePromise=void 0,this.host=e.host,this.work=s.get(Ut),n.prepare(this),this.container.register(i.Registration.instance(Xt,e.host)),r){const t=e.component;this.enhanceDefinition=Me.getDefinition(Me.isType(t)?Me.define({...Me.getDefinition(t),template:this.host,enhance:!0},t):Me.define({name:void 0,template:this.host,enhance:!0}))}this.hydratePromise=i.onResolve(this.runAppTasks("beforeCreate"),(()=>{const t=e.component,n=s.createChild();let r;r=Me.isType(t)?this.container.get(t):e.component;const o=this.controller=St.forCustomElement(this,s,n,r,this.host,null,0,!1,this.enhanceDefinition);return o.hydrateCustomElement(null),i.onResolve(this.runAppTasks("hydrating"),(()=>(o.hydrate(null),i.onResolve(this.runAppTasks("hydrated"),(()=>{o.hydrateChildren(),this.hydratePromise=void 0})))))}))}activate(){return i.onResolve(this.hydratePromise,(()=>i.onResolve(this.runAppTasks("beforeActivate"),(()=>i.onResolve(this.controller.activate(this.controller,null,2,void 0),(()=>this.runAppTasks("afterActivate")))))))}deactivate(){return i.onResolve(this.runAppTasks("beforeDeactivate"),(()=>i.onResolve(this.controller.deactivate(this.controller,null,0),(()=>this.runAppTasks("afterDeactivate")))))}runAppTasks(e){return i.resolveAll(...this.container.getAll(de).reduce(((t,i)=>(i.slot===e&&t.push(i.run()),t)),[]))}dispose(){var e;null===(e=this.controller)||void 0===e||e.dispose()}}class Gt{}function Qt(e,t){var i,s;return null!==(s=null===(i=e.$au)||void 0===i?void 0:i[t])&&void 0!==s?s:null}function _t(e,t,i){var s,n;(null!==(s=(n=e).$au)&&void 0!==s?s:n.$au=new Gt)[t]=i}const Xt=i.DI.createInterface("INode"),Yt=i.DI.createInterface("IEventTarget",(e=>e.cachedCallback((e=>e.has(Wt,!0)?e.get(Wt).host:e.get(R).document)))),Zt=i.DI.createInterface("IRenderLocation");var Jt;exports.NodeType=void 0,(Jt=exports.NodeType||(exports.NodeType={}))[Jt.Element=1]="Element",Jt[Jt.Attr=2]="Attr",Jt[Jt.Text=3]="Text",Jt[Jt.CDATASection=4]="CDATASection",Jt[Jt.EntityReference=5]="EntityReference",Jt[Jt.Entity=6]="Entity",Jt[Jt.ProcessingInstruction=7]="ProcessingInstruction",Jt[Jt.Comment=8]="Comment",Jt[Jt.Document=9]="Document",Jt[Jt.DocumentType=10]="DocumentType",Jt[Jt.DocumentFragment=11]="DocumentFragment",Jt[Jt.Notation=12]="Notation";const ei=new WeakMap;function ti(e){if(ei.has(e))return ei.get(e);let t=0,i=e.nextSibling;for(;null!==i;){if(8===i.nodeType)switch(i.textContent){case"au-start":++t;break;case"au-end":if(0==t--)return i}i=i.nextSibling}if(null===e.parentNode&&11===e.nodeType){const t=Me.for(e);if(void 0===t)return null;if(2===t.mountTarget)return ti(t.host)}return e.parentNode}function ii(e,t){if(void 0===e.platform||e instanceof e.platform.Node)ei.set(e,t);else{const i=e.childNodes;for(let e=0,s=i.length;e<s;++e)ei.set(i[e],t)}}function si(e){if(ni(e))return e;const t=e.ownerDocument.createComment("au-end"),i=e.ownerDocument.createComment("au-start");return null!==e.parentNode&&(e.parentNode.replaceChild(t,e),t.parentNode.insertBefore(i,t)),t.$start=i,t}function ni(e){return"au-end"===e.textContent}class ri{constructor(e,t){this.platform=e,this.fragment=t,this.isMounted=!1,this.isLinked=!1,this.next=void 0,this.refNode=void 0;const i=t.querySelectorAll(".au");let s=0,n=i.length;const r=this.targets=Array(n);for(;s<n;){const e=i[s];r[s]="AU-M"===e.nodeName?si(e):e,++s}const o=t.childNodes;s=0,n=o.length;const a=this.childNodes=Array(n);for(;s<n;)a[s]=o[s],++s;this.firstChild=t.firstChild,this.lastChild=t.lastChild}findTargets(){return this.targets}insertBefore(e){if(this.isLinked&&this.refNode)this.addToLinked();else{const t=e.parentNode;if(this.isMounted){let i=this.firstChild;const s=this.lastChild;let n;for(;null!=i&&(n=i.nextSibling,t.insertBefore(i,e),i!==s);)i=n}else this.isMounted=!0,e.parentNode.insertBefore(this.fragment,e)}}appendTo(e,t=!1){if(this.isMounted){let t=this.firstChild;const i=this.lastChild;let s;for(;null!=t&&(s=t.nextSibling,e.appendChild(t),t!==i);)t=s}else this.isMounted=!0,t||e.appendChild(this.fragment)}remove(){if(this.isMounted){this.isMounted=!1;const e=this.fragment,t=this.lastChild;let i,s=this.firstChild;for(;null!==s&&(i=s.nextSibling,e.appendChild(s),s!==t);)s=i}}addToLinked(){const e=this.refNode,t=e.parentNode;if(this.isMounted){let i=this.firstChild;const s=this.lastChild;let n;for(;null!=i&&(n=i.nextSibling,t.insertBefore(i,e),i!==s);)i=n}else this.isMounted=!0,t.insertBefore(this.fragment,e)}unlink(){this.isLinked=!1,this.next=void 0,this.refNode=void 0}link(e){this.isLinked=!0,ni(e)?this.refNode=e:(this.next=e,this.obtainRefNode())}obtainRefNode(){this.refNode=void 0!==this.next?this.next.firstChild:void 0}}const oi=i.DI.createInterface("IWindow",(e=>e.callback((e=>e.get(R).window)))),ai=i.DI.createInterface("ILocation",(e=>e.callback((e=>e.get(oi).location)))),li=i.DI.createInterface("IHistory",(e=>e.callback((e=>e.get(oi).history)))),ci={[s.DelegationStrategy.capturing]:{capture:!0},[s.DelegationStrategy.bubbling]:{capture:!1}};class hi{constructor(e,t,i,s,n,r,o,a){this.platform=e,this.targetEvent=t,this.delegationStrategy=i,this.sourceExpression=s,this.target=n,this.preventDefault=r,this.eventDelegator=o,this.locator=a,this.interceptor=this,this.isBound=!1,this.handler=null}callSource(e){const t=this.$scope.overrideContext;t.$event=e;const i=this.sourceExpression.evaluate(8,this.$scope,this.locator,null);return Reflect.deleteProperty(t,"$event"),!0!==i&&this.preventDefault&&e.preventDefault(),i}handleEvent(e){this.interceptor.callSource(e)}$bind(e,t){if(this.isBound){if(this.$scope===t)return;this.interceptor.$unbind(2|e)}this.$scope=t;const i=this.sourceExpression;if(i.hasBind&&i.bind(e,t,this.interceptor),this.delegationStrategy===s.DelegationStrategy.none)this.target.addEventListener(this.targetEvent,this);else{const e=this.locator.get(Yt);this.handler=this.eventDelegator.addEventListener(e,this.target,this.targetEvent,this,ci[this.delegationStrategy])}this.isBound=!0}$unbind(e){if(!this.isBound)return;const t=this.sourceExpression;t.hasUnbind&&t.unbind(e,this.$scope,this.interceptor),this.$scope=null,this.delegationStrategy===s.DelegationStrategy.none?this.target.removeEventListener(this.targetEvent,this):(this.handler.dispose(),this.handler=null),this.isBound=!1}observeProperty(e,t){}handleChange(e,t,i){}}const ui={capture:!1};class di{constructor(e,t,i=ui){this.publisher=e,this.eventName=t,this.options=i,this.count=0,this.captureLookups=new Map,this.bubbleLookups=new Map}increment(){1==++this.count&&this.publisher.addEventListener(this.eventName,this,this.options)}decrement(){0==--this.count&&this.publisher.removeEventListener(this.eventName,this,this.options)}dispose(){this.count>0&&(this.count=0,this.publisher.removeEventListener(this.eventName,this,this.options)),this.captureLookups.clear(),this.bubbleLookups.clear()}getLookup(e){const t=!0===this.options.capture?this.captureLookups:this.bubbleLookups;let i=t.get(e);return void 0===i&&t.set(e,i=Object.create(null)),i}handleEvent(e){const t=!0===this.options.capture?this.captureLookups:this.bubbleLookups,i=e.composedPath();!0===this.options.capture&&i.reverse();for(const s of i){const i=t.get(s);if(void 0===i)continue;const n=i[this.eventName];if(void 0!==n&&("function"==typeof n?n(e):n.handleEvent(e),!0===e.cancelBubble))return}}}class pi{constructor(e,t,i,s){this.tracker=e,this.lookup=t,this.eventName=i,e.increment(),t[i]=s}dispose(){this.tracker.decrement(),this.lookup[this.eventName]=void 0}}class gi{constructor(e){this.config=e,this.target=null,this.handler=null}subscribe(e,t){this.target=e,this.handler=t;for(const i of this.config.events)e.addEventListener(i,t)}dispose(){const{target:e,handler:t}=this;if(null!==e&&null!==t)for(const i of this.config.events)e.removeEventListener(i,t);this.target=this.handler=null}}const fi=i.DI.createInterface("IEventDelegator",(e=>e.singleton(mi)));class mi{constructor(){this.trackerMaps=Object.create(null)}addEventListener(e,t,i,s,n){var r,o;const a=null!==(r=(o=this.trackerMaps)[i])&&void 0!==r?r:o[i]=new Map;let l=a.get(e);return void 0===l&&a.set(e,l=new di(e,i,n)),new pi(l,l.getLookup(t),i,s)}dispose(){for(const e in this.trackerMaps){const t=this.trackerMaps[e];for(const e of t.values())e.dispose();t.clear()}}}const vi=i.DI.createInterface("IProjections"),bi=i.DI.createInterface("IAuSlotsInfo");class xi{constructor(e){this.projectedSlots=e}}var yi;exports.InstructionType=void 0,(yi=exports.InstructionType||(exports.InstructionType={})).hydrateElement="ra",yi.hydrateAttribute="rb",yi.hydrateTemplateController="rc",yi.hydrateLetElement="rd",yi.setProperty="re",yi.interpolation="rf",yi.propertyBinding="rg",yi.callBinding="rh",yi.letBinding="ri",yi.refBinding="rj",yi.iteratorBinding="rk",yi.textBinding="ha",yi.listenerBinding="hb",yi.attributeBinding="hc",yi.stylePropertyBinding="hd",yi.setAttribute="he",yi.setClassAttribute="hf",yi.setStyleAttribute="hg";const wi=i.DI.createInterface("Instruction");function Ci(e){const t=e.type;return"string"==typeof t&&2===t.length}class ki{constructor(e,t){this.from=e,this.to=t}get type(){return"rf"}}class Ai{constructor(e,t,i){this.from=e,this.to=t,this.mode=i}get type(){return"rg"}}class Ti{constructor(e,t){this.from=e,this.to=t}get type(){return"rk"}}class Pi{constructor(e,t){this.from=e,this.to=t}get type(){return"rh"}}class Oi{constructor(e,t){this.from=e,this.to=t}get type(){return"rj"}}class Si{constructor(e,t){this.value=e,this.to=t}get type(){return"re"}}class Bi{constructor(e,t,i,s,n){this.res=e,this.alias=t,this.instructions=i,this.projections=s,this.containerless=n,this.auSlot=null}get type(){return"ra"}}class Ei{constructor(e,t,i){this.res=e,this.alias=t,this.instructions=i}get type(){return"rb"}}class Ri{constructor(e,t,i,s){this.def=e,this.res=t,this.alias=i,this.instructions=s}get type(){return"rc"}}class Ii{constructor(e,t){this.instructions=e,this.toBindingContext=t}get type(){return"rd"}}class $i{constructor(e,t){this.from=e,this.to=t}get type(){return"ri"}}class Di{constructor(e,t){this.from=e,this.strict=t}get type(){return"ha"}}class Mi{constructor(e,t,i,s){this.from=e,this.to=t,this.preventDefault=i,this.strategy=s}get type(){return"hb"}}class ji{constructor(e,t){this.value=e,this.to=t}get type(){return"he"}}class Li{constructor(e){this.value=e,this.type="hf"}}class Vi{constructor(e){this.value=e,this.type="hg"}}class Ni{constructor(e,t,i){this.attr=e,this.from=t,this.to=i}get type(){return"hc"}}const Fi=i.DI.createInterface("ITemplateCompiler"),qi=i.DI.createInterface("IRenderer");function zi(e){return function(t){const s=function(...i){const s=new t(...i);return s.instructionType=e,s};s.register=function(e){i.Registration.singleton(qi,s).register(e)};const n=i.Metadata.getOwnKeys(t);for(const e of n)i.Metadata.define(e,i.Metadata.getOwn(e,t),s);const r=Object.getOwnPropertyDescriptors(t);return Object.keys(r).filter((e=>"prototype"!==e)).forEach((e=>{Reflect.defineProperty(s,e,r[e])})),s}}function Wi(e,t,i){return"string"==typeof t?e.parse(t,i):t}function Ui(e){return null!=e.viewModel?e.viewModel:e}let Hi=class{render(e,t,i,s,n){const r=Ui(s);void 0!==r.$observers&&void 0!==r.$observers[n.to]?r.$observers[n.to].setValue(n.value,2):r[n.to]=n.value}};Hi=n([zi("re")],Hi);let Ki=class{render(e,t,s,n,r){let o,a,l,c;const h=r.res,u=r.projections,d=s.container,p=function(e,t,s,n,r){const o=e.platform,a=e.container.createChild();return a.registerResolver(o.HTMLElement,a.registerResolver(o.Element,a.registerResolver(o.Node,a.registerResolver(Xt,new i.InstanceProvider("ElementProvider",t))))),a.registerResolver(Nt,new i.InstanceProvider("IController",e)),a.registerResolver(wi,new i.InstanceProvider("IInstruction",s)),a.registerResolver(Zt,null==n?ps:new i.InstanceProvider("IRenderLocation",n)),a.registerResolver(Ve,gs),a.registerResolver(bi,null==r?fs:new i.InstanceProvider("IAuSlotsInfo",r)),a}(s,n,r,n,null==u?void 0:new xi(Object.keys(u)));switch(typeof h){case"string":if(o=d.find(Me,h),null==o)throw new Error(`Element ${h} is not registered in ${s.name}.`);break;default:o=h}a=o.Type,l=p.invoke(a),p.registerResolver(a,new i.InstanceProvider(o.key,l)),c=St.forCustomElement(s.root,s.container,p,l,n,r,e,!0,o),e=c.flags,_t(n,o.key,c),t.renderChildren(e,r.instructions,s,c),s.addChild(c)}};Ki=n([zi("ra")],Ki);let Gi=class{render(e,t,i,s,n){let r,o=i.container;switch(typeof n.res){case"string":if(r=o.find(Oe,n.res),null==r)throw new Error(`Attribute ${n.res} is not registered in ${i.name}.`);break;default:r=n.res}const a=ds(r,i,s,n,void 0,void 0),l=St.forCustomAttribute(i.root,i.container,a,s,e,r);_t(s,r.key,l),t.renderChildren(e,n.instructions,i,l),i.addChild(l)}};Gi=n([zi("rb")],Gi);let Qi=class{render(e,t,i,s,n){var r;let o,a=i.container;switch(typeof n.res){case"string":if(o=a.find(Oe,n.res),null==o)throw new Error(`Attribute ${n.res} is not registered in ${i.name}.`);break;default:o=n.res}const l=_e(n.def,a).getViewFactory(),c=si(s),h=ds(o,i,s,n,l,c),u=St.forCustomAttribute(i.root,i.container,h,s,e,o);_t(c,o.key,u),null===(r=h.link)||void 0===r||r.call(h,e,t,i,u,s,n),t.renderChildren(e,n.instructions,i,u),i.addChild(u)}};Qi=n([zi("rc")],Qi);let _i=class{constructor(e,t){this.parser=e,this.oL=t}render(e,t,i,s,n){s.remove();const r=n.instructions,o=n.toBindingContext,a=i.container;let l,c,h;for(let e=0,t=r.length;e<t;++e)l=r[e],c=Wi(this.parser,l.from,48),h=new ne(c,l.to,this.oL,a,o),i.addBinding(38962===c.$kind?ss(h,c,a):h)}};_i=n([zi("rd"),r(0,s.IExpressionParser),r(1,s.IObserverLocator)],_i);let Xi=class{constructor(e,t){this.parser=e,this.observerLocator=t}render(e,t,i,s,n){const r=Wi(this.parser,n.from,153),o=new N(r,Ui(s),n.to,this.observerLocator,i.container);i.addBinding(38962===r.$kind?ss(o,r,i.container):o)}};Xi=n([zi("rh"),r(0,s.IExpressionParser),r(1,s.IObserverLocator)],Xi);let Yi=class{constructor(e){this.parser=e}render(e,t,i,s,n){const r=Wi(this.parser,n.from,5376),o=new ue(r,function(e,t){if("element"===t)return e;switch(t){case"controller":return Me.for(e);case"view":throw new Error("Not supported API");case"view-model":return Me.for(e).viewModel;default:{const i=Oe.for(e,t);if(void 0!==i)return i.viewModel;const s=Me.for(e,{name:t});if(void 0===s)throw new Error(`Attempted to reference "${t}", but it was not found amongst the target's API.`);return s.viewModel}}}(s,n.to),i.container);i.addBinding(38962===r.$kind?ss(o,r,i.container):o)}};Yi=n([zi("rj"),r(0,s.IExpressionParser)],Yi);let Zi=class{constructor(e,t,i){this.parser=e,this.oL=t,this.platform=i}render(e,t,i,n,r){const o=i.container,a=Wi(this.parser,r.from,2048),l=new te(this.oL,a,Ui(n),r.to,s.BindingMode.toView,o,this.platform.domWriteQueue),c=l.partBindings,h=c.length;let u,d=0;for(;h>d;++d)u=c[d],38962===u.sourceExpression.$kind&&(c[d]=ss(u,u.sourceExpression,o));i.addBinding(l)}};Zi=n([zi("rf"),r(0,s.IExpressionParser),r(1,s.IObserverLocator),r(2,R)],Zi);let Ji=class{constructor(e,t,i){this.parser=e,this.oL=t,this.platform=i}render(e,t,i,s,n){const r=Wi(this.parser,n.from,48|n.mode),o=new he(r,Ui(s),n.to,n.mode,this.oL,i.container,this.platform.domWriteQueue);i.addBinding(38962===r.$kind?ss(o,r,i.container):o)}};Ji=n([zi("rg"),r(0,s.IExpressionParser),r(1,s.IObserverLocator),r(2,R)],Ji);let es=class{constructor(e,t,i){this.parser=e,this.oL=t,this.p=i}render(e,t,i,n,r){const o=Wi(this.parser,r.from,539),a=new he(o,Ui(n),r.to,s.BindingMode.toView,this.oL,i.container,this.p.domWriteQueue);i.addBinding(a)}};es=n([zi("rk"),r(0,s.IExpressionParser),r(1,s.IObserverLocator),r(2,R)],es);let ts=0;const is=[];function ss(e,t,i){for(;t instanceof s.BindingBehaviorExpression;)is[ts++]=t,t=t.expression;for(;ts>0;){const t=is[--ts],n=i.get(t.behaviorKey);n instanceof s.BindingBehaviorFactory&&(e=n.construct(e,t))}return is.length=0,e}let ns=class{constructor(e,t,i){this.parser=e,this.oL=t,this.p=i}render(e,t,i,s,n){const r=i.container,o=s.nextSibling,a=s.parentNode,l=this.p.document,c=Wi(this.parser,n.from,2048),h=c.parts,u=c.expressions,d=u.length;let p,g,f=0,m=h[0];for(""!==m&&a.insertBefore(l.createTextNode(m),o);d>f;++f)g=u[f],p=new se(g,a.insertBefore(l.createTextNode(""),o),r,this.oL,this.p,n.strict),i.addBinding(38962===g.$kind?ss(p,g,r):p),m=h[f+1],""!==m&&a.insertBefore(l.createTextNode(m),o);"AU-M"===s.nodeName&&s.remove()}};ns=n([zi("ha"),r(0,s.IExpressionParser),r(1,s.IObserverLocator),r(2,R)],ns);let rs=class{constructor(e,t){this.parser=e,this.eventDelegator=t}render(e,t,i,s,n){const r=Wi(this.parser,n.from,80|n.strategy+6),o=new hi(i.platform,n.to,n.strategy,r,s,n.preventDefault,this.eventDelegator,i.container);i.addBinding(38962===r.$kind?ss(o,r,i.container):o)}};rs=n([zi("hb"),r(0,s.IExpressionParser),r(1,fi)],rs);let os=class{render(e,t,i,s,n){s.setAttribute(n.to,n.value)}};os=n([zi("he")],os);let as=class{render(e,t,i,s,n){!function(e,t){const i=t.length;let s=0;for(let n=0;n<i;++n)32===t.charCodeAt(n)?(n!==s&&e.add(t.slice(s,n)),s=n+1):n+1===i&&e.add(t.slice(s))}(s.classList,n.value)}};as=n([zi("hf")],as);let ls=class{render(e,t,i,s,n){s.style.cssText+=n.value}};ls=n([zi("hg")],ls);let cs=class{constructor(e,t,i){this.parser=e,this.oL=t,this.p=i}render(e,t,i,n,r){const o=Wi(this.parser,r.from,48|s.BindingMode.toView),a=new he(o,n.style,r.to,s.BindingMode.toView,this.oL,i.container,this.p.domWriteQueue);i.addBinding(38962===o.$kind?ss(a,o,i.container):a)}};cs=n([zi("hd"),r(0,s.IExpressionParser),r(1,s.IObserverLocator),r(2,R)],cs);let hs=class{constructor(e,t){this.parser=e,this.oL=t}render(e,t,i,n,r){const o=Wi(this.parser,r.from,48|s.BindingMode.toView),a=new Z(o,n,r.attr,r.to,s.BindingMode.toView,this.oL,i.container);i.addBinding(38962===o.$kind?ss(a,o,i.container):a)}};hs=n([zi("hc"),r(0,s.IExpressionParser),r(1,s.IObserverLocator)],hs);class us{constructor(e){this.f=e}get $isResolver(){return!0}resolve(){const e=this.f;if(null===e)throw new Error("Cannot resolve ViewFactory before the provider was prepared.");if("string"!=typeof e.name||0===e.name.length)throw new Error("Cannot resolve ViewFactory without a (valid) name.");return e}}function ds(e,t,s,n,r,o,a){const l=t.platform,c=t.container.createChild();return c.registerResolver(l.HTMLElement,c.registerResolver(l.Element,c.registerResolver(l.Node,c.registerResolver(Xt,new i.InstanceProvider("ElementProvider",s))))),c.registerResolver(Nt,new i.InstanceProvider("IController",t)),c.registerResolver(wi,new i.InstanceProvider("IInstruction",n)),c.registerResolver(Zt,null==o?ps:new i.InstanceProvider("IRenderLocation",o)),c.registerResolver(Ve,null==r?gs:new us(r)),c.registerResolver(bi,null==a?fs:new i.InstanceProvider("IAuSlotsInfo",a)),c.invoke(e.Type)}const ps=new i.InstanceProvider("IRenderLocation"),gs=new us(null),fs=new i.InstanceProvider("IAuSlotsInfo",new xi(i.emptyArray));function ms(e){return function(t){return bs.define(e,t)}}class vs{constructor(e,t,i,s,n){this.Type=e,this.name=t,this.aliases=i,this.key=s,this.type=n}static create(e,t){let s,n;return"string"==typeof e?(s=e,n={name:s}):(s=e.name,n=e),new vs(t,i.firstDefined(bs.getAnnotation(t,"name"),s),i.mergeArrays(bs.getAnnotation(t,"aliases"),n.aliases,t.aliases),bs.keyFrom(s),i.firstDefined(bs.getAnnotation(t,"type"),n.type,t.type,null))}register(e){const{Type:t,key:n,aliases:r}=this;i.Registration.singleton(n,t).register(e),i.Registration.aliasTo(n,t).register(e),s.registerAliases(r,bs,n,e)}}const bs={name:i.Protocol.resource.keyFor("binding-command"),keyFrom:e=>`${bs.name}:${e}`,isType:e=>"function"==typeof e&&i.Metadata.hasOwn(bs.name,e),define(e,t){const s=vs.create(e,t);return i.Metadata.define(bs.name,s,s.Type),i.Metadata.define(bs.name,s,s),i.Protocol.resource.appendTo(t,bs.name),s.Type},getDefinition(e){const t=i.Metadata.getOwn(bs.name,e);if(void 0===t)throw new Error(`No definition found for type ${e.name}`);return t},annotate(e,t,s){i.Metadata.define(i.Protocol.annotation.keyFor(t),s,e)},getAnnotation:(e,t)=>i.Metadata.getOwn(i.Protocol.annotation.keyFor(t),e)};exports.OneTimeBindingCommand=class{constructor(e){this.m=e,this.bindingType=49}static get inject(){return[j]}build(e){var t;let n;return n=null==e.bindable?null!==(t=this.m.map(e.node,e.attr.target))&&void 0!==t?t:i.camelCase(e.attr.target):e.bindable.property,new Ai(e.expr,n,s.BindingMode.oneTime)}},exports.OneTimeBindingCommand=n([ms("one-time")],exports.OneTimeBindingCommand),exports.ToViewBindingCommand=class{constructor(e){this.m=e,this.bindingType=50}static get inject(){return[j]}build(e){var t;let n;return n=null==e.bindable?null!==(t=this.m.map(e.node,e.attr.target))&&void 0!==t?t:i.camelCase(e.attr.target):e.bindable.property,new Ai(e.expr,n,s.BindingMode.toView)}},exports.ToViewBindingCommand=n([ms("to-view")],exports.ToViewBindingCommand),exports.FromViewBindingCommand=class{constructor(e){this.m=e,this.bindingType=51}static get inject(){return[j]}build(e){var t;let n;return n=null==e.bindable?null!==(t=this.m.map(e.node,e.attr.target))&&void 0!==t?t:i.camelCase(e.attr.target):e.bindable.property,new Ai(e.expr,n,s.BindingMode.fromView)}},exports.FromViewBindingCommand=n([ms("from-view")],exports.FromViewBindingCommand),exports.TwoWayBindingCommand=class{constructor(e){this.m=e,this.bindingType=52}static get inject(){return[j]}build(e){var t;let n;return n=null==e.bindable?null!==(t=this.m.map(e.node,e.attr.target))&&void 0!==t?t:i.camelCase(e.attr.target):e.bindable.property,new Ai(e.expr,n,s.BindingMode.twoWay)}},exports.TwoWayBindingCommand=n([ms("two-way")],exports.TwoWayBindingCommand),exports.DefaultBindingCommand=class{constructor(e){this.m=e,this.bindingType=53}static get inject(){return[j]}build(e){var t;const n=e.attr.target,r=e.bindable;let o,a,l;return null==r?(a=this.m.isTwoWay(e.node,n)?s.BindingMode.twoWay:s.BindingMode.toView,l=null!==(t=this.m.map(e.node,n))&&void 0!==t?t:i.camelCase(n)):(o=e.def.defaultBindingMode,a=r.mode===s.BindingMode.default||null==r.mode?null==o||o===s.BindingMode.default?s.BindingMode.toView:o:r.mode,l=r.property),new Ai(e.expr,l,a)}},exports.DefaultBindingCommand=n([ms("bind")],exports.DefaultBindingCommand),exports.CallBindingCommand=class{constructor(){this.bindingType=153}build(e){const t=null===e.bindable?i.camelCase(e.attr.target):e.bindable.property;return new Pi(e.expr,t)}},exports.CallBindingCommand=n([ms("call")],exports.CallBindingCommand),exports.ForBindingCommand=class{constructor(){this.bindingType=539}build(e){const t=null===e.bindable?i.camelCase(e.attr.target):e.bindable.property;return new Ti(e.expr,t)}},exports.ForBindingCommand=n([ms("for")],exports.ForBindingCommand),exports.TriggerBindingCommand=class{constructor(){this.bindingType=4182}build(e){return new Mi(e.expr,e.attr.target,!0,s.DelegationStrategy.none)}},exports.TriggerBindingCommand=n([ms("trigger")],exports.TriggerBindingCommand),exports.DelegateBindingCommand=class{constructor(){this.bindingType=4184}build(e){return new Mi(e.expr,e.attr.target,!1,s.DelegationStrategy.bubbling)}},exports.DelegateBindingCommand=n([ms("delegate")],exports.DelegateBindingCommand),exports.CaptureBindingCommand=class{constructor(){this.bindingType=4183}build(e){return new Mi(e.expr,e.attr.target,!1,s.DelegationStrategy.capturing)}},exports.CaptureBindingCommand=n([ms("capture")],exports.CaptureBindingCommand),exports.AttrBindingCommand=class{constructor(){this.bindingType=4128}build(e){return new Ni(e.attr.target,e.expr,e.attr.target)}},exports.AttrBindingCommand=n([ms("attr")],exports.AttrBindingCommand),exports.StyleBindingCommand=class{constructor(){this.bindingType=4128}build(e){return new Ni("style",e.expr,e.attr.target)}},exports.StyleBindingCommand=n([ms("style")],exports.StyleBindingCommand),exports.ClassBindingCommand=class{constructor(){this.bindingType=4128}build(e){return new Ni("class",e.expr,e.attr.target)}},exports.ClassBindingCommand=n([ms("class")],exports.ClassBindingCommand);let xs=class{constructor(){this.bindingType=4128}build(e){return new Oi(e.expr,e.attr.target)}};xs=n([ms("ref")],xs);const ys=i.DI.createInterface("ITemplateElementFactory",(e=>e.singleton(Cs))),ws={};let Cs=class{constructor(e){this.p=e,this.template=e.document.createElement("template")}createTemplate(e){var t;if("string"==typeof e){let t=ws[e];if(void 0===t){const i=this.template;i.innerHTML=e;const s=i.content.firstElementChild;null==s||"TEMPLATE"!==s.nodeName||null!=s.nextElementSibling?(this.template=this.p.document.createElement("template"),t=i):(i.content.removeChild(s),t=s),ws[e]=t}return t.cloneNode(!0)}if("TEMPLATE"!==e.nodeName){const t=this.p.document.createElement("template");return t.content.appendChild(e),t}return null===(t=e.parentNode)||void 0===t||t.removeChild(e),e.cloneNode(!0)}};Cs=n([r(0,R)],Cs);const ks=function(e){function t(e,s,n){i.DI.inject(t)(e,s,n)}return t.$isResolver=!0,t.resolve=function(t,i){return i.root===i?i.getAll(e,!1):i.has(e,!1)?i.getAll(e,!1).concat(i.root.getAll(e,!1)):i.root.getAll(e,!1)},t};class As{constructor(){this.debug=!1,this.resolveResources=!0}static register(e){return i.Registration.singleton(Fi,this).register(e)}compile(e,t,s){var n,r,o,a;const l=$e.getOrCreate(e);if(null==l.template)return l;if(!1===l.needsCompile)return l;null!=s||(s=Ss);const c=new Ts(e,t,s,null,null,void 0),h="string"!=typeof l.template&&e.enhance?l.template:c.templateFactory.createTemplate(l.template),u="TEMPLATE"===h.nodeName&&null!=h.content,d=u?h.content:h,p=t.get(ks(Fs)),g=p.length;let f=0;if(g>0)for(;g>f;)null===(r=(n=p[f]).compiling)||void 0===r||r.call(n,h),++f;if(h.hasAttribute(Ls))throw new Error("The root cannot be a local template itself.");return this.local(d,c),this.node(d,c),$e.create({...e,name:e.name||Me.generateName(),dependencies:(null!==(o=e.dependencies)&&void 0!==o?o:i.emptyArray).concat(null!==(a=c.deps)&&void 0!==a?a:i.emptyArray),instructions:c.rows,surrogates:u?this.surrogate(h,c):i.emptyArray,template:h,hasSlots:c.hasSlot,needsCompile:!1})}surrogate(e,t){var s;const n=[],r=e.attributes,o=t.exprParser;let a,l,c,h,u,d,p,g,f,m,v,b,x=r.length,y=0,w=null,C=null;for(;x>y;++y){if(a=r[y],l=a.name,c=a.value,h=t.attrParser.parse(l,c),v=h.target,b=h.rawValue,Rs[v])throw new Error(`Attribute ${l} is invalid on surrogate.`);if(C=t.command(h),null!==C&&4096&C.bindingType)f=o.parse(b,C.bindingType),Es.node=e,Es.attr=h,Es.expr=f,Es.bindable=null,Es.def=null,n.push(C.build(Es));else if(w=t.attr(v),null===w)if(null===C)if(f=o.parse(b,2048),null!=f)e.removeAttribute(l),--y,--x,n.push(new ki(f,null!==(s=t.attrMapper.map(e,v))&&void 0!==s?s:i.camelCase(v)));else switch(l){case"class":n.push(new Li(b));break;case"style":n.push(new Vi(b));break;default:n.push(new ji(b,l))}else f=o.parse(b,C.bindingType),Es.node=e,Es.attr=h,Es.expr=f,Es.bindable=null,Es.def=null,n.push(C.build(Es));else{if(w.isTemplateController)throw new Error(`Template controller ${v} is invalid on surrogate.`);p=Ds.from(w,!0),m=!1===w.noMultiBindings&&null===C&&Ps(b),m?d=this.multiBindings(e,b,w,t):(g=p.primary,null===C?(f=o.parse(b,2048),d=[null===f?new Si(b,g.property):new ki(f,g.property)]):(f=o.parse(b,C.bindingType),Es.node=e,Es.attr=h,Es.expr=f,Es.bindable=g,Es.def=w,d=[C.build(Es)])),e.removeAttribute(l),--y,--x,(null!=u?u:u=[]).push(new Ei(this.resolveResources?w:w.name,null!=w.aliases&&w.aliases.includes(v)?v:void 0,d))}}return Os(),null!=u?u.concat(n):n}node(e,t){switch(e.nodeType){case 1:switch(e.nodeName){case"LET":return this.declare(e,t);default:return this.element(e,t)}case 3:return this.text(e,t);case 11:{let i=e.firstChild;for(;null!==i;)i=this.node(i,t);break}}return e.nextSibling}declare(e,t){const n=e.attributes,r=n.length,o=[],a=t.exprParser;let l,c,h,u,d,p,g,f,m=!1,v=0;for(;r>v;++v)if(l=n[v],h=l.name,u=l.value,"to-binding-context"!==h){if(c=t.attrParser.parse(h,u),p=c.target,g=c.rawValue,d=t.command(c),null!==d){if(50===d.bindingType||53===d.bindingType){o.push(new $i(a.parse(g,d.bindingType),i.camelCase(p)));continue}throw new Error(`Invalid command ${c.command} for <let>. Only to-view/bind supported.`)}f=a.parse(g,2048),null===f&&t.logger.warn(`Property ${p} is declared with literal string ${g}. Did you mean ${p}.bind="${g}"?`),o.push(new $i(null===f?new s.PrimitiveLiteralExpression(g):f,i.camelCase(p)))}else m=!0;return t.rows.push([new Ii(o,m)]),this.mark(e).nextSibling}element(e,t){var s,n,r,o,a,l,c;const h=e.nextSibling,u=(null!==(s=e.getAttribute("as-element"))&&void 0!==s?s:e.nodeName).toLowerCase(),d=t.el(u),p=t.exprParser,g=this.debug?i.noop:()=>{e.removeAttribute(v),--j,--M};let f,m,v,b,x,y,w,C,k,A,T,P,O,S,B,E,R,I,$,D=e.attributes,M=D.length,j=0,L=null,V=!1,N=null,F=!0,q=!1;for("slot"===u&&(t.root.hasSlot=!0),null!==d&&(F=null===(n=d.processContent)||void 0===n?void 0:n.call(d.Type,e,t.p),D=e.attributes,M=D.length);M>j;++j){switch(m=D[j],v=m.name,b=m.value,v){case"as-element":case"containerless":g(),q||(q="containerless"===v);continue}if(x=t.attrParser.parse(v,b),N=t.command(x),null!==N&&4096&N.bindingType)O=p.parse(b,N.bindingType),Es.node=e,Es.attr=x,Es.expr=O,Es.bindable=null,Es.def=null,(null!=y?y:y=[]).push(N.build(Es)),g();else if(R=x.target,I=x.rawValue,L=t.attr(R),null===L)if(null!==N)g(),null===d||(B=Ds.from(d,!1),C=B.attrs[R],void 0===C)?(O=p.parse(I,N.bindingType),Es.node=e,Es.attr=x,Es.expr=O,Es.bindable=null,Es.def=null,(null!=y?y:y=[]).push(N.build(Es))):(b=0===b.length&&(55&N.bindingType)>0?i.camelCase(v):b,O=p.parse(b,N.bindingType),Es.node=e,Es.attr=x,Es.expr=O,Es.bindable=C,Es.def=d,(null!=w?w:w=[]).push(N.build(Es)));else{if(null!==d&&(B=Ds.from(d,!1),C=B.attrs[R],void 0!==C)){O=p.parse(I,2048),(null!=w?w:w=[]).push(null==O?new Si(I,C.property):new ki(O,C.property)),g();continue}O=p.parse(I,2048),null!=O&&(g(),(null!=y?y:y=[]).push(new ki(O,null!==(r=t.attrMapper.map(e,R))&&void 0!==r?r:i.camelCase(R))))}else B=Ds.from(L,!0),V=!1===L.noMultiBindings&&null===N&&Ps(b),V?A=this.multiBindings(e,b,L,t):(E=B.primary,null===N?(O=p.parse(b,2048),A=[null===O?new Si(b,E.property):new ki(O,E.property)]):(O=p.parse(b,N.bindingType),Es.node=e,Es.attr=x,Es.expr=O,Es.bindable=E,Es.def=L,A=[N.build(Es)])),g(),L.isTemplateController?(null!=T?T:T=[]).push(new Ri(Bs,this.resolveResources?L:L.name,void 0,A)):(null!=k?k:k=[]).push(new Ei(this.resolveResources?L:L.name,null!=L.aliases&&L.aliases.includes(R)?R:void 0,A))}if(Os(),this.shouldReorderAttrs(e)&&null!=y&&y.length>1&&this.reorder(e,y),null!==d&&(S=new Bi(this.resolveResources?d:d.name,void 0,null!=w?w:i.emptyArray,null,q),"au-slot"===u)){const i=e.getAttribute("name")||"default",s=t.h("template"),n=t.child();let r=e.firstChild;for(;null!==r;)1===r.nodeType&&r.hasAttribute("au-slot")?e.removeChild(r):s.content.appendChild(r),r=e.firstChild;this.node(s.content,n),S.auSlot={name:i,fallback:$e.create({name:Me.generateName(),template:s,instructions:n.rows,needsCompile:!1})},e=this.marker(e,t)}if(null==y&&null==S&&null==k||(f=i.emptyArray.concat(null!=S?S:i.emptyArray,null!=k?k:i.emptyArray,null!=y?y:i.emptyArray),this.mark(e)),null!=T){let i;M=T.length-1,j=M,P=T[j],this.marker(e,t),"TEMPLATE"===e.nodeName?i=e:(i=t.h("template"),i.content.appendChild(e));const s=i,n=t.child(null==f?[]:[f]);let r,a,c,h,u,p,g,m,v;$=null===d||!d.containerless&&!q&&!1!==F,null!==d&&d.containerless&&this.marker(e,t);let b=0,x=0;if($){if(null!==d){for(r=e.firstChild;null!==r;)1===r.nodeType?(a=r,r=r.nextSibling,c=a.getAttribute("au-slot"),null!==c&&(""===c&&(c="default"),a.removeAttribute("au-slot"),e.removeChild(a),(null!==(o=(l=null!=u?u:u={})[c])&&void 0!==o?o:l[c]=[]).push(a))):r=r.nextSibling;if(null!=u){for(c in h={},u){for(i=t.h("template"),p=u[c],b=0,x=p.length;x>b;++b)g=p[b],i.content.appendChild("TEMPLATE"===g.nodeName?g.attributes.length>0?g:g.content:g);v=t.child(),this.node(i.content,v),h[c]=$e.create({name:Me.generateName(),template:i,instructions:v.rows,needsCompile:!1})}S.projections=h}}if("TEMPLATE"===e.nodeName)this.node(e.content,n);else for(r=e.firstChild;null!==r;)r=this.node(r,n)}for(P.def=$e.create({name:Me.generateName(),template:s,instructions:n.rows,needsCompile:!1});j-- >0;){if(P=T[j],i=t.h("template"),m=t.h("au-m"),m.classList.add("au"),i.content.appendChild(m),P.def!==Bs)throw new Error(`Invalid definition for processing ${P.res}.`);P.def=$e.create({name:Me.generateName(),template:i,needsCompile:!1,instructions:[[T[j+1]]]})}t.rows.push([P])}else if(null!=f&&t.rows.push(f),$=null===d||!d.containerless&&!q&&!1!==F,null!==d&&d.containerless&&this.marker(e,t),$&&e.childNodes.length>0){let i,s,n,r,o,l,h,u=e.firstChild,p=null,g=0,f=0;for(;null!==u;)if(1===u.nodeType){if(i=u,u=u.nextSibling,s=i.getAttribute("au-slot"),null!==s){if(null===d)throw new Error(`Projection with [au-slot="${s}"] is attempted on a non custom element ${e.nodeName}.`);""===s&&(s="default"),e.removeChild(i),i.removeAttribute("au-slot"),(null!==(a=(c=null!=n?n:n={})[s])&&void 0!==a?a:c[s]=[]).push(i)}}else u=u.nextSibling;if(null!=n){for(s in p={},n){for(l=t.h("template"),r=n[s],g=0,f=r.length;f>g;++g)o=r[g],l.content.appendChild("TEMPLATE"===o.nodeName?o.attributes.length>0?o:o.content:o);h=t.child(),this.node(l.content,h),p[s]=$e.create({name:Me.generateName(),template:l,instructions:h.rows,needsCompile:!1})}S.projections=p}for(u=e.firstChild;null!==u;)u=this.node(u,t)}return h}text(e,t){let i="",s=e;for(;null!==s&&3===s.nodeType;)i+=s.textContent,s=s.nextSibling;const n=t.exprParser.parse(i,2048);if(null===n)return s;const r=e.parentNode;for(r.insertBefore(this.mark(t.h("au-m")),e),t.rows.push([new Di(n,!!t.def.isStrictBinding)]),e.textContent="",s=e.nextSibling;null!==s&&3===s.nodeType;)r.removeChild(s),s=e.nextSibling;return e.nextSibling}multiBindings(e,t,i,s){const n=Ds.from(i,!0),r=t.length,o=[];let a,l,c,h,u,d,p=0,g=0;for(let f=0;f<r;++f)if(g=t.charCodeAt(f),92===g)++f;else if(58===g){for(a=t.slice(p,f);t.charCodeAt(++f)<=32;);for(p=f;f<r;++f)if(g=t.charCodeAt(f),92===g)++f;else if(59===g){l=t.slice(p,f);break}if(void 0===l&&(l=t.slice(p)),h=s.attrParser.parse(a,l),u=s.command(h),d=n.attrs[h.target],null==d)throw new Error(`Bindable ${h.target} not found on ${i.name}.`);for(null===u?(c=s.exprParser.parse(l,2048),o.push(null===c?new Si(l,d.property):new ki(c,d.property))):(c=s.exprParser.parse(l,u.bindingType),Es.node=e,Es.attr=h,Es.expr=c,Es.bindable=d,Es.def=i,o.push(u.build(Es)));f<r&&t.charCodeAt(++f)<=32;);p=f,a=void 0,l=void 0}return Os(),o}local(e,t){const s=e,n=i.toArray(s.querySelectorAll("template[as-custom-element]")),r=n.length;if(0===r)return;if(r===s.childElementCount)throw new Error("The custom element does not have any content other than local template(s).");const o=new Set;for(const e of n){if(e.parentNode!==s)throw new Error("Local templates needs to be defined directly under root.");const n=Vs(e,o),r=class{},a=e.content,c=i.toArray(a.querySelectorAll("bindable")),h=l.for(r),u=new Set,d=new Set;for(const e of c){if(e.parentNode!==a)throw new Error("Bindable properties of local templates needs to be defined directly under root.");const i=e.getAttribute("property");if(null===i)throw new Error(`The attribute 'property' is missing in ${e.outerHTML}`);const s=e.getAttribute("attribute");if(null!==s&&d.has(s)||u.has(i))throw new Error(`Bindable property and attribute needs to be unique; found property: ${i}, attribute: ${s}`);null!==s&&d.add(s),u.add(i),h.add({property:i,attribute:null!=s?s:void 0,mode:Ns(e)});const n=e.getAttributeNames().filter((e=>!js.includes(e)));n.length>0&&t.logger.warn(`The attribute(s) ${n.join(", ")} will be ignored for ${e.outerHTML}. Only ${js.join(", ")} are processed.`),a.removeChild(e)}t.addDep(Me.define({name:n,template:e},r)),s.removeChild(e)}}shouldReorderAttrs(e){return"INPUT"===e.nodeName&&1===Is[e.type]}reorder(e,t){switch(e.nodeName){case"INPUT":{const e=t;let i,s,n,r=0;for(let t=0;t<e.length&&r<3;t++)switch(n=e[t],n.to){case"model":case"value":case"matcher":i=t,r++;break;case"checked":s=t,r++}void 0!==s&&void 0!==i&&s<i&&([e[i],e[s]]=[e[s],e[i]])}}}mark(e){return e.classList.add("au"),e}marker(e,t){const i=e.parentNode,s=t.h("au-m");return this.mark(i.insertBefore(s,e)),i.removeChild(e),s}}class Ts{constructor(e,t,n,r,o,a){this.hasSlot=!1,this.commands=E();const l=null!==r;this.c=t,this.root=null===o?this:o,this.def=e,this.ci=n,this.parent=r,this.templateFactory=l?r.templateFactory:t.get(ys),this.attrParser=l?r.attrParser:t.get(k),this.exprParser=l?r.exprParser:t.get(s.IExpressionParser),this.attrMapper=l?r.attrMapper:t.get(j),this.logger=l?r.logger:t.get(i.ILogger),this.p=l?r.p:t.get(R),this.localEls=l?r.localEls:new Set,this.rows=null!=a?a:[]}addDep(e){var t,i;(null!==(t=(i=this.root).deps)&&void 0!==t?t:i.deps=[]).push(e),this.root.c.register(e)}h(e){const t=this.p.document.createElement(e);return"template"===e&&this.p.document.adoptNode(t.content),t}el(e){return this.c.find(Me,e)}attr(e){return this.c.find(Oe,e)}child(e){return new Ts(this.def,this.c,this.ci,this,this.root,e)}command(e){if(this.root!==this)return this.root.command(e);const t=e.command;if(null===t)return null;let i=this.commands[t];if(void 0===i){if(i=this.c.create(bs,t),null===i)throw new Error(`Unknown binding command: ${t}`);this.commands[t]=i}return i}}function Ps(e){const t=e.length;let i=0;for(let s=0;s<t;++s)if(i=e.charCodeAt(s),92===i)++s;else{if(58===i)return!0;if(36===i&&123===e.charCodeAt(s+1))return!1}return!1}function Os(){Es.node=Es.attr=Es.expr=Es.bindable=Es.def=null}const Ss={projections:null},Bs={name:"unnamed"},Es={node:null,expr:null,attr:null,bindable:null,def:null},Rs=Object.assign(E(),{id:!0,name:!0,"au-slot":!0,"as-element":!0}),Is={checkbox:1,radio:1},$s=new WeakMap;class Ds{constructor(e,t,i){this.attrs=e,this.bindables=t,this.primary=i}static from(e,t){let i=$s.get(e);if(null==i){const n=e.bindables,r=E(),o=t?void 0===e.defaultBindingMode?s.BindingMode.default:e.defaultBindingMode:s.BindingMode.default;let a,l,h,u,d=!1;for(l in n){if(a=n[l],u=a.attribute,!0===a.primary){if(d)throw new Error(`Primary already exists on ${e.name}`);d=!0,h=a}else d||null!=h||(h=a);r[u]=c.create(l,a)}null==a&&t&&(h=r.value=c.create("value",{mode:o})),$s.set(e,i=new Ds(r,n,h))}return i}}var Ms;!function(e){e.property="property",e.attribute="attribute",e.mode="mode"}(Ms||(Ms={}));const js=Object.freeze(["property","attribute","mode"]),Ls="as-custom-element";function Vs(e,t){const i=e.getAttribute(Ls);if(null===i||""===i)throw new Error('The value of "as-custom-element" attribute cannot be empty for local template');if(t.has(i))throw new Error(`Duplicate definition of the local template named ${i}`);return t.add(i),e.removeAttribute(Ls),i}function Ns(e){switch(e.getAttribute("mode")){case"oneTime":return s.BindingMode.oneTime;case"toView":return s.BindingMode.toView;case"fromView":return s.BindingMode.fromView;case"twoWay":return s.BindingMode.twoWay;case"default":default:return s.BindingMode.default}}const Fs=i.DI.createInterface("ITemplateCompilerHooks"),qs=new WeakMap,zs=i.Protocol.resource.keyFor("compiler-hooks"),Ws=Object.freeze({name:zs,define(e){let t=qs.get(e);return void 0===t&&(qs.set(e,t=new Us(e)),i.Metadata.define(zs,t,e),i.Protocol.resource.appendTo(e,zs)),e}});class Us{constructor(e){this.Type=e}get name(){return""}register(e){e.register(i.Registration.singleton(Fs,this.Type))}}class Hs{constructor(e){this.mode=e,this.originalModes=new Map}bind(e,t,i){this.originalModes.set(i,i.mode),i.mode=this.mode}unbind(e,t,i){i.mode=this.originalModes.get(i),this.originalModes.delete(i)}}class Ks extends Hs{constructor(){super(s.BindingMode.oneTime)}}class Gs extends Hs{constructor(){super(s.BindingMode.toView)}}class Qs extends Hs{constructor(){super(s.BindingMode.fromView)}}class _s extends Hs{constructor(){super(s.BindingMode.twoWay)}}s.bindingBehavior("oneTime")(Ks),s.bindingBehavior("toView")(Gs),s.bindingBehavior("fromView")(Qs),s.bindingBehavior("twoWay")(_s);class Xs extends s.BindingInterceptor{constructor(e,t){super(e,t),this.opts={delay:200},this.firstArg=null,this.task=null,this.taskQueue=e.locator.get(i.IPlatform).taskQueue,t.args.length>0&&(this.firstArg=t.args[0])}callSource(e){this.queueTask((()=>this.binding.callSource(e)))}handleChange(e,t,i){null!==this.task&&(this.task.cancel(),this.task=null),this.binding.handleChange(e,t,i)}updateSource(e,t){this.queueTask((()=>this.binding.updateSource(e,t)))}queueTask(e){const t=this.task;this.task=this.taskQueue.queueTask((()=>(this.task=null,e())),this.opts),null==t||t.cancel()}$bind(e,t){if(null!==this.firstArg){const i=Number(this.firstArg.evaluate(e,t,this.locator,null));this.opts.delay=isNaN(i)?200:i}this.binding.$bind(e,t)}$unbind(e){var t;null===(t=this.task)||void 0===t||t.cancel(),this.task=null,this.binding.$unbind(e)}}s.bindingBehavior("debounce")(Xs),exports.SignalBindingBehavior=class{constructor(e){this.signaler=e,this.lookup=new Map}bind(e,t,i,...s){if(!("handleChange"in i))throw new Error("The signal behavior can only be used with bindings that have a 'handleChange' method");if(0===s.length)throw new Error("At least one signal name must be passed to the signal behavior, e.g. `expr & signal:'my-signal'`");this.lookup.set(i,s);for(const e of s)this.signaler.addSignalListener(e,i)}unbind(e,t,i){const s=this.lookup.get(i);this.lookup.delete(i);for(const e of s)this.signaler.removeSignalListener(e,i)}},exports.SignalBindingBehavior=n([r(0,s.ISignaler)],exports.SignalBindingBehavior),s.bindingBehavior("signal")(exports.SignalBindingBehavior);class Ys extends s.BindingInterceptor{constructor(e,t){super(e,t),this.opts={delay:200},this.firstArg=null,this.task=null,this.lastCall=0,this.delay=0,this.platform=e.locator.get(i.IPlatform),this.taskQueue=this.platform.taskQueue,t.args.length>0&&(this.firstArg=t.args[0])}callSource(e){this.queueTask((()=>this.binding.callSource(e)))}handleChange(e,t,i){null!==this.task&&(this.task.cancel(),this.task=null,this.lastCall=this.platform.performanceNow()),this.binding.handleChange(e,t,i)}updateSource(e,t){this.queueTask((()=>this.binding.updateSource(e,t)))}queueTask(e){const t=this.opts,i=this.platform,s=this.lastCall+t.delay-i.performanceNow();if(s>0){const n=this.task;t.delay=s,this.task=this.taskQueue.queueTask((()=>{this.lastCall=i.performanceNow(),this.task=null,t.delay=this.delay,e()}),t),null==n||n.cancel()}else this.lastCall=i.performanceNow(),e()}$bind(e,t){if(null!==this.firstArg){const i=Number(this.firstArg.evaluate(e,t,this.locator,null));this.opts.delay=this.delay=isNaN(i)?200:i}this.binding.$bind(e,t)}$unbind(e){var t;null===(t=this.task)||void 0===t||t.cancel(),this.task=null,super.$unbind(e)}}s.bindingBehavior("throttle")(Ys);class Zs{constructor(){this.propertyKey="",this.type=6}getValue(e,t){return e.getAttribute(t)}setValue(e,t,i,s){null==e?i.removeAttribute(s):i.setAttribute(s,e)}}const Js=new Zs;function en(e){const t=e.composedPath()[0];if(this.target===t)return this.selfEventCallSource(e)}exports.AttrBindingBehavior=class{bind(e,t,i){i.targetObserver=Js}unbind(e,t,i){}},exports.AttrBindingBehavior=n([s.bindingBehavior("attr")],exports.AttrBindingBehavior),exports.SelfBindingBehavior=class{bind(e,t,i){if(!i.callSource||!i.targetEvent)throw new Error("Self binding behavior only supports events.");i.selfEventCallSource=i.callSource,i.callSource=en}unbind(e,t,i){i.callSource=i.selfEventCallSource,i.selfEventCallSource=null}},exports.SelfBindingBehavior=n([s.bindingBehavior("self")],exports.SelfBindingBehavior);const tn=E();class sn{constructor(e){this.namespace=e,this.type=6}static forNs(e){var t;return null!==(t=tn[e])&&void 0!==t?t:tn[e]=new sn(e)}getValue(e,t){return e.getAttributeNS(this.namespace,t)}setValue(e,t,i,s){null==e?i.removeAttributeNS(this.namespace,s):i.setAttributeNS(this.namespace,s,e)}}function nn(e,t){return e===t}class rn{constructor(e,t,i,s){this.handler=i,this.observerLocator=s,this.value=void 0,this.oldValue=void 0,this.type=7,this.collectionObserver=void 0,this.valueObserver=void 0,this.f=0,this.obj=e}getValue(){return this.value}setValue(e,t){const i=this.value;e!==i&&(this.value=e,this.oldValue=i,this.f=t,this.observe(),this.synchronizeElement(),this.queue.add(this))}handleCollectionChange(e,t){this.synchronizeElement()}handleChange(e,t,i){this.synchronizeElement()}synchronizeElement(){const e=this.value,t=this.obj,i=Object.prototype.hasOwnProperty.call(t,"model")?t.model:t.value,s=void 0!==t.matcher?t.matcher:nn;if("radio"===t.type)t.checked=!!s(e,i);else if(!0===e)t.checked=!0;else{let n=!1;if(e instanceof Array)n=-1!==e.findIndex((e=>!!s(e,i)));else if(e instanceof Set){for(const t of e)if(s(t,i)){n=!0;break}}else if(e instanceof Map)for(const t of e){const e=t[1];if(s(t[0],i)&&!0===e){n=!0;break}}t.checked=n}}handleEvent(){let e=this.oldValue=this.value;const t=this.obj,i=Object.prototype.hasOwnProperty.call(t,"model")?t.model:t.value,s=t.checked,n=void 0!==t.matcher?t.matcher:nn;if("checkbox"===t.type){if(e instanceof Array){const t=e.findIndex((e=>!!n(e,i)));return void(s&&-1===t?e.push(i):s||-1===t||e.splice(t,1))}if(e instanceof Set){const t={};let r=t;for(const t of e)if(!0===n(t,i)){r=t;break}return void(s&&r===t?e.add(i):s||r===t||e.delete(r))}if(e instanceof Map){let t;for(const s of e){const e=s[0];if(!0===n(e,i)){t=e;break}}return void e.set(t,s)}e=s}else{if(!s)return;e=i}this.value=e,this.queue.add(this)}start(){this.handler.subscribe(this.obj,this),this.observe()}stop(){var e,t;this.handler.dispose(),null===(e=this.collectionObserver)||void 0===e||e.unsubscribe(this),this.collectionObserver=void 0,null===(t=this.valueObserver)||void 0===t||t.unsubscribe(this)}subscribe(e){this.subs.add(e)&&1===this.subs.count&&this.start()}unsubscribe(e){this.subs.remove(e)&&0===this.subs.count&&this.stop()}flush(){on=this.oldValue,this.oldValue=this.value,this.subs.notify(this.value,on,this.f)}observe(){var e,t,i,s,n,r,o;const a=this.obj;null===(n=null!==(e=this.valueObserver)&&void 0!==e?e:this.valueObserver=null!==(i=null===(t=a.$observers)||void 0===t?void 0:t.model)&&void 0!==i?i:null===(s=a.$observers)||void 0===s?void 0:s.value)||void 0===n||n.subscribe(this),null===(r=this.collectionObserver)||void 0===r||r.unsubscribe(this),this.collectionObserver=void 0,"checkbox"===a.type&&(null===(o=this.collectionObserver=function(e,t){if(e instanceof Array)return t.getArrayObserver(e);if(e instanceof Map)return t.getMapObserver(e);if(e instanceof Set)return t.getSetObserver(e)}(this.value,this.observerLocator))||void 0===o||o.subscribe(this))}}let on;s.subscriberCollection(rn),s.withFlushQueue(rn);const an=Object.prototype.hasOwnProperty,ln={childList:!0,subtree:!0,characterData:!0};function cn(e,t){return e===t}class hn{constructor(e,t,i,s){this.handler=i,this.observerLocator=s,this.value=void 0,this.oldValue=void 0,this.hasChanges=!1,this.type=7,this.arrayObserver=void 0,this.nodeObserver=void 0,this.observing=!1,this.obj=e}getValue(){return this.observing?this.value:this.obj.multiple?Array.from(this.obj.options).map((e=>e.value)):this.obj.value}setValue(e,t){this.oldValue=this.value,this.value=e,this.hasChanges=e!==this.oldValue,this.observeArray(e instanceof Array?e:null),0==(256&t)&&this.flushChanges(t)}flushChanges(e){this.hasChanges&&(this.hasChanges=!1,this.syncOptions())}handleCollectionChange(){this.syncOptions()}syncOptions(){var e;const t=this.value,i=this.obj,s=Array.isArray(t),n=null!==(e=i.matcher)&&void 0!==e?e:cn,r=i.options;let o=r.length;for(;o-- >0;){const e=r[o],i=an.call(e,"model")?e.model:e.value;s?e.selected=-1!==t.findIndex((e=>!!n(i,e))):e.selected=!!n(i,t)}}syncValue(){const e=this.obj,t=e.options,i=t.length,s=this.value;let n=0;if(e.multiple){if(!(s instanceof Array))return!0;let r;const o=e.matcher||cn,a=[];for(;n<i;)r=t[n],r.selected&&a.push(an.call(r,"model")?r.model:r.value),++n;for(n=0;n<s.length;){const e=s[n];-1===a.findIndex((t=>!!o(e,t)))?s.splice(n,1):++n}for(n=0;n<a.length;){const e=a[n];-1===s.findIndex((t=>!!o(e,t)))&&s.push(e),++n}return!1}let r=null;for(;n<i;){const e=t[n];if(e.selected){r=an.call(e,"model")?e.model:e.value;break}++n}return this.oldValue=this.value,this.value=r,!0}start(){(this.nodeObserver=new this.obj.ownerDocument.defaultView.MutationObserver(this.handleNodeChange.bind(this))).observe(this.obj,ln),this.observeArray(this.value instanceof Array?this.value:null),this.observing=!0}stop(){var e;this.nodeObserver.disconnect(),null===(e=this.arrayObserver)||void 0===e||e.unsubscribe(this),this.nodeObserver=this.arrayObserver=void 0,this.observing=!1}observeArray(e){var t;if(null===(t=this.arrayObserver)||void 0===t||t.unsubscribe(this),this.arrayObserver=void 0,null!=e){if(!this.obj.multiple)throw new Error("Only null or Array instances can be bound to a multi-select.");(this.arrayObserver=this.observerLocator.getArrayObserver(e)).subscribe(this)}}handleEvent(){this.syncValue()&&this.queue.add(this)}handleNodeChange(){this.syncOptions();this.syncValue()&&this.queue.add(this)}subscribe(e){this.subs.add(e)&&1===this.subs.count&&(this.handler.subscribe(this.obj,this),this.start())}unsubscribe(e){this.subs.remove(e)&&0===this.subs.count&&(this.handler.dispose(),this.stop())}flush(){un=this.oldValue,this.oldValue=this.value,this.subs.notify(this.value,un,0)}}let un;s.subscriberCollection(hn),s.withFlushQueue(hn);class dn{constructor(e){this.obj=e,this.value="",this.oldValue="",this.styles={},this.version=0,this.hasChanges=!1,this.type=6}getValue(){return this.obj.style.cssText}setValue(e,t){this.value=e,this.hasChanges=e!==this.oldValue,0==(256&t)&&this.flushChanges(t)}getStyleTuplesFromString(e){const t=[],i=/url\([^)]+$/;let s,n,r,o,a=0,l="";for(;a<e.length;)s=e.indexOf(";",a),-1===s&&(s=e.length),l+=e.substring(a,s),a=s+1,i.test(l)?l+=";":(n=l.indexOf(":"),r=l.substring(0,n).trim(),o=l.substring(n+1).trim(),t.push([r,o]),l="");return t}getStyleTuplesFromObject(e){let t;const s=[];for(const n in e)if(t=e[n],null!=t)if("string"!=typeof t)s.push(...this.getStyleTuples(t));else{if(n.startsWith("--")){s.push([n,t]);continue}s.push([i.kebabCase(n),t])}return s}getStyleTuplesFromArray(e){const t=e.length;if(t>0){const i=[];for(let s=0;s<t;++s)i.push(...this.getStyleTuples(e[s]));return i}return i.emptyArray}getStyleTuples(e){return"string"==typeof e?this.getStyleTuplesFromString(e):e instanceof Array?this.getStyleTuplesFromArray(e):e instanceof Object?this.getStyleTuplesFromObject(e):i.emptyArray}flushChanges(e){if(this.hasChanges){this.hasChanges=!1;const e=this.value,t=this.styles,i=this.getStyleTuples(e);let s,n,r,o,a=this.version;this.oldValue=e;const l=i.length;for(let e=0;e<l;++e)n=i[e],r=n[0],o=n[1],this.setProperty(r,o),t[r]=a;if(this.styles=t,this.version+=1,0===a)return;for(s in a-=1,t)Object.prototype.hasOwnProperty.call(t,s)&&t[s]===a&&this.obj.style.removeProperty(s)}}setProperty(e,t){let i="";null!=t&&"function"==typeof t.indexOf&&t.includes("!important")&&(i="important",t=t.replace("!important","")),this.obj.style.setProperty(e,t,i)}bind(e){this.value=this.oldValue=this.obj.style.cssText}}class pn{constructor(e,t,i){this.propertyKey=t,this.handler=i,this.value="",this.oldValue="",this.hasChanges=!1,this.type=7,this.obj=e}getValue(){return this.value}setValue(e,t){Object.is(e,this.value)||(this.oldValue=this.value,this.value=e,this.hasChanges=!0,this.handler.config.readonly||0!=(256&t)||this.flushChanges(t))}flushChanges(e){var t;this.hasChanges&&(this.hasChanges=!1,this.obj[this.propertyKey]=null!==(t=this.value)&&void 0!==t?t:this.handler.config.default,0==(2&e)&&this.queue.add(this))}handleEvent(){this.oldValue=this.value,this.value=this.obj[this.propertyKey],this.oldValue!==this.value&&(this.hasChanges=!1,this.queue.add(this))}subscribe(e){this.subs.add(e)&&1===this.subs.count&&(this.handler.subscribe(this.obj,this),this.value=this.oldValue=this.obj[this.propertyKey])}unsubscribe(e){this.subs.remove(e)&&0===this.subs.count&&this.handler.dispose()}flush(){gn=this.oldValue,this.oldValue=this.value,this.subs.notify(this.value,gn,0)}}let gn;s.subscriberCollection(pn),s.withFlushQueue(pn);const fn="http://www.w3.org/1999/xlink",mn="http://www.w3.org/XML/1998/namespace",vn="http://www.w3.org/2000/xmlns/",bn=Object.assign(E(),{"xlink:actuate":["actuate",fn],"xlink:arcrole":["arcrole",fn],"xlink:href":["href",fn],"xlink:role":["role",fn],"xlink:show":["show",fn],"xlink:title":["title",fn],"xlink:type":["type",fn],"xml:lang":["lang",mn],"xml:space":["space",mn],xmlns:["xmlns",vn],"xmlns:xlink":["xlink",vn]}),xn=new s.PropertyAccessor;xn.type=6;class yn{constructor(e){var t;this.type=null!==(t=e.type)&&void 0!==t?t:pn,this.events=e.events,this.readonly=e.readonly,this.default=e.default}}class wn{constructor(e,t,i,s){this.locator=e,this.platform=t,this.dirtyChecker=i,this.svgAnalyzer=s,this.allowDirtyCheck=!0,this.events=E(),this.globalEvents=E(),this.overrides=E(),this.globalOverrides=E();const n=["change","input"],r={events:n,default:""};this.useConfig({INPUT:{value:r,valueAsNumber:{events:n,default:0},checked:{type:rn,events:n},files:{events:n,readonly:!0}},SELECT:{value:{type:hn,events:["change"],default:""}},TEXTAREA:{value:r}});const o={events:["change","input","blur","keyup","paste"],default:""},a={events:["scroll"],default:0};this.useConfigGlobal({scrollTop:a,scrollLeft:a,textContent:o,innerHTML:o}),this.overrideAccessorGlobal("css","style","class"),this.overrideAccessor({INPUT:["value","checked","model"],SELECT:["value"],TEXTAREA:["value"]})}static register(e){i.Registration.aliasTo(s.INodeObserverLocator,wn).register(e),i.Registration.singleton(s.INodeObserverLocator,wn).register(e)}handles(e,t){return e instanceof this.platform.Node}useConfig(e,t,i){var s,n;const r=this.events;let o;if("string"==typeof e)o=null!==(s=r[e])&&void 0!==s?s:r[e]=E(),null==o[t]?o[t]=new yn(i):Cn(e,t);else for(const i in e){o=null!==(n=r[i])&&void 0!==n?n:r[i]=E();const s=e[i];for(t in s)null==o[t]?o[t]=new yn(s[t]):Cn(i,t)}}useConfigGlobal(e,t){const i=this.globalEvents;if("object"==typeof e)for(const t in e)null==i[t]?i[t]=new yn(e[t]):Cn("*",t);else null==i[e]?i[e]=new yn(t):Cn("*",e)}getAccessor(e,t,s){var n;if(t in this.globalOverrides||t in(null!==(n=this.overrides[e.tagName])&&void 0!==n?n:i.emptyObject))return this.getObserver(e,t,s);switch(t){case"src":case"href":case"role":return Js;default:{const i=bn[t];return void 0!==i?sn.forNs(i[1]):B(e,t,this.svgAnalyzer)?Js:xn}}}overrideAccessor(e,t){var i,s,n,r;let o;if("string"==typeof e)o=null!==(i=(n=this.overrides)[e])&&void 0!==i?i:n[e]=E(),o[t]=!0;else for(const t in e)for(const i of e[t])o=null!==(s=(r=this.overrides)[t])&&void 0!==s?s:r[t]=E(),o[i]=!0}overrideAccessorGlobal(...e){for(const t of e)this.globalOverrides[t]=!0}getObserver(e,t,i){var n,r;switch(t){case"role":return Js;case"class":return new et(e);case"css":case"style":return new dn(e)}const o=null!==(r=null===(n=this.events[e.tagName])||void 0===n?void 0:n[t])&&void 0!==r?r:this.globalEvents[t];if(null!=o)return new o.type(e,t,new gi(o),i,this.locator);const a=bn[t];if(void 0!==a)return sn.forNs(a[1]);if(B(e,t,this.svgAnalyzer))return Js;if(t in e.constructor.prototype){if(this.allowDirtyCheck)return this.dirtyChecker.createProperty(e,t);throw new Error(`Unable to observe property ${String(t)}. Register observation mapping with .useConfig().`)}return new s.SetterObserver(e,t)}}function Cn(e,t){throw new Error(`Mapping for property ${String(t)} of <${e} /> already exists`)}wn.inject=[i.IServiceLocator,R,s.IDirtyChecker,I],exports.UpdateTriggerBindingBehavior=class{constructor(e){this.observerLocator=e}bind(e,t,i,...n){if(0===n.length)throw new Error("The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:'blur'\">");if(i.mode!==s.BindingMode.twoWay&&i.mode!==s.BindingMode.fromView)throw new Error("The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.");const r=this.observerLocator.getObserver(i.target,i.targetProperty);if(!r.handler)throw new Error("The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.");i.targetObserver=r;const o=r.handler;r.originalHandler=o,r.handler=new gi(new yn({default:o.config.default,events:n,readonly:o.config.readonly}))}unbind(e,t,i){i.targetObserver.handler.dispose(),i.targetObserver.handler=i.targetObserver.originalHandler,i.targetObserver.originalHandler=null}},exports.UpdateTriggerBindingBehavior=n([s.bindingBehavior("updateTrigger"),r(0,s.IObserverLocator)],exports.UpdateTriggerBindingBehavior),exports.Focus=class{constructor(e,t){this.element=e,this.p=t,this.needsApply=!1}binding(){this.valueChanged()}valueChanged(){this.$controller.isActive?this.apply():this.needsApply=!0}attached(){this.needsApply&&(this.needsApply=!1,this.apply());const e=this.element;e.addEventListener("focus",this),e.addEventListener("blur",this)}afterDetachChildren(){const e=this.element;e.removeEventListener("focus",this),e.removeEventListener("blur",this)}handleEvent(e){"focus"===e.type?this.value=!0:this.isElFocused||(this.value=!1)}apply(){const e=this.element,t=this.isElFocused,i=this.value;i&&!t?e.focus():!i&&t&&e.blur()}get isElFocused(){return this.element===this.p.document.activeElement}},n([o({mode:s.BindingMode.twoWay})],exports.Focus.prototype,"value",void 0),exports.Focus=n([Ae("focus"),r(0,Xt),r(1,R)],exports.Focus);let kn=class{constructor(e,t,i){this.el=e,this.p=t,this.isActive=!1,this.task=null,this.$val="",this.$prio="",this.update=()=>{this.task=null,Boolean(this.value)!==this.isToggled&&(this.isToggled===this.base?(this.isToggled=!this.base,this.$val=this.el.style.getPropertyValue("display"),this.$prio=this.el.style.getPropertyPriority("display"),this.el.style.setProperty("display","none","important")):(this.isToggled=this.base,this.el.style.setProperty("display",this.$val,this.$prio),""===this.el.getAttribute("style")&&this.el.removeAttribute("style")))},this.isToggled=this.base="hide"!==i.alias}binding(){this.isActive=!0,this.update()}detaching(){var e;this.isActive=!1,null===(e=this.task)||void 0===e||e.cancel(),this.task=null}valueChanged(){this.isActive&&null===this.task&&(this.task=this.p.domWriteQueue.queueTask(this.update))}};n([o],kn.prototype,"value",void 0),kn=n([Ae("show"),s.alias("hide"),r(0,Xt),r(1,R),r(2,wi)],kn),exports.Portal=class{constructor(e,t,s){this.factory=e,this.originalLoc=t,this.p=s,this.id=i.nextId("au$component"),this.strict=!1,this.currentTarget=s.document.createElement("div"),this.view=this.factory.create(),ii(this.view.nodes,t)}attaching(e,t,i){null==this.callbackContext&&(this.callbackContext=this.$controller.scope.bindingContext);const s=this.currentTarget=this.resolveTarget();return this.view.setHost(s),this.$activating(e,s,i)}detaching(e,t,i){return this.$deactivating(e,this.currentTarget,i)}targetChanged(){const{$controller:e}=this;if(!e.isActive)return;const t=this.currentTarget,s=this.currentTarget=this.resolveTarget();if(t===s)return;this.view.setHost(s);const n=i.onResolve(this.$deactivating(null,s,e.flags),(()=>this.$activating(null,s,e.flags)));n instanceof Promise&&n.catch((e=>{throw e}))}$activating(e,t,s){const{activating:n,callbackContext:r,view:o}=this;return o.setHost(t),i.onResolve(null==n?void 0:n.call(r,t,o),(()=>this.activate(e,t,s)))}activate(e,t,s){const{$controller:n,view:r}=this;return null!==e?i.onResolve(r.activate(null!=e?e:r,n,s,n.scope),(()=>this.$activated(t))):(r.nodes.appendTo(t),this.$activated(t))}$activated(e){const{activated:t,callbackContext:i,view:s}=this;return null==t?void 0:t.call(i,e,s)}$deactivating(e,t,s){const{deactivating:n,callbackContext:r,view:o}=this;return i.onResolve(null==n?void 0:n.call(r,t,o),(()=>this.deactivate(e,t,s)))}deactivate(e,t,s){const{$controller:n,view:r}=this;return null!==e?i.onResolve(r.deactivate(e,n,s),(()=>this.$deactivated(t))):(r.nodes.remove(),this.$deactivated(t))}$deactivated(e){const{deactivated:t,callbackContext:i,view:s}=this;return null==t?void 0:t.call(i,e,s)}resolveTarget(){const e=this.p,t=e.document;let i=this.target,s=this.renderContext;if(""===i){if(this.strict)throw new Error("Empty querySelector");return t.body}if("string"==typeof i){let n=t;"string"==typeof s&&(s=t.querySelector(s)),s instanceof e.Node&&(n=s),i=n.querySelector(i)}if(i instanceof e.Node)return i;if(null==i){if(this.strict)throw new Error("Portal target not found");return t.body}return i}dispose(){this.view.dispose(),this.view=void 0,this.callbackContext=null}accept(e){var t;if(!0===(null===(t=this.view)||void 0===t?void 0:t.accept(e)))return!0}},n([o({primary:!0})],exports.Portal.prototype,"target",void 0),n([o({callback:"targetChanged"})],exports.Portal.prototype,"renderContext",void 0),n([o()],exports.Portal.prototype,"strict",void 0),n([o()],exports.Portal.prototype,"deactivating",void 0),n([o()],exports.Portal.prototype,"activating",void 0),n([o()],exports.Portal.prototype,"deactivated",void 0),n([o()],exports.Portal.prototype,"activated",void 0),n([o()],exports.Portal.prototype,"callbackContext",void 0),exports.Portal=n([Te("portal"),r(0,Ve),r(1,Zt),r(2,R)],exports.Portal);class An{constructor(e,t,s){this.factory=e,this.flags=s,this.id=i.nextId("au$component"),this.view=this.factory.create().setLocation(t)}attaching(e,t,i){const{$controller:s}=this;return this.view.activate(e,s,i|this.flags,s.scope)}detaching(e,t,i){return this.view.deactivate(e,this.$controller,i)}dispose(){this.view.dispose(),this.view=void 0}accept(e){var t;if(!0===(null===(t=this.view)||void 0===t?void 0:t.accept(e)))return!0}}class Tn extends An{constructor(e,t){super(e,t,512)}}Tn.inject=[Ve,Zt];class Pn extends An{constructor(e,t){super(e,t,128)}}function On(e){e.dispose()}Pn.inject=[Ve,Zt],Te("frequent-mutations")(Tn),Te("observe-shallow")(Pn),exports.If=class{constructor(e,t,s){this.ifFactory=e,this.location=t,this.work=s,this.id=i.nextId("au$component"),this.elseFactory=void 0,this.elseView=void 0,this.ifView=void 0,this.view=void 0,this.value=!1,this.cache=!0,this.pending=void 0,this.wantsDeactivate=!1,this.swapId=0}created(){this.ctrl=this.$controller}attaching(e,t,s){let n;const r=this.swapId++,o=()=>!this.wantsDeactivate&&this.swapId===r+1;return i.onResolve(this.pending,(()=>{var t;o()&&(this.pending=void 0,n=this.view=this.value?this.ifView=this.cache&&null!=this.ifView?this.ifView:this.ifFactory.create(s):this.elseView=this.cache&&null!=this.elseView?this.elseView:null===(t=this.elseFactory)||void 0===t?void 0:t.create(s),null!=n&&(n.setLocation(this.location),this.pending=i.onResolve(n.activate(e,this.ctrl,s,this.ctrl.scope),(()=>{o()&&(this.pending=void 0)}))))}))}detaching(e,t,s){return this.wantsDeactivate=!0,i.onResolve(this.pending,(()=>{var t;this.wantsDeactivate=!1,this.pending=void 0,null===(t=this.view)||void 0===t||t.deactivate(e,this.ctrl,s)}))}valueChanged(e,t,s){if(!this.ctrl.isActive)return;if((e=!!e)===(t=!!t))return;this.work.start();const n=this.view,r=this.swapId++,o=()=>!this.wantsDeactivate&&this.swapId===r+1;let a;return i.onResolve(i.onResolve(this.pending,(()=>this.pending=i.onResolve(null==n?void 0:n.deactivate(n,this.ctrl,s),(()=>{var t;if(o()&&(a=this.view=e?this.ifView=this.cache&&null!=this.ifView?this.ifView:this.ifFactory.create(s):this.elseView=this.cache&&null!=this.elseView?this.elseView:null===(t=this.elseFactory)||void 0===t?void 0:t.create(s),null!=a))return a.setLocation(this.location),i.onResolve(a.activate(a,this.ctrl,s,this.ctrl.scope),(()=>{o()&&(this.pending=void 0)}))})))),(()=>this.work.finish()))}dispose(){var e,t;null===(e=this.ifView)||void 0===e||e.dispose(),null===(t=this.elseView)||void 0===t||t.dispose(),this.ifView=this.elseView=this.view=void 0}accept(e){var t;if(!0===(null===(t=this.view)||void 0===t?void 0:t.accept(e)))return!0}},n([o],exports.If.prototype,"value",void 0),n([o({set:e=>""===e||!!e&&"false"!==e})],exports.If.prototype,"cache",void 0),exports.If=n([Te("if"),r(0,Ve),r(1,Zt),r(2,Ut)],exports.If),exports.Else=class{constructor(e){this.factory=e,this.id=i.nextId("au$component")}link(e,t,i,s,n,r){const o=i.children,a=o[o.length-1];if(a instanceof exports.If)a.elseFactory=this.factory;else{if(!(a.viewModel instanceof exports.If))throw new Error("Unsupported IfBehavior");a.viewModel.elseFactory=this.factory}}},exports.Else=n([Te({name:"else"}),r(0,Ve)],exports.Else),exports.Repeat=class{constructor(e,t,s){this.location=e,this.parent=t,this.factory=s,this.id=i.nextId("au$component"),this.hasPendingInstanceMutation=!1,this.observer=void 0,this.views=[],this.key=void 0,this.normalizedItems=void 0}binding(e,t,i){this.checkCollectionObserver(i);const s=this.parent.bindings;let n;for(let e=0,t=s.length;e<t;++e)if(n=s[e],n.target===this&&"items"===n.targetProperty){this.forOf=n.sourceExpression;break}this.local=this.forOf.declaration.evaluate(i,this.$controller.scope,n.locator,null)}attaching(e,t,i){return this.normalizeToArray(i),this.activateAllViews(e,i)}detaching(e,t,i){return this.checkCollectionObserver(i),this.deactivateAllViews(e,i)}itemsChanged(e){const{$controller:t}=this;if(!t.isActive)return;this.checkCollectionObserver(e|=t.flags),this.normalizeToArray(e);const s=i.onResolve(this.deactivateAllViews(null,e),(()=>this.activateAllViews(null,e)));s instanceof Promise&&s.catch((e=>{throw e}))}handleCollectionChange(e,t){const{$controller:n}=this;if(n.isActive)if(this.normalizeToArray(t|=n.flags),void 0===e){const e=i.onResolve(this.deactivateAllViews(null,t),(()=>this.activateAllViews(null,t)));e instanceof Promise&&e.catch((e=>{throw e}))}else{const n=this.views.length;if(s.applyMutationsToIndices(e),e.deletedItems.length>0){e.deletedItems.sort(i.compareNumber);const s=i.onResolve(this.deactivateAndRemoveViewsByKey(e,t),(()=>this.createAndActivateAndSortViewsByKey(n,e,t)));s instanceof Promise&&s.catch((e=>{throw e}))}else this.createAndActivateAndSortViewsByKey(n,e,t)}}checkCollectionObserver(e){const t=this.observer;if(4&e)void 0!==t&&t.unsubscribe(this);else if(this.$controller.isActive){const e=this.observer=s.getCollectionObserver(this.items);t!==e&&t&&t.unsubscribe(this),e&&e.subscribe(this)}}normalizeToArray(e){const t=this.items;if(t instanceof Array)return void(this.normalizedItems=t);if(void 0===this.forOf)return;const i=[];this.forOf.iterate(e,t,((e,t,s)=>{i[t]=s})),this.normalizedItems=i}activateAllViews(e,t){let i,n,r,o;const{$controller:a,factory:l,local:c,location:h,items:u}=this,d=a.scope,p=this.forOf.count(t,u),g=this.views=Array(p);if(this.forOf.iterate(t,u,((u,f,m)=>{r=g[f]=l.create(t).setLocation(h),r.nodes.unlink(),o=s.Scope.fromParent(d,s.BindingContext.create(c,m)),Rn(o.overrideContext,f,p),n=r.activate(null!=e?e:r,a,t,o),n instanceof Promise&&(null!=i?i:i=[]).push(n)})),void 0!==i)return 1===i.length?i[0]:Promise.all(i)}deactivateAllViews(e,t){let i,s,n;const{views:r,$controller:o}=this;for(let a=0,l=r.length;a<l;++a)n=r[a],n.release(),s=n.deactivate(null!=e?e:n,o,t),s instanceof Promise&&(null!=i?i:i=[]).push(s);if(void 0!==i)return 1===i.length?i[0]:Promise.all(i)}deactivateAndRemoveViewsByKey(e,t){let i,s,n;const{$controller:r,views:o}=this,a=e.deletedItems,l=a.length;let c=0;for(;c<l;++c)n=o[a[c]],n.release(),s=n.deactivate(n,r,t),s instanceof Promise&&(null!=i?i:i=[]).push(s);c=0;let h=0;for(;c<l;++c)h=a[c]-c,o.splice(h,1);if(void 0!==i)return 1===i.length?i[0]:Promise.all(i)}createAndActivateAndSortViewsByKey(e,t,i){var n;let r,o,a,l;const{$controller:c,factory:h,local:u,normalizedItems:d,location:p,views:g}=this,f=t.length;for(let e=0;e<f;++e)-2===t[e]&&(a=h.create(i),g.splice(e,0,a));if(g.length!==f)throw new Error(`viewsLen=${g.length}, mapLen=${f}`);const m=c.scope,v=t.length;s.synchronizeIndices(g,t);const b=function(e){const t=e.length;t>Sn&&(Sn=t,Bn=new Int32Array(t),En=new Int32Array(t));let i=0,s=0,n=0,r=0,o=0,a=0,l=0,c=0;for(;r<t;r++)if(s=e[r],-2!==s){if(o=Bn[i],n=e[o],-2!==n&&n<s){En[r]=o,Bn[++i]=r;continue}for(a=0,l=i;a<l;)c=a+l>>1,n=e[Bn[c]],-2!==n&&n<s?a=c+1:l=c;n=e[Bn[a]],(s<n||-2===n)&&(a>0&&(En[r]=Bn[a-1]),Bn[a]=r)}r=++i;const h=new Int32Array(r);s=Bn[i-1];for(;i-- >0;)h[i]=s,s=En[s];for(;r-- >0;)Bn[r]=0;return h}(t),x=b.length;let y,w=x-1,C=v-1;for(;C>=0;--C)a=g[C],y=g[C+1],a.nodes.link(null!==(n=null==y?void 0:y.nodes)&&void 0!==n?n:p),-2===t[C]?(l=s.Scope.fromParent(m,s.BindingContext.create(u,d[C])),Rn(l.overrideContext,C,v),a.setLocation(p),o=a.activate(a,c,i,l),o instanceof Promise&&(null!=r?r:r=[]).push(o)):w<0||1===x||C!==b[w]?(Rn(a.scope.overrideContext,C,v),a.nodes.insertBefore(a.location)):(e!==v&&Rn(a.scope.overrideContext,C,v),--w);if(void 0!==r)return 1===r.length?r[0]:Promise.all(r)}dispose(){this.views.forEach(On),this.views=void 0}accept(e){const{views:t}=this;if(void 0!==t)for(let i=0,s=t.length;i<s;++i)if(!0===t[i].accept(e))return!0}},n([o],exports.Repeat.prototype,"items",void 0),exports.Repeat=n([Te("repeat"),r(0,Zt),r(1,Nt),r(2,Ve)],exports.Repeat);let Sn=16,Bn=new Int32Array(Sn),En=new Int32Array(Sn);function Rn(e,t,i){const s=0===t,n=t===i-1,r=t%2==0;e.$index=t,e.$first=s,e.$last=n,e.$middle=!s&&!n,e.$even=r,e.$odd=!r,e.$length=i}function In(e){const t=e.parent,i=null==t?void 0:t.viewModel;if(i instanceof exports.PromiseTemplateController)return i;throw new Error("The parent promise.resolve not found; only `*[promise.resolve] > *[pending|then|catch]` relation is supported.")}function $n(e,t,i,s){if("string"==typeof t)return function(e,t,i,s){const n=[],r=[],o=[],a=e.document.createElement(t);let l=!1;i&&Object.keys(i).forEach((e=>{const t=i[e];Ci(t)?(l=!0,n.push(t)):a.setAttribute(e,t)}));l&&(a.className="au",r.push(n));s&&Mn(e,a,s,r,o);return new Dn(a,r,o)}(e,t,i,s);if(Me.isType(t))return function(e,t,i,s){const n=Me.getDefinition(t),r=[],o=[r],a=[],l=[],c=n.bindables,h=e.document.createElement(n.name);h.className="au",a.includes(t)||a.push(t);r.push(new Bi(n,void 0,l,null,!1)),i&&Object.keys(i).forEach((e=>{const t=i[e];Ci(t)?l.push(t):l.push(void 0===c[e]?new ji(t,e):new Si(t,e))}));s&&Mn(e,h,s,o,a);return new Dn(h,o,a)}(e,t,i,s);throw new Error("Invalid tagOrType.")}exports.With=class{constructor(e,t){this.factory=e,this.location=t,this.id=i.nextId("au$component"),this.id=i.nextId("au$component"),this.view=this.factory.create().setLocation(t)}valueChanged(e,t,i){const n=this.$controller,r=this.view.bindings;let o,a=0,l=0;if(n.isActive&&null!=r)for(o=s.Scope.fromParent(n.scope,void 0===e?{}:e),l=r.length;l>a;++a)r[a].$bind(2,o)}attaching(e,t,i){const{$controller:n,value:r}=this,o=s.Scope.fromParent(n.scope,void 0===r?{}:r);return this.view.activate(e,n,i,o)}detaching(e,t,i){return this.view.deactivate(e,this.$controller,i)}dispose(){this.view.dispose(),this.view=void 0}accept(e){var t;if(!0===(null===(t=this.view)||void 0===t?void 0:t.accept(e)))return!0}},n([o],exports.With.prototype,"value",void 0),exports.With=n([Te("with"),r(0,Ve),r(1,Zt)],exports.With),exports.Switch=class{constructor(e,t){this.factory=e,this.location=t,this.id=i.nextId("au$component"),this.cases=[],this.activeCases=[],this.promise=void 0}link(e,t,i,s,n,r){this.view=this.factory.create(e,this.$controller).setLocation(this.location)}attaching(e,t,i){const s=this.view,n=this.$controller;return this.queue((()=>s.activate(e,n,i,n.scope))),this.queue((()=>this.swap(e,i,this.value))),this.promise}detaching(e,t,i){return this.queue((()=>this.view.deactivate(e,this.$controller,i))),this.promise}dispose(){var e;null===(e=this.view)||void 0===e||e.dispose(),this.view=void 0}valueChanged(e,t,i){this.$controller.isActive&&this.queue((()=>this.swap(null,i,this.value)))}caseChanged(e,t){this.queue((()=>this.handleCaseChange(e,t)))}handleCaseChange(e,t){const s=e.isMatch(this.value,t),n=this.activeCases,r=n.length;if(!s)return r>0&&n[0].id===e.id?this.clearActiveCases(null,t):void 0;if(r>0&&n[0].id<e.id)return;const o=[];let a=e.fallThrough;if(a){const t=this.cases;for(let i=t.indexOf(e),s=t.length;i<s&&a;i++){const e=t[i];o.push(e),a=e.fallThrough}}else o.push(e);return i.onResolve(this.clearActiveCases(null,t,o),(()=>(this.activeCases=o,this.activateCases(null,t))))}swap(e,t,s){const n=[];let r=!1;for(const e of this.cases)if((r||e.isMatch(s,t))&&(n.push(e),r=e.fallThrough),n.length>0&&!r)break;const o=this.defaultCase;return 0===n.length&&void 0!==o&&n.push(o),i.onResolve(this.activeCases.length>0?this.clearActiveCases(e,t,n):void 0,(()=>{if(this.activeCases=n,0!==n.length)return this.activateCases(e,t)}))}activateCases(e,t){const s=this.$controller;if(!s.isActive)return;const n=this.activeCases,r=n.length;if(0===r)return;const o=s.scope;return 1===r?n[0].activate(e,t,o):i.resolveAll(...n.map((i=>i.activate(e,t,o))))}clearActiveCases(e,t,s=[]){const n=this.activeCases,r=n.length;if(0!==r){if(1===r){const i=n[0];return s.includes(i)?void 0:(n.length=0,i.deactivate(e,t))}return i.onResolve(i.resolveAll(...n.reduce(((i,n)=>(s.includes(n)||i.push(n.deactivate(e,t)),i)),[])),(()=>{n.length=0}))}}queue(e){let t;t=this.promise=i.onResolve(i.onResolve(this.promise,e),(()=>{this.promise===t&&(this.promise=void 0)}))}accept(e){return!0===this.$controller.accept(e)||(!!this.activeCases.some((t=>t.accept(e)))||void 0)}},n([o],exports.Switch.prototype,"value",void 0),exports.Switch=n([Te("switch"),r(0,Ve),r(1,Zt)],exports.Switch),exports.Case=class{constructor(e,t,s,n){this.factory=e,this.locator=t,this.id=i.nextId("au$component"),this.fallThrough=!1,this.debug=n.config.level<=1,this.logger=n.scopeTo(`${this.constructor.name}-#${this.id}`),this.view=this.factory.create().setLocation(s)}link(e,t,i,s,n,r){const o=i.parent,a=null==o?void 0:o.viewModel;if(!(a instanceof exports.Switch))throw new Error("The parent switch not found; only `*[switch] > *[case|default-case]` relation is supported.");this.$switch=a,this.linkToSwitch(a)}detaching(e,t,i){return this.deactivate(e,i)}isMatch(e,t){this.debug&&this.logger.debug("isMatch()");const i=this.value;return Array.isArray(i)?(void 0===this.observer&&(this.observer=this.observeCollection(t,i)),i.includes(e)):i===e}valueChanged(e,t,i){var s;Array.isArray(e)?(null===(s=this.observer)||void 0===s||s.unsubscribe(this),this.observer=this.observeCollection(i,e)):void 0!==this.observer&&this.observer.unsubscribe(this),this.$switch.caseChanged(this,i)}handleCollectionChange(e,t){this.$switch.caseChanged(this,t)}activate(e,t,i){const s=this.view;if(!s.isActive)return s.activate(null!=e?e:s,this.$controller,t,i)}deactivate(e,t){const i=this.view;if(i.isActive)return i.deactivate(null!=e?e:i,this.$controller,t)}dispose(){var e,t;null===(e=this.observer)||void 0===e||e.unsubscribe(this),null===(t=this.view)||void 0===t||t.dispose(),this.view=void 0}linkToSwitch(e){e.cases.push(this)}observeCollection(e,t){const i=this.locator.getArrayObserver(t);return i.subscribe(this),i}accept(e){var t;return!0===this.$controller.accept(e)||(null===(t=this.view)||void 0===t?void 0:t.accept(e))}},n([o],exports.Case.prototype,"value",void 0),n([o({set:e=>{switch(e){case"true":return!0;case"false":return!1;default:return!!e}},mode:s.BindingMode.oneTime})],exports.Case.prototype,"fallThrough",void 0),exports.Case=n([Te("case"),r(0,Ve),r(1,s.IObserverLocator),r(2,Zt),r(3,i.ILogger)],exports.Case),exports.DefaultCase=class extends exports.Case{linkToSwitch(e){if(void 0!==e.defaultCase)throw new Error("Multiple 'default-case's are not allowed.");e.defaultCase=this}},exports.DefaultCase=n([Te("default-case")],exports.DefaultCase),exports.PromiseTemplateController=class{constructor(e,t,s,n){this.factory=e,this.location=t,this.platform=s,this.id=i.nextId("au$component"),this.preSettledTask=null,this.postSettledTask=null,this.logger=n.scopeTo("promise.resolve")}link(e,t,i,s,n,r){this.view=this.factory.create(e,this.$controller).setLocation(this.location)}attaching(e,t,n){const r=this.$controller;return i.onResolve(this.view.activate(e,r,n,this.viewScope=s.Scope.fromParent(r.scope,{})),(()=>this.swap(e,n)))}valueChanged(e,t,i){this.$controller.isActive&&this.swap(null,i)}swap(e,t){var s,n;const r=this.value;if(!(r instanceof Promise))return void this.logger.warn(`The value '${String(r)}' is not a promise. No change will be done.`);const o=this.platform.domWriteQueue,a=this.fulfilled,l=this.rejected,c=this.pending,h=this.viewScope;let u;const d={reusable:!1},p=()=>{i.resolveAll(u=(this.preSettledTask=o.queueTask((()=>i.resolveAll(null==a?void 0:a.deactivate(e,t),null==l?void 0:l.deactivate(e,t),null==c?void 0:c.activate(e,t,h))),d)).result,r.then((s=>{if(this.value!==r)return;const n=()=>{this.postSettlePromise=(this.postSettledTask=o.queueTask((()=>i.resolveAll(null==c?void 0:c.deactivate(e,t),null==l?void 0:l.deactivate(e,t),null==a?void 0:a.activate(e,t,h,s))),d)).result};1===this.preSettledTask.status?u.then(n):(this.preSettledTask.cancel(),n())}),(s=>{if(this.value!==r)return;const n=()=>{this.postSettlePromise=(this.postSettledTask=o.queueTask((()=>i.resolveAll(null==c?void 0:c.deactivate(e,t),null==a?void 0:a.deactivate(e,t),null==l?void 0:l.activate(e,t,h,s))),d)).result};1===this.preSettledTask.status?u.then(n):(this.preSettledTask.cancel(),n())})))};1===(null===(s=this.postSettledTask)||void 0===s?void 0:s.status)?this.postSettlePromise.then(p):(null===(n=this.postSettledTask)||void 0===n||n.cancel(),p())}detaching(e,t,i){var s,n;return null===(s=this.preSettledTask)||void 0===s||s.cancel(),null===(n=this.postSettledTask)||void 0===n||n.cancel(),this.preSettledTask=this.postSettledTask=null,this.view.deactivate(e,this.$controller,i)}dispose(){var e;null===(e=this.view)||void 0===e||e.dispose(),this.view=void 0}},n([o],exports.PromiseTemplateController.prototype,"value",void 0),exports.PromiseTemplateController=n([Te("promise"),r(0,Ve),r(1,Zt),r(2,R),r(3,i.ILogger)],exports.PromiseTemplateController),exports.PendingTemplateController=class{constructor(e,t){this.factory=e,this.id=i.nextId("au$component"),this.view=this.factory.create().setLocation(t)}link(e,t,i,s,n,r){In(i).pending=this}activate(e,t,i){const s=this.view;if(!s.isActive)return s.activate(s,this.$controller,t,i)}deactivate(e,t){const i=this.view;if(i.isActive)return i.deactivate(i,this.$controller,t)}detaching(e,t,i){return this.deactivate(e,i)}dispose(){var e;null===(e=this.view)||void 0===e||e.dispose(),this.view=void 0}},n([o({mode:s.BindingMode.toView})],exports.PendingTemplateController.prototype,"value",void 0),exports.PendingTemplateController=n([Te("pending"),r(0,Ve),r(1,Zt)],exports.PendingTemplateController),exports.FulfilledTemplateController=class{constructor(e,t){this.factory=e,this.id=i.nextId("au$component"),this.view=this.factory.create().setLocation(t)}link(e,t,i,s,n,r){In(i).fulfilled=this}activate(e,t,i,s){this.value=s;const n=this.view;if(!n.isActive)return n.activate(n,this.$controller,t,i)}deactivate(e,t){const i=this.view;if(i.isActive)return i.deactivate(i,this.$controller,t)}detaching(e,t,i){return this.deactivate(e,i)}dispose(){var e;null===(e=this.view)||void 0===e||e.dispose(),this.view=void 0}},n([o({mode:s.BindingMode.toView})],exports.FulfilledTemplateController.prototype,"value",void 0),exports.FulfilledTemplateController=n([Te("then"),r(0,Ve),r(1,Zt)],exports.FulfilledTemplateController),exports.RejectedTemplateController=class{constructor(e,t){this.factory=e,this.id=i.nextId("au$component"),this.view=this.factory.create().setLocation(t)}link(e,t,i,s,n,r){In(i).rejected=this}activate(e,t,i,s){this.value=s;const n=this.view;if(!n.isActive)return n.activate(n,this.$controller,t,i)}deactivate(e,t){const i=this.view;if(i.isActive)return i.deactivate(i,this.$controller,t)}detaching(e,t,i){return this.deactivate(e,i)}dispose(){var e;null===(e=this.view)||void 0===e||e.dispose(),this.view=void 0}},n([o({mode:s.BindingMode.toView})],exports.RejectedTemplateController.prototype,"value",void 0),exports.RejectedTemplateController=n([Te("catch"),r(0,Ve),r(1,Zt)],exports.RejectedTemplateController);class Dn{constructor(e,t,i){this.node=e,this.instructions=t,this.dependencies=i,this.lazyDefinition=void 0,this.childFor=new WeakMap}get definition(){return void 0===this.lazyDefinition&&(this.lazyDefinition=$e.create({name:Me.generateName(),template:this.node,needsCompile:"string"==typeof this.node,instructions:this.instructions,dependencies:this.dependencies})),this.lazyDefinition}getContext(e){const t=this.childFor;let i=t.get(e);return null==i&&t.set(e,(i=e.createChild()).register(...this.dependencies)),_e(this.definition,i)}createView(e){return this.getViewFactory(e).create()}getViewFactory(e){return this.getContext(e).getViewFactory()}mergeInto(e,t,i){e.appendChild(this.node),t.push(...this.instructions),i.push(...this.dependencies)}}function Mn(e,t,i,s,n){for(let r=0,o=i.length;r<o;++r){const o=i[r];switch(typeof o){case"string":t.appendChild(e.document.createTextNode(o));break;case"object":o instanceof e.Node?t.appendChild(o):"mergeInto"in o&&o.mergeInto(t,s,n)}}}function jn(e,t){const i=t.to;return void 0!==i&&"subject"!==i&&"composing"!==i&&(e[i]=t),e}exports.AuRender=class{constructor(e,t,s){this.p=e,this.hdrContext=s,this.id=i.nextId("au$component"),this.component=void 0,this.composing=!1,this.view=void 0,this.lastSubject=void 0,this.properties=t.instructions.reduce(jn,{})}attaching(e,t,i){const{component:s,view:n}=this;return void 0===n||this.lastSubject!==s?(this.lastSubject=s,this.composing=!0,this.compose(void 0,s,e,i)):this.compose(n,s,e,i)}detaching(e,t,i){return this.deactivate(this.view,e,i)}componentChanged(e,t,s){const{$controller:n}=this;if(!n.isActive)return;if(this.lastSubject===e)return;this.lastSubject=e,this.composing=!0;const r=i.onResolve(this.deactivate(this.view,null,s|=n.flags),(()=>this.compose(void 0,e,null,s)));r instanceof Promise&&r.catch((e=>{throw e}))}compose(e,t,s,n){return i.onResolve(void 0===e?i.onResolve(t,(e=>this.resolveView(e,n))):e,(e=>this.activate(this.view=e,s,n)))}deactivate(e,t,i){return null==e?void 0:e.deactivate(null!=t?t:e,this.$controller,i)}activate(e,t,s){const{$controller:n}=this;return i.onResolve(null==e?void 0:e.activate(null!=t?t:e,n,s,n.scope),(()=>{this.composing=!1}))}resolveView(e,t){const i=this.provideViewFor(e,t);if(i)return i.setLocation(this.$controller.location),i.lockScope(this.$controller.scope),i}provideViewFor(e,t){if(!e)return;const i=this.hdrContext.controller.container;if("object"==typeof e){if("lockScope"in e)return e;if("createView"in e)return e.createView(i);if("create"in e)return e.create(t);if("template"in e){return _e($e.getOrCreate(e),i).getViewFactory().create(t)}}if("string"==typeof e){const t=i.find(Me,e);if(null==t)throw new Error(`Unable to find custom element ${e} for <au-render>.`);e=t.Type}return $n(this.p,e,this.properties,this.$controller.host.childNodes).createView(i)}dispose(){var e;null===(e=this.view)||void 0===e||e.dispose(),this.view=void 0}accept(e){var t;if(!0===(null===(t=this.view)||void 0===t?void 0:t.accept(e)))return!0}},n([o],exports.AuRender.prototype,"component",void 0),n([o({mode:s.BindingMode.fromView})],exports.AuRender.prototype,"composing",void 0),exports.AuRender=n([Re({name:"au-render",template:null,containerless:!0}),r(0,R),r(1,wi),r(2,Ft)],exports.AuRender),exports.AuCompose=class{constructor(e,t,i,s,n,r){this.container=e,this.parent=t,this.host=i,this.p=s,this.instruction=n,this.contextFactory=r,this.scopeBehavior="auto",this.task=null,this.c=void 0,this.loc=n.containerless?si(this.host):void 0}static get inject(){return[i.IContainer,Nt,Xt,R,wi,i.transient(Vn)]}get composition(){return this.c}attaching(e,t,i){return this.queue(new Nn(this.view,this.viewModel,this.model,e,void 0))}detaching(e){var t;null===(t=this.task)||void 0===t||t.cancel(),this.task=null;const i=this.c;if(null!=i)return this.c=void 0,i.deactivate(e)}propertyChanged(e){const t=this.task;this.task=this.p.domWriteQueue.queueTask((()=>i.onResolve(this.queue(new Nn(this.view,this.viewModel,this.model,void 0,e)),(()=>{this.task=null})))),null==t||t.cancel()}queue(e){const t=this.contextFactory,s=this.c;return"model"===e.src&&null!=s?s.update(e.model):i.onResolve(t.create(e),(n=>{if(t.isCurrent(n))return i.onResolve(this.compose(n),(r=>{if(t.isCurrent(n))return i.onResolve(r.activate(),(()=>t.isCurrent(n)?(this.c=r,null==s?void 0:s.deactivate(e.initiator)):i.onResolve(r.controller.deactivate(r.controller,this.$controller,4),(()=>r.controller.dispose()))));r.controller.dispose()}))}))}compose(e){let t,n,r;const{view:o,viewModel:a,model:l,initiator:c}=e.change,{container:h,host:u,$controller:d,contextFactory:p,loc:g}=this,f=this.getDef(a),m=h.createChild(),v=null==g?u.parentNode:g.parentNode;if(null!==f){if(f.containerless)throw new Error("Containerless custom element is not supported by <au-compose/>");null==g?(n=u,r=()=>{}):(n=v.insertBefore(this.p.document.createElement(f.name),g),r=()=>{n.remove()}),t=this.getVm(m,a,n)}else n=null==g?u:g,t=this.getVm(m,a,n);const b=()=>{if(null!==f){const s=St.forCustomElement(null,h,m,t,n,null,0,!0,f);return new zn(s,(()=>s.activate(null!=c?c:s,d,2)),(e=>i.onResolve(s.deactivate(null!=e?e:s,d,4),r)),(e=>{var i;return null===(i=t.activate)||void 0===i?void 0:i.call(t,e)}),e)}{const i=_e($e.create({name:Me.generateName(),template:o}),m),r=i.getViewFactory(),a=St.forSyntheticView(p.isFirst(e)?d.root:null,i,r,2,d),l="auto"===this.scopeBehavior?s.Scope.fromParent(this.parent.scope,t):s.Scope.create(t);return ni(n)?a.setLocation(n):a.setHost(n),new zn(a,(()=>a.activate(null!=c?c:a,d,2,l)),(e=>a.deactivate(null!=e?e:a,d,4)),(e=>{var i;return null===(i=t.activate)||void 0===i?void 0:i.call(t,e)}),e)}};return"activate"in t?i.onResolve(t.activate(l),(()=>b())):b()}getVm(e,t,s){if(null==t)return new Ln;if("object"==typeof t)return t;const n=this.p,r=ni(s),o=new i.InstanceProvider("ElementResolver",r?null:s);e.registerResolver(Xt,o),e.registerResolver(n.Node,o),e.registerResolver(n.Element,o),e.registerResolver(n.HTMLElement,o),e.registerResolver(Zt,new i.InstanceProvider("IRenderLocation",r?s:null));const a=e.invoke(t);return e.registerResolver(t,new i.InstanceProvider("au-compose.viewModel",a)),a}getDef(e){const t="function"==typeof e?e:null==e?void 0:e.constructor;return Me.isType(t)?Me.getDefinition(t):null}},n([o],exports.AuCompose.prototype,"view",void 0),n([o],exports.AuCompose.prototype,"viewModel",void 0),n([o],exports.AuCompose.prototype,"model",void 0),n([o({set:e=>{if("scoped"===e||"auto"===e)return e;throw new Error('Invalid scope behavior config. Only "scoped" or "auto" allowed.')}})],exports.AuCompose.prototype,"scopeBehavior",void 0),exports.AuCompose=n([Re("au-compose")],exports.AuCompose);class Ln{}class Vn{constructor(){this.id=0}isFirst(e){return 0===e.id}isCurrent(e){return e.id===this.id-1}create(e){return i.onResolve(e.load(),(e=>new qn(this.id++,e)))}}class Nn{constructor(e,t,i,s,n){this.view=e,this.viewModel=t,this.model=i,this.initiator=s,this.src=n}load(){return this.view instanceof Promise||this.viewModel instanceof Promise?Promise.all([this.view,this.viewModel]).then((([e,t])=>new Fn(e,t,this.model,this.initiator,this.src))):new Fn(this.view,this.viewModel,this.model,this.initiator,this.src)}}class Fn{constructor(e,t,i,s,n){this.view=e,this.viewModel=t,this.model=i,this.initiator=s,this.src=n}}class qn{constructor(e,t){this.id=e,this.change=t}}class zn{constructor(e,t,i,s,n){this.controller=e,this.start=t,this.stop=i,this.update=s,this.context=n,this.state=0}activate(){if(0!==this.state)throw new Error(`Composition has already been activated/deactivated. Id: ${this.controller.id}`);return this.state=1,this.start()}deactivate(e){switch(this.state){case 1:return this.state=-1,this.stop(e);case-1:throw new Error("Composition has already been deactivated.");default:this.state=-1}}}class Wn{constructor(e,t,i){var s,n;let r;this.hdrContext=i,this.parentScope=null,this.outerScope=null;const o=t.auSlot,a=null===(n=null===(s=i.instruction)||void 0===s?void 0:s.projections)||void 0===n?void 0:n[o.name];null==a?(r=_e(o.fallback,i.controller.container).getViewFactory(),this.hasProjection=!1):(r=_e(a,i.parent.controller.container).getViewFactory(),this.hasProjection=!0),this.view=r.create().setLocation(e)}static get inject(){return[Zt,wi,Ft]}binding(e,t,i){var n;let r,o;this.parentScope=this.$controller.scope.parentScope,this.hasProjection&&(r=this.hdrContext.controller.scope.parentScope,o=this.outerScope=s.Scope.create(r.bindingContext,s.OverrideContext.create(r.bindingContext),!1),o.parentScope=r,o.overrideContext.$host=null!==(n=this.expose)&&void 0!==n?n:this.parentScope.bindingContext)}attaching(e,t,i){return this.view.activate(e,this.$controller,i,this.hasProjection?this.outerScope:this.parentScope)}detaching(e,t,i){return this.view.deactivate(e,this.$controller,i)}exposeChanged(e){this.hasProjection&&null!=this.outerScope&&(this.outerScope.overrideContext.$host=e)}dispose(){this.view.dispose(),this.view=void 0}accept(e){var t;if(!0===(null===(t=this.view)||void 0===t?void 0:t.accept(e)))return!0}}n([o],Wn.prototype,"expose",void 0),Re({name:"au-slot",template:null,containerless:!0})(Wn);const Un=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Hn=i.DI.createInterface("ISanitizer",(e=>e.singleton(class{sanitize(e){return e.replace(Un,"")}})));exports.SanitizeValueConverter=class{constructor(e){this.sanitizer=e}toView(e){return null==e?null:this.sanitizer.sanitize(e)}},exports.SanitizeValueConverter=n([r(0,Hn)],exports.SanitizeValueConverter),s.valueConverter("sanitize")(exports.SanitizeValueConverter),exports.ViewValueConverter=class{constructor(e){this.viewLocator=e}toView(e,t){return this.viewLocator.getViewComponentForObject(e,t)}},exports.ViewValueConverter=n([r(0,Ue)],exports.ViewValueConverter),s.valueConverter("view")(exports.ViewValueConverter);const Kn=Xs,Gn=Ks,Qn=Gs,_n=Qs,Xn=exports.SignalBindingBehavior,Yn=Ys,Zn=_s,Jn=As,er=wn,tr=[Jn,er],ir=M,sr=exports.AtPrefixedTriggerAttributePattern,nr=exports.ColonPrefixedBindAttributePattern,rr=exports.RefAttributePattern,or=exports.DotSeparatedAttributePattern,ar=[rr,or],lr=[sr,nr],cr=exports.CallBindingCommand,hr=exports.DefaultBindingCommand,ur=exports.ForBindingCommand,dr=exports.FromViewBindingCommand,pr=exports.OneTimeBindingCommand,gr=exports.ToViewBindingCommand,fr=exports.TwoWayBindingCommand,mr=xs,vr=exports.TriggerBindingCommand,br=exports.DelegateBindingCommand,xr=exports.CaptureBindingCommand,yr=exports.AttrBindingCommand,wr=exports.ClassBindingCommand,Cr=exports.StyleBindingCommand,kr=[hr,pr,dr,gr,fr,cr,ur,mr,vr,br,xr,wr,Cr,yr],Ar=exports.SanitizeValueConverter,Tr=exports.ViewValueConverter,Pr=exports.If,Or=exports.Else,Sr=exports.Repeat,Br=exports.With,Er=exports.Switch,Rr=exports.Case,Ir=exports.DefaultCase,$r=exports.PromiseTemplateController,Dr=exports.PendingTemplateController,Mr=exports.FulfilledTemplateController,jr=exports.RejectedTemplateController,Lr=exports.AttrBindingBehavior,Vr=exports.SelfBindingBehavior,Nr=exports.UpdateTriggerBindingBehavior,Fr=exports.AuRender,qr=[Kn,Gn,Qn,_n,Xn,Yn,Zn,Ar,Tr,Tn,Pn,Pr,Or,Sr,Br,Er,Rr,Ir,$r,Dr,Mr,jr,Lr,Vr,Nr,Fr,exports.AuCompose,exports.Portal,exports.Focus,kn,Wn],zr=Xi,Wr=Gi,Ur=Ki,Hr=Zi,Kr=es,Gr=_i,Qr=Ji,_r=Yi,Xr=Hi,Yr=Qi,Zr=rs,Jr=hs,eo=os,to=as,io=ls,so=cs,no=ns,ro=[Qr,Kr,zr,_r,Hr,Xr,Ur,Wr,Yr,Gr,Zr,Jr,eo,to,io,so,no],oo={register:e=>e.register(...tr,...qr,...ar,...kr,...ro),createContainer(){return this.register(i.DI.createContainer())}},ao=i.DI.createInterface("IAurelia");const lo=i.DI.createInterface("IDialogService"),co=i.DI.createInterface("IDialogController"),ho=i.DI.createInterface("IDialogDomRenderer"),uo=i.DI.createInterface("IDialogDom"),po=i.DI.createInterface("IDialogGlobalSettings");class go{constructor(e,t){this.wasCancelled=e,this.dialog=t}static create(e,t){return new go(e,t)}}class fo{constructor(e,t){this.status=e,this.value=t}static create(e,t){return new fo(e,t)}}var mo;exports.DialogDeactivationStatuses=void 0,(mo=exports.DialogDeactivationStatuses||(exports.DialogDeactivationStatuses={})).Ok="ok",mo.Error="error",mo.Cancel="cancel",mo.Abort="abort";class vo{constructor(e,t){this.p=e,this.ctn=t,this.closed=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}static get inject(){return[R,i.IContainer]}activate(e){var t;const s=this.ctn.createChild(),{model:n,template:r,rejectOnCancel:o}=e,a=s.get(ho),l=null!==(t=e.host)&&void 0!==t?t:this.p.document.body,c=this.dom=a.render(l,e),h=s.has(Yt,!0)?s.get(Yt):null,u=c.contentHost;return this.settings=e,null!=h&&h.contains(l)||s.register(i.Registration.instance(Yt,l)),s.register(i.Registration.instance(Xt,u),i.Registration.instance(uo,c)),new Promise((t=>{var i,r;const o=Object.assign(this.cmp=this.getOrCreateVm(s,e,u),{$dialog:this});t(null===(r=null===(i=o.canActivate)||void 0===i?void 0:i.call(o,n))||void 0===r||r)})).then((t=>{var a;if(!0!==t){if(c.dispose(),o)throw xo(null,"Dialog activation rejected");return go.create(!0,this)}const l=this.cmp;return i.onResolve(null===(a=l.activate)||void 0===a?void 0:a.call(l,n),(()=>{var t;const n=this.controller=St.forCustomElement(null,s,s,l,u,null,0,!0,$e.create(null!==(t=this.getDefinition(l))&&void 0!==t?t:{name:Me.generateName(),template:r}));return i.onResolve(n.activate(n,null,2),(()=>{var t;return c.overlay.addEventListener(null!==(t=e.mouseEvent)&&void 0!==t?t:"click",this),go.create(!1,this)}))}))}),(e=>{throw c.dispose(),e}))}deactivate(e,t){if(this.closingPromise)return this.closingPromise;let s=!0;const{controller:n,dom:r,cmp:o,settings:{mouseEvent:a,rejectOnCancel:l}}=this,c=fo.create(e,t),h=new Promise((h=>{var u,d;h(i.onResolve(null===(d=null===(u=o.canDeactivate)||void 0===u?void 0:u.call(o,c))||void 0===d||d,(h=>{var u;if(!0!==h){if(s=!1,this.closingPromise=void 0,l)throw xo(null,"Dialog cancellation rejected");return fo.create("abort")}return i.onResolve(null===(u=o.deactivate)||void 0===u?void 0:u.call(o,c),(()=>i.onResolve(n.deactivate(n,null,4),(()=>(r.dispose(),r.overlay.removeEventListener(null!=a?a:"click",this),l||"error"===e?this.reject(xo(t,"Dialog cancelled with a rejection on cancel")):this.resolve(c),c)))))})))})).catch((e=>{throw this.closingPromise=void 0,e}));return this.closingPromise=s?h:void 0,h}ok(e){return this.deactivate("ok",e)}cancel(e){return this.deactivate("cancel",e)}error(e){const t=function(e){const t=new Error;return t.wasCancelled=!1,t.value=e,t}(e);return new Promise((e=>{var s,n;return e(i.onResolve(null===(n=(s=this.cmp).deactivate)||void 0===n?void 0:n.call(s,fo.create("error",t)),(()=>i.onResolve(this.controller.deactivate(this.controller,null,4),(()=>{this.dom.dispose(),this.reject(t)})))))}))}handleEvent(e){this.settings.overlayDismiss&&!this.dom.contentHost.contains(e.target)&&this.cancel()}getOrCreateVm(e,t,s){const n=t.component;if(null==n)return new bo;if("object"==typeof n)return n;const r=this.p,o=new i.InstanceProvider("ElementResolver",s);return e.registerResolver(Xt,o),e.registerResolver(r.Node,o),e.registerResolver(r.Element,o),e.registerResolver(r.HTMLElement,o),e.invoke(n)}getDefinition(e){const t="function"==typeof e?e:null==e?void 0:e.constructor;return Me.isType(t)?Me.getDefinition(t):null}}class bo{}function xo(e,t){const i=new Error(t);return i.wasCancelled=!0,i.value=e,i}class yo{constructor(e,t,i){this.container=e,this.p=t,this.defaultSettings=i,this.dlgs=[]}get controllers(){return this.dlgs.slice(0)}get top(){const e=this.dlgs;return e.length>0?e[e.length-1]:null}static get inject(){return[i.IContainer,R,po]}static register(e){e.register(i.Registration.singleton(lo,this),ge.beforeDeactivate(lo,(e=>i.onResolve(e.closeAll(),(e=>{if(e.length>0)throw new Error(`There are still ${e.length} open dialog(s).`)})))))}open(e){return(t=new Promise((t=>{var s;const n=wo.from(this.defaultSettings,e),r=null!==(s=n.container)&&void 0!==s?s:this.container.createChild();t(i.onResolve(n.load(),(e=>{const t=r.invoke(vo);return r.register(i.Registration.instance(co,t)),r.register(i.Registration.callback(vo,(()=>{throw new Error("Invalid injection of DialogController. Use IDialogController instead.")}))),i.onResolve(t.activate(e),(e=>{if(!e.wasCancelled){1===this.dlgs.push(t)&&this.p.window.addEventListener("keydown",this);const e=()=>this.remove(t);t.closed.then(e,e)}return e}))})))}))).whenClosed=Co,t;var t}closeAll(){return Promise.all(Array.from(this.dlgs).map((e=>e.settings.rejectOnCancel?e.cancel().then((()=>null)):e.cancel().then((t=>"cancel"===t.status?null:e))))).then((e=>e.filter((e=>!!e))))}remove(e){const t=this.dlgs,i=t.indexOf(e);i>-1&&this.dlgs.splice(i,1),0===t.length&&this.p.window.removeEventListener("keydown",this)}handleEvent(e){const t=function(e){if("Escape"===(e.code||e.key)||27===e.keyCode)return"Escape";if("Enter"===(e.code||e.key)||13===e.keyCode)return"Enter";return}(e);if(null==t)return;const i=this.top;if(null===i||0===i.settings.keyboard.length)return;const s=i.settings.keyboard;"Escape"===t&&s.includes(t)?i.cancel():"Enter"===t&&s.includes(t)&&i.ok()}}class wo{static from(...e){return Object.assign(new wo,...e).validate().normalize()}load(){const e=this,t=this.component,s=this.template,n=i.resolveAll(null==t?void 0:i.onResolve(t(),(t=>{e.component=t})),"function"==typeof s?i.onResolve(s(),(t=>{e.template=t})):void 0);return n instanceof Promise?n.then((()=>e)):e}validate(){if(null==this.component&&null==this.template)throw new Error('Invalid Dialog Settings. You must provide "component", "template" or both.');return this}normalize(){return null==this.keyboard&&(this.keyboard=this.lock?[]:["Enter","Escape"]),"boolean"!=typeof this.overlayDismiss&&(this.overlayDismiss=!this.lock),this}}function Co(e,t){return this.then((i=>i.dialog.closed.then(e,t)),t)}class ko{constructor(){this.lock=!0,this.startingZIndex=1e3,this.rejectOnCancel=!1}static register(e){i.Registration.singleton(po,this).register(e)}}const Ao="position:absolute;width:100%;height:100%;top:0;left:0;";class To{constructor(e){this.p=e,this.wrapperCss=`${Ao} display:flex;`,this.overlayCss=Ao,this.hostCss="position:relative;margin:auto;"}static register(e){i.Registration.singleton(ho,this).register(e)}render(e){const t=this.p.document,i=(e,i)=>{const s=t.createElement(e);return s.style.cssText=i,s},s=e.appendChild(i("au-dialog-container",this.wrapperCss)),n=s.appendChild(i("au-dialog-overlay",this.overlayCss)),r=s.appendChild(i("div",this.hostCss));return new Po(s,n,r)}}To.inject=[R];class Po{constructor(e,t,i){this.wrapper=e,this.overlay=t,this.contentHost=i}dispose(){this.wrapper.remove()}}function Oo(e,t){return{settingsProvider:e,register:i=>i.register(...t,ge.beforeCreate((()=>e(i.get(po))))),customize:(e,i)=>Oo(e,null!=i?i:t)}}const So=Oo((()=>{throw new Error("Invalid dialog configuration. Specify the implementations for <IDialogService>, <IDialogGlobalSettings> and <IDialogDomRenderer>, or use the DialogDefaultConfiguration export.")}),[class{static register(e){e.register(i.Registration.singleton(po,this))}}]),Bo=Oo(i.noop,[yo,ko,To]);Object.defineProperty(exports,"Platform",{enumerable:!0,get:function(){return e.Platform}}),Object.defineProperty(exports,"Task",{enumerable:!0,get:function(){return e.Task}}),Object.defineProperty(exports,"TaskAbortError",{enumerable:!0,get:function(){return e.TaskAbortError}}),Object.defineProperty(exports,"TaskQueue",{enumerable:!0,get:function(){return e.TaskQueue}}),Object.defineProperty(exports,"TaskQueuePriority",{enumerable:!0,get:function(){return e.TaskQueuePriority}}),Object.defineProperty(exports,"TaskStatus",{enumerable:!0,get:function(){return e.TaskStatus}}),Object.defineProperty(exports,"BrowserPlatform",{enumerable:!0,get:function(){return t.BrowserPlatform}}),Object.defineProperty(exports,"Access",{enumerable:!0,get:function(){return s.Access}}),Object.defineProperty(exports,"AccessKeyedExpression",{enumerable:!0,get:function(){return s.AccessKeyedExpression}}),Object.defineProperty(exports,"AccessMemberExpression",{enumerable:!0,get:function(){return s.AccessMemberExpression}}),Object.defineProperty(exports,"AccessScopeExpression",{enumerable:!0,get:function(){return s.AccessScopeExpression}}),Object.defineProperty(exports,"AccessThisExpression",{enumerable:!0,get:function(){return s.AccessThisExpression}}),Object.defineProperty(exports,"AccessorType",{enumerable:!0,get:function(){return s.AccessorType}}),Object.defineProperty(exports,"ArrayBindingPattern",{enumerable:!0,get:function(){return s.ArrayBindingPattern}}),Object.defineProperty(exports,"ArrayIndexObserver",{enumerable:!0,get:function(){return s.ArrayIndexObserver}}),Object.defineProperty(exports,"ArrayLiteralExpression",{enumerable:!0,get:function(){return s.ArrayLiteralExpression}}),Object.defineProperty(exports,"ArrayObserver",{enumerable:!0,get:function(){return s.ArrayObserver}}),Object.defineProperty(exports,"AssignExpression",{enumerable:!0,get:function(){return s.AssignExpression}}),Object.defineProperty(exports,"BinaryExpression",{enumerable:!0,get:function(){return s.BinaryExpression}}),Object.defineProperty(exports,"BindingBehavior",{enumerable:!0,get:function(){return s.BindingBehavior}}),Object.defineProperty(exports,"BindingBehaviorDefinition",{enumerable:!0,get:function(){return s.BindingBehaviorDefinition}}),Object.defineProperty(exports,"BindingBehaviorExpression",{enumerable:!0,get:function(){return s.BindingBehaviorExpression}}),Object.defineProperty(exports,"BindingBehaviorFactory",{enumerable:!0,get:function(){return s.BindingBehaviorFactory}}),Object.defineProperty(exports,"BindingBehaviorStrategy",{enumerable:!0,get:function(){return s.BindingBehaviorStrategy}}),Object.defineProperty(exports,"BindingContext",{enumerable:!0,get:function(){return s.BindingContext}}),Object.defineProperty(exports,"BindingIdentifier",{enumerable:!0,get:function(){return s.BindingIdentifier}}),Object.defineProperty(exports,"BindingInterceptor",{enumerable:!0,get:function(){return s.BindingInterceptor}}),Object.defineProperty(exports,"BindingMediator",{enumerable:!0,get:function(){return s.BindingMediator}}),Object.defineProperty(exports,"BindingMode",{enumerable:!0,get:function(){return s.BindingMode}}),Object.defineProperty(exports,"BindingType",{enumerable:!0,get:function(){return s.BindingType}}),Object.defineProperty(exports,"CallFunctionExpression",{enumerable:!0,get:function(){return s.CallFunctionExpression}}),Object.defineProperty(exports,"CallMemberExpression",{enumerable:!0,get:function(){return s.CallMemberExpression}}),Object.defineProperty(exports,"CallScopeExpression",{enumerable:!0,get:function(){return s.CallScopeExpression}}),Object.defineProperty(exports,"Char",{enumerable:!0,get:function(){return s.Char}}),Object.defineProperty(exports,"CollectionKind",{enumerable:!0,get:function(){return s.CollectionKind}}),Object.defineProperty(exports,"CollectionLengthObserver",{enumerable:!0,get:function(){return s.CollectionLengthObserver}}),Object.defineProperty(exports,"CollectionSizeObserver",{enumerable:!0,get:function(){return s.CollectionSizeObserver}}),Object.defineProperty(exports,"ComputedObserver",{enumerable:!0,get:function(){return s.ComputedObserver}}),Object.defineProperty(exports,"ConditionalExpression",{enumerable:!0,get:function(){return s.ConditionalExpression}}),Object.defineProperty(exports,"CustomExpression",{enumerable:!0,get:function(){return s.CustomExpression}}),Object.defineProperty(exports,"DelegationStrategy",{enumerable:!0,get:function(){return s.DelegationStrategy}}),Object.defineProperty(exports,"DirtyCheckProperty",{enumerable:!0,get:function(){return s.DirtyCheckProperty}}),Object.defineProperty(exports,"DirtyCheckSettings",{enumerable:!0,get:function(){return s.DirtyCheckSettings}}),Object.defineProperty(exports,"ExpressionKind",{enumerable:!0,get:function(){return s.ExpressionKind}}),Object.defineProperty(exports,"ForOfStatement",{enumerable:!0,get:function(){return s.ForOfStatement}}),Object.defineProperty(exports,"HtmlLiteralExpression",{enumerable:!0,get:function(){return s.HtmlLiteralExpression}}),Object.defineProperty(exports,"IDirtyChecker",{enumerable:!0,get:function(){return s.IDirtyChecker}}),Object.defineProperty(exports,"IExpressionParser",{enumerable:!0,get:function(){return s.IExpressionParser}}),Object.defineProperty(exports,"INodeObserverLocator",{enumerable:!0,get:function(){return s.INodeObserverLocator}}),Object.defineProperty(exports,"IObserverLocator",{enumerable:!0,get:function(){return s.IObserverLocator}}),Object.defineProperty(exports,"ISignaler",{enumerable:!0,get:function(){return s.ISignaler}}),Object.defineProperty(exports,"Interpolation",{enumerable:!0,get:function(){return s.Interpolation}}),Object.defineProperty(exports,"LifecycleFlags",{enumerable:!0,get:function(){return s.LifecycleFlags}}),Object.defineProperty(exports,"MapObserver",{enumerable:!0,get:function(){return s.MapObserver}}),Object.defineProperty(exports,"ObjectBindingPattern",{enumerable:!0,get:function(){return s.ObjectBindingPattern}}),Object.defineProperty(exports,"ObjectLiteralExpression",{enumerable:!0,get:function(){return s.ObjectLiteralExpression}}),Object.defineProperty(exports,"ObserverLocator",{enumerable:!0,get:function(){return s.ObserverLocator}}),Object.defineProperty(exports,"OverrideContext",{enumerable:!0,get:function(){return s.OverrideContext}}),Object.defineProperty(exports,"ParserState",{enumerable:!0,get:function(){return s.ParserState}}),Object.defineProperty(exports,"Precedence",{enumerable:!0,get:function(){return s.Precedence}}),Object.defineProperty(exports,"PrimitiveLiteralExpression",{enumerable:!0,get:function(){return s.PrimitiveLiteralExpression}}),Object.defineProperty(exports,"PrimitiveObserver",{enumerable:!0,get:function(){return s.PrimitiveObserver}}),Object.defineProperty(exports,"PropertyAccessor",{enumerable:!0,get:function(){return s.PropertyAccessor}}),Object.defineProperty(exports,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(exports,"SetObserver",{enumerable:!0,get:function(){return s.SetObserver}}),Object.defineProperty(exports,"SetterObserver",{enumerable:!0,get:function(){return s.SetterObserver}}),Object.defineProperty(exports,"TaggedTemplateExpression",{enumerable:!0,get:function(){return s.TaggedTemplateExpression}}),Object.defineProperty(exports,"TemplateExpression",{enumerable:!0,get:function(){return s.TemplateExpression}}),Object.defineProperty(exports,"UnaryExpression",{enumerable:!0,get:function(){return s.UnaryExpression}}),Object.defineProperty(exports,"ValueConverter",{enumerable:!0,get:function(){return s.ValueConverter}}),Object.defineProperty(exports,"ValueConverterDefinition",{enumerable:!0,get:function(){return s.ValueConverterDefinition}}),Object.defineProperty(exports,"ValueConverterExpression",{enumerable:!0,get:function(){return s.ValueConverterExpression}}),Object.defineProperty(exports,"alias",{enumerable:!0,get:function(){return s.alias}}),Object.defineProperty(exports,"applyMutationsToIndices",{enumerable:!0,get:function(){return s.applyMutationsToIndices}}),Object.defineProperty(exports,"bindingBehavior",{enumerable:!0,get:function(){return s.bindingBehavior}}),Object.defineProperty(exports,"cloneIndexMap",{enumerable:!0,get:function(){return s.cloneIndexMap}}),Object.defineProperty(exports,"connectable",{enumerable:!0,get:function(){return s.connectable}}),Object.defineProperty(exports,"copyIndexMap",{enumerable:!0,get:function(){return s.copyIndexMap}}),Object.defineProperty(exports,"createIndexMap",{enumerable:!0,get:function(){return s.createIndexMap}}),Object.defineProperty(exports,"disableArrayObservation",{enumerable:!0,get:function(){return s.disableArrayObservation}}),Object.defineProperty(exports,"disableMapObservation",{enumerable:!0,get:function(){return s.disableMapObservation}}),Object.defineProperty(exports,"disableSetObservation",{enumerable:!0,get:function(){return s.disableSetObservation}}),Object.defineProperty(exports,"enableArrayObservation",{enumerable:!0,get:function(){return s.enableArrayObservation}}),Object.defineProperty(exports,"enableMapObservation",{enumerable:!0,get:function(){return s.enableMapObservation}}),Object.defineProperty(exports,"enableSetObservation",{enumerable:!0,get:function(){return s.enableSetObservation}}),Object.defineProperty(exports,"getCollectionObserver",{enumerable:!0,get:function(){return s.getCollectionObserver}}),Object.defineProperty(exports,"isIndexMap",{enumerable:!0,get:function(){return s.isIndexMap}}),Object.defineProperty(exports,"observable",{enumerable:!0,get:function(){return s.observable}}),Object.defineProperty(exports,"parse",{enumerable:!0,get:function(){return s.parse}}),Object.defineProperty(exports,"parseExpression",{enumerable:!0,get:function(){return s.parseExpression}}),Object.defineProperty(exports,"registerAliases",{enumerable:!0,get:function(){return s.registerAliases}}),Object.defineProperty(exports,"subscriberCollection",{enumerable:!0,get:function(){return s.subscriberCollection}}),Object.defineProperty(exports,"synchronizeIndices",{enumerable:!0,get:function(){return s.synchronizeIndices}}),Object.defineProperty(exports,"valueConverter",{enumerable:!0,get:function(){return s.valueConverter}}),exports.AdoptedStyleSheetsStyles=ht,exports.AppRoot=Kt,exports.AppTask=ge,exports.AtPrefixedTriggerAttributePatternRegistration=sr,exports.AttrBindingBehaviorRegistration=Lr,exports.AttrBindingCommandRegistration=yr,exports.AttrSyntax=w,exports.AttributeBinding=Z,exports.AttributeBindingInstruction=Ni,exports.AttributeBindingRendererRegistration=Jr,exports.AttributeNSAccessor=sn,exports.AttributePattern=O,exports.AuRenderRegistration=Fr,exports.AuSlot=Wn,exports.AuSlotsInfo=xi,exports.Aurelia=class{constructor(e=i.DI.createContainer()){if(this.container=e,this._isRunning=!1,this._isStarting=!1,this._isStopping=!1,this._root=void 0,this.next=void 0,this.startPromise=void 0,this.stopPromise=void 0,e.has(ao,!0))throw new Error("An instance of Aurelia is already registered with the container or an ancestor of it.");e.register(i.Registration.instance(ao,this)),e.registerResolver(Wt,this.rootProvider=new i.InstanceProvider("IAppRoot"))}get isRunning(){return this._isRunning}get isStarting(){return this._isStarting}get isStopping(){return this._isStopping}get root(){if(null==this._root){if(null==this.next)throw new Error("root is not defined");return this.next}return this._root}register(...e){return this.container.register(...e),this}app(e){return this.next=new Kt(e,this.initPlatform(e.host),this.container,this.rootProvider,!1),this}enhance(e){return this.next=new Kt(e,this.initPlatform(e.host),this.container,this.rootProvider,!0),this}async waitForIdle(){const e=this.root.platform;await e.domWriteQueue.yield(),await e.domReadQueue.yield(),await e.taskQueue.yield()}initPlatform(e){let s;if(this.container.has(R,!1))s=this.container.get(R);else{if(null===e.ownerDocument.defaultView)throw new Error("Failed to initialize the platform object. The host element's ownerDocument does not have a defaultView");s=new t.BrowserPlatform(e.ownerDocument.defaultView),this.container.register(i.Registration.instance(R,s))}return s}start(e=this.next){if(null==e)throw new Error("There is no composition root");return this.startPromise instanceof Promise?this.startPromise:this.startPromise=i.onResolve(this.stop(),(()=>(Reflect.set(e.host,"$aurelia",this),this.rootProvider.prepare(this._root=e),this._isStarting=!0,i.onResolve(e.activate(),(()=>{this._isRunning=!0,this._isStarting=!1,this.startPromise=void 0,this.dispatchEvent(e,"au-started",e.host)})))))}stop(e=!1){if(this.stopPromise instanceof Promise)return this.stopPromise;if(!0===this._isRunning){const t=this._root;return this._isRunning=!1,this._isStopping=!0,this.stopPromise=i.onResolve(t.deactivate(),(()=>{Reflect.deleteProperty(t.host,"$aurelia"),e&&t.dispose(),this._root=void 0,this.rootProvider.dispose(),this._isStopping=!1,this.dispatchEvent(t,"au-stopped",t.host)}))}}dispose(){if(this._isRunning||this._isStopping)throw new Error("The aurelia instance must be fully stopped before it can be disposed");this.container.dispose()}dispatchEvent(e,t,i){const s=new e.platform.window.CustomEvent(t,{detail:this,bubbles:!0,cancelable:!0});i.dispatchEvent(s)}},exports.Bindable=l,exports.BindableDefinition=c,exports.BindableObserver=h,exports.BindablesInfo=Ds,exports.BindingCommand=bs,exports.BindingCommandDefinition=vs,exports.BindingModeBehavior=Hs,exports.CSSModulesProcessorRegistry=st,exports.CallBinding=N,exports.CallBindingCommandRegistration=cr,exports.CallBindingInstruction=Pi,exports.CallBindingRendererRegistration=zr,exports.CaptureBindingCommandRegistration=xr,exports.CheckedObserver=rn,exports.Children=ve,exports.ChildrenDefinition=xe,exports.ClassAttributeAccessor=et,exports.ClassBindingCommandRegistration=wr,exports.ColonPrefixedBindAttributePatternRegistration=nr,exports.ComputedWatcher=vt,exports.Controller=St,exports.CustomAttribute=Oe,exports.CustomAttributeDefinition=Pe,exports.CustomAttributeRendererRegistration=Wr,exports.CustomElement=Me,exports.CustomElementDefinition=$e,exports.CustomElementRendererRegistration=Ur,exports.DataAttributeAccessor=Zs,exports.DebounceBindingBehavior=Xs,exports.DebounceBindingBehaviorRegistration=Kn,exports.DefaultBindingCommandRegistration=hr,exports.DefaultBindingLanguage=kr,exports.DefaultBindingSyntax=ar,exports.DefaultComponents=tr,exports.DefaultDialogDom=Po,exports.DefaultDialogDomRenderer=To,exports.DefaultDialogGlobalSettings=ko,exports.DefaultRenderers=ro,exports.DefaultResources=qr,exports.DelegateBindingCommandRegistration=br,exports.DialogCloseResult=fo,exports.DialogConfiguration=So,exports.DialogController=vo,exports.DialogDefaultConfiguration=Bo,exports.DialogOpenResult=go,exports.DialogService=yo,exports.DotSeparatedAttributePatternRegistration=or,exports.ElseRegistration=Or,exports.EventDelegator=mi,exports.EventSubscriber=gi,exports.ExpressionWatcher=bt,exports.ForBindingCommandRegistration=ur,exports.FragmentNodeSequence=ri,exports.FrequentMutations=Tn,exports.FromViewBindingBehavior=Qs,exports.FromViewBindingBehaviorRegistration=_n,exports.FromViewBindingCommandRegistration=dr,exports.HydrateAttributeInstruction=Ei,exports.HydrateElementInstruction=Bi,exports.HydrateLetElementInstruction=Ii,exports.HydrateTemplateController=Ri,exports.IAppRoot=Wt,exports.IAppTask=de,exports.IAttrMapper=j,exports.IAttributeParser=k,exports.IAttributePattern=C,exports.IAuSlotsInfo=bi,exports.IAurelia=ao,exports.IController=Nt,exports.IDialogController=co,exports.IDialogDom=uo,exports.IDialogDomRenderer=ho,exports.IDialogGlobalSettings=po,exports.IDialogService=lo,exports.IEventDelegator=fi,exports.IEventTarget=Yt,exports.IHistory=li,exports.IHydrationContext=Ft,exports.IInstruction=wi,exports.ILifecycleHooks=xt,exports.ILocation=ai,exports.INode=Xt,exports.INodeObserverLocatorRegistration=er,exports.IPlatform=R,exports.IProjections=vi,exports.IRenderLocation=Zt,exports.IRenderer=qi,exports.ISVGAnalyzer=I,exports.ISanitizer=Hn,exports.IShadowDOMGlobalStyles=ct,exports.IShadowDOMStyleFactory=nt,exports.IShadowDOMStyles=lt,exports.ISyntaxInterpreter=x,exports.ITemplateCompiler=Fi,exports.ITemplateCompilerHooks=Fs,exports.ITemplateCompilerRegistration=Jn,exports.ITemplateElementFactory=ys,exports.IViewFactory=Ve,exports.IViewLocator=Ue,exports.IWindow=oi,exports.IWorkTracker=Ut,exports.IfRegistration=Pr,exports.InterpolationBinding=te,exports.InterpolationBindingRendererRegistration=Hr,exports.InterpolationInstruction=ki,exports.Interpretation=p,exports.IteratorBindingInstruction=Ti,exports.IteratorBindingRendererRegistration=Kr,exports.LetBinding=ne,exports.LetBindingInstruction=$i,exports.LetElementRendererRegistration=Gr,exports.LifecycleHooks=kt,exports.LifecycleHooksDefinition=wt,exports.LifecycleHooksEntry=yt,exports.Listener=hi,exports.ListenerBindingInstruction=Mi,exports.ListenerBindingRendererRegistration=Zr,exports.NodeObserverConfig=yn,exports.NodeObserverLocator=wn,exports.NoopSVGAnalyzer=$,exports.ObserveShallow=Pn,exports.OneTimeBindingBehavior=Ks,exports.OneTimeBindingBehaviorRegistration=Gn,exports.OneTimeBindingCommandRegistration=pr,exports.PropertyBinding=he,exports.PropertyBindingInstruction=Ai,exports.PropertyBindingRendererRegistration=Qr,exports.RefAttributePatternRegistration=rr,exports.RefBinding=ue,exports.RefBindingCommandRegistration=mr,exports.RefBindingInstruction=Oi,exports.RefBindingRendererRegistration=_r,exports.RenderPlan=Dn,exports.RepeatRegistration=Sr,exports.SVGAnalyzer=M,exports.SVGAnalyzerRegistration=ir,exports.SanitizeValueConverterRegistration=Ar,exports.SelectValueObserver=hn,exports.SelfBindingBehaviorRegistration=Vr,exports.SetAttributeInstruction=ji,exports.SetAttributeRendererRegistration=eo,exports.SetClassAttributeInstruction=Li,exports.SetClassAttributeRendererRegistration=to,exports.SetPropertyInstruction=Si,exports.SetPropertyRendererRegistration=Xr,exports.SetStyleAttributeInstruction=Vi,exports.SetStyleAttributeRendererRegistration=io,exports.ShadowDOMRegistry=rt,exports.ShortHandBindingSyntax=lr,exports.SignalBindingBehaviorRegistration=Xn,exports.StandardConfiguration=oo,exports.StyleAttributeAccessor=dn,exports.StyleBindingCommandRegistration=Cr,exports.StyleConfiguration=dt,exports.StyleElementStyles=ut,exports.StylePropertyBindingInstruction=class{constructor(e,t){this.from=e,this.to=t}get type(){return"hd"}},exports.StylePropertyBindingRendererRegistration=so,exports.TemplateCompiler=As,exports.TemplateCompilerHooks=Ws,exports.TemplateControllerRendererRegistration=Yr,exports.TextBindingInstruction=Di,exports.TextBindingRendererRegistration=no,exports.ThrottleBindingBehavior=Ys,exports.ThrottleBindingBehaviorRegistration=Yn,exports.ToViewBindingBehavior=Gs,exports.ToViewBindingBehaviorRegistration=Qn,exports.ToViewBindingCommandRegistration=gr,exports.TriggerBindingCommandRegistration=vr,exports.TwoWayBindingBehavior=_s,exports.TwoWayBindingBehaviorRegistration=Zn,exports.TwoWayBindingCommandRegistration=fr,exports.UpdateTriggerBindingBehaviorRegistration=Nr,exports.ValueAttributeObserver=pn,exports.ViewFactory=Ne,exports.ViewLocator=He,exports.ViewValueConverterRegistration=Tr,exports.Views=We,exports.Watch=Ee,exports.WithRegistration=Br,exports.allResources=ks,exports.attributePattern=T,exports.bindable=o,exports.bindingCommand=ms,exports.children=function(e,t){let s;function n(e,t){arguments.length>1&&(s.property=t),i.Metadata.define(ve.name,xe.create(t,s),e.constructor,t),i.Protocol.annotation.appendTo(e.constructor,ve.keyFrom(t))}return arguments.length>1?(s={},void n(e,t)):"string"==typeof e?(s={},n):(s=void 0===e?{}:e,n)},exports.containerless=function(e){if(void 0===e)return function(e){Me.annotate(e,"containerless",!0)};Me.annotate(e,"containerless",!0)},exports.convertToRenderLocation=si,exports.createElement=$n,exports.cssModules=function(...e){return new st(e)},exports.customAttribute=Ae,exports.customElement=Re,exports.getEffectiveParentNode=ti,exports.getRef=Qt,exports.getRenderContext=_e,exports.isCustomElementController=function(e){return e instanceof St&&0===e.vmKind},exports.isCustomElementViewModel=function(e){return i.isObject(e)&&Me.isType(e.constructor)},exports.isInstruction=Ci,exports.isRenderContext=function(e){return e instanceof Je},exports.isRenderLocation=ni,exports.lifecycleHooks=function(){return function(e){return kt.define({},e)}},exports.processContent=function(e){return void 0===e?function(e,t,s){i.Metadata.define(je,Le(e,t),e)}:function(t){e=Le(t,e);const s=i.Metadata.getOwn(Me.name,t);return void 0!==s?s.processContent=e:i.Metadata.define(je,e,t),t}},exports.renderer=zi,exports.setEffectiveParentNode=ii,exports.setRef=_t,exports.shadowCSS=function(...e){return new rt(e)},exports.templateCompilerHooks=e=>{return void 0===e?t:t(e);function t(e){return Ws.define(e)}},exports.templateController=Te,exports.useShadowDOM=function(e){return void 0===e?function(e){Me.annotate(e,"shadowOptions",{mode:"open"})}:"function"!=typeof e?function(t){Me.annotate(t,"shadowOptions",e)}:void Me.annotate(e,"shadowOptions",{mode:"open"})},exports.view=function(e){return function(t){We.add(t,e)}},exports.watch=function(e,t){if(!e)throw new Error("Invalid watch config. Expected an expression or a fn");return function(i,s,n){const r=null==s,o=r?i:i.constructor,a=new Se(e,r?t:n.value);if(r){if("function"!=typeof t&&(null==t||!(t in o.prototype)))throw new Error(`Invalid change handler config. Method "${String(t)}" not found in class ${o.name}`)}else if("function"!=typeof(null==n?void 0:n.value))throw new Error(`decorated target ${String(s)} is not a class method.`);Ee.add(o,a),Oe.isType(o)&&Oe.getDefinition(o).watches.push(a),Me.isType(o)&&Me.getDefinition(o).watches.push(a)}};
