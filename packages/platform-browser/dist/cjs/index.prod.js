Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@aurelia/platform");const t=new Map;function i(e){return function(){throw new Error(`The PLATFORM did not receive a valid reference to the global function '${e}'.`)}}class o extends e.Platform{constructor(t,o={}){var s,n,d,a,m,h;super(t,o),this.domReadRequested=!1,this.domReadHandle=-1,this.domWriteRequested=!1,this.domWriteHandle=-1,this.Node="Node"in o?o.Node:t.Node,this.Element="Element"in o?o.Element:t.Element,this.HTMLElement="HTMLElement"in o?o.HTMLElement:t.HTMLElement,this.CustomEvent="CustomEvent"in o?o.CustomEvent:t.CustomEvent,this.CSSStyleSheet="CSSStyleSheet"in o?o.CSSStyleSheet:t.CSSStyleSheet,this.ShadowRoot="ShadowRoot"in o?o.ShadowRoot:t.ShadowRoot,this.MutationObserver="MutationObserver"in o?o.MutationObserver:t.MutationObserver,this.window="window"in o?o.window:t.window,this.document="document"in o?o.document:t.document,this.location="location"in o?o.location:t.location,this.history="history"in o?o.history:t.history,this.navigator="navigator"in o?o.navigator:t.navigator,this.fetch="fetch"in o?o.fetch:null!==(n=null===(s=t.fetch)||void 0===s?void 0:s.bind(t))&&void 0!==n?n:i("fetch"),this.requestAnimationFrame="requestAnimationFrame"in o?o.requestAnimationFrame:null!==(a=null===(d=t.requestAnimationFrame)||void 0===d?void 0:d.bind(t))&&void 0!==a?a:i("requestAnimationFrame"),this.cancelAnimationFrame="cancelAnimationFrame"in o?o.cancelAnimationFrame:null!==(h=null===(m=t.cancelAnimationFrame)||void 0===m?void 0:m.bind(t))&&void 0!==h?h:i("cancelAnimationFrame"),this.customElements="customElements"in o?o.customElements:t.customElements,this.flushDomRead=this.flushDomRead.bind(this),this.flushDomWrite=this.flushDomWrite.bind(this),this.domReadQueue=new e.TaskQueue(this,this.requestDomRead.bind(this),this.cancelDomRead.bind(this)),this.domWriteQueue=new e.TaskQueue(this,this.requestDomWrite.bind(this),this.cancelDomWrite.bind(this))}static getOrCreate(e,i={}){let s=t.get(e);return void 0===s&&t.set(e,s=new o(e,i)),s}static set(e,i){t.set(e,i)}requestDomRead(){this.domReadRequested=!0,-1===this.domWriteHandle&&(this.domWriteHandle=this.requestAnimationFrame(this.flushDomWrite))}cancelDomRead(){this.domReadRequested=!1,this.domReadHandle>-1&&(this.clearTimeout(this.domReadHandle),this.domReadHandle=-1),!1===this.domWriteRequested&&this.domWriteHandle>-1&&(this.cancelAnimationFrame(this.domWriteHandle),this.domWriteHandle=-1)}flushDomRead(){this.domReadHandle=-1,!0===this.domReadRequested&&(this.domReadRequested=!1,this.domReadQueue.flush())}requestDomWrite(){this.domWriteRequested=!0,-1===this.domWriteHandle&&(this.domWriteHandle=this.requestAnimationFrame(this.flushDomWrite))}cancelDomWrite(){this.domWriteRequested=!1,this.domWriteHandle>-1&&(!1===this.domReadRequested||this.domReadHandle>-1)&&(this.cancelAnimationFrame(this.domWriteHandle),this.domWriteHandle=-1)}flushDomWrite(){this.domWriteHandle=-1,!0===this.domWriteRequested&&(this.domWriteRequested=!1,this.domWriteQueue.flush()),!0===this.domReadRequested&&-1===this.domReadHandle&&(this.domReadHandle=this.setTimeout(this.flushDomRead,0))}}exports.BrowserPlatform=o;
