import{Protocol as e,Metadata as t,Registration as n,DI as r,firstDefined as s,mergeArrays as i,fromAnnotationOrDefinitionOrTypeOrDefault as o,isNumberOrBigInt as a,isStringOrDate as u,emptyArray as l,isArrayIndex as c,IPlatform as h,ILogger as d}from"@aurelia/kernel";export{IPlatform}from"@aurelia/kernel";export{Platform,Task,TaskAbortError,TaskQueue,TaskQueuePriority,TaskStatus}from"@aurelia/platform";function p(...n){return function(r){const s=e.annotation.keyFor("aliases"),i=t.getOwn(s,r);void 0===i?t.define(s,n,r):i.push(...n)}}function f(e,t,r,s){for(let i=0,o=e.length;i<o;++i)n.aliasTo(r,t.keyFrom(e[i])).register(s)}const g=Object.freeze({});class v{constructor(e,t){if(void 0!==e)if(void 0!==t)this[e]=t;else for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this[t]=e[t])}static create(e,t){return new v(e,t)}static get(e,t,n,r,s){if(null==e&&null==s)throw new Error(`Scope is ${e} and HostScope is ${s}.`);const i=s!==e&&null!=s;let o=b(e,t,n,null);return null!==o&&(null!=o&&t in o||!i)||i&&(o=b(s,t,n,e),null!=o&&t in o)?o:16&r?g:e.bindingContext||e.overrideContext}}function b(e,t,n,r){var s,i;let o=e.overrideContext,a=e;if(n>0){for(;n>0;)if(n--,a=a.parentScope,null==(null==a?void 0:a.overrideContext))return;return o=a.overrideContext,t in o?o:o.bindingContext}for(;(!(null==a?void 0:a.isBoundary)||null!==r&&r!==a)&&o&&!(t in o)&&(!o.bindingContext||!(t in o.bindingContext));)a=null!==(s=a.parentScope)&&void 0!==s?s:null,o=null!==(i=null==a?void 0:a.overrideContext)&&void 0!==i?i:null;return o?t in o?o:o.bindingContext:null}class y{constructor(e,t,n,r){this.parentScope=e,this.bindingContext=t,this.overrideContext=n,this.isBoundary=r}static create(e,t,n){return new y(null,e,null==t?m.create(e):t,null!=n&&n)}static fromOverride(e){if(null==e)throw new Error(`OverrideContext is ${e}`);return new y(null,e.bindingContext,e,!1)}static fromParent(e,t){if(null==e)throw new Error(`ParentScope is ${e}`);return new y(e,t,m.create(t),!1)}}class m{constructor(e){this.bindingContext=e}static create(e){return new m(e)}}const w=r.createInterface("ISignaler",(e=>e.singleton(x)));class x{constructor(){this.signals=Object.create(null)}dispatchSignal(e,t){const n=this.signals[e];if(void 0!==n)for(const e of n.keys())e.handleChange(void 0,void 0,t)}addSignalListener(e,t){const n=this.signals,r=n[e];void 0===r?n[e]=new Set([t]):r.add(t)}removeSignalListener(e,t){const n=this.signals[e];n&&n.delete(t)}}var C;function k(e){return function(t){return $.define(e,t)}}!function(e){e[e.singleton=1]="singleton",e[e.interceptor=2]="interceptor"}(C||(C={}));class O{constructor(e,t,n,r,s){this.Type=e,this.name=t,this.aliases=n,this.key=r,this.strategy=s}static create(e,t){let n,r;"string"==typeof e?(n=e,r={name:n}):(n=e.name,r=e);const a=Object.getPrototypeOf(t)===T;return new O(t,s($.getAnnotation(t,"name"),n),i($.getAnnotation(t,"aliases"),r.aliases,t.aliases),$.keyFrom(n),o("strategy",r,t,(()=>a?2:1)))}register(e){const{Type:t,key:r,aliases:s,strategy:i}=this;switch(i){case 1:n.singleton(r,t).register(e);break;case 2:n.instance(r,new S(e,t)).register(e)}n.aliasTo(r,t).register(e),f(s,$,r,e)}}class S{constructor(e,t){this.container=e,this.Type=t,this.deps=r.getDependencies(t)}construct(e,t){const n=this.container,r=this.deps;switch(r.length){case 0:case 1:case 2:return new this.Type(e,t);case 3:return new this.Type(n.get(r[0]),e,t);case 4:return new this.Type(n.get(r[0]),n.get(r[1]),e,t);default:return new this.Type(...r.map((e=>n.get(e))),e,t)}}}class T{constructor(e,t){let n;for(this.binding=e,this.expr=t,this.interceptor=this;e.interceptor!==this;)n=e.interceptor,e.interceptor=this,e=n}get observerLocator(){return this.binding.observerLocator}get locator(){return this.binding.locator}get $scope(){return this.binding.$scope}get $hostScope(){return this.binding.$hostScope}get isBound(){return this.binding.isBound}get obs(){return this.binding.obs}get sourceExpression(){return this.binding.sourceExpression}updateTarget(e,t){this.binding.updateTarget(e,t)}updateSource(e,t){this.binding.updateSource(e,t)}callSource(e){return this.binding.callSource(e)}handleChange(e,t,n){this.binding.handleChange(e,t,n)}handleCollectionChange(e,t){this.binding.handleCollectionChange(e,t)}observeProperty(e,t){this.binding.observeProperty(e,t)}observeCollection(e){this.binding.observeCollection(e)}$bind(e,t,n){this.binding.$bind(e,t,n)}$unbind(e){this.binding.$unbind(e)}}const $={name:e.resource.keyFor("binding-behavior"),keyFrom:e=>`${$.name}:${e}`,isType:e=>"function"==typeof e&&t.hasOwn($.name,e),define(n,r){const s=O.create(n,r);return t.define($.name,s,s.Type),t.define($.name,s,s),e.resource.appendTo(r,$.name),s.Type},getDefinition(e){const n=t.getOwn($.name,e);if(void 0===n)throw new Error(`No definition found for type ${e.name}`);return n},annotate(n,r,s){t.define(e.annotation.keyFor(r),s,n)},getAnnotation:(n,r)=>t.getOwn(e.annotation.keyFor(r),n)};function L(e){return function(t){return A.define(e,t)}}class E{constructor(e,t,n,r){this.Type=e,this.name=t,this.aliases=n,this.key=r}static create(e,t){let n,r;return"string"==typeof e?(n=e,r={name:n}):(n=e.name,r=e),new E(t,s(A.getAnnotation(t,"name"),n),i(A.getAnnotation(t,"aliases"),r.aliases,t.aliases),A.keyFrom(n))}register(e){const{Type:t,key:r,aliases:s}=this;n.singleton(r,t).register(e),n.aliasTo(r,t).register(e),f(s,A,r,e)}}const A={name:e.resource.keyFor("value-converter"),keyFrom:e=>`${A.name}:${e}`,isType:e=>"function"==typeof e&&t.hasOwn(A.name,e),define(n,r){const s=E.create(n,r);return t.define(A.name,s,s.Type),t.define(A.name,s,s),e.resource.appendTo(r,A.name),s.Type},getDefinition(e){const n=t.getOwn(A.name,e);if(void 0===n)throw new Error(`No definition found for type ${e.name}`);return n},annotate(n,r,s){t.define(e.annotation.keyFor(r),s,n)},getAnnotation:(n,r)=>t.getOwn(e.annotation.keyFor(r),n)};var U;!function(e){e[e.Connects=32]="Connects",e[e.Observes=64]="Observes",e[e.CallsFunction=128]="CallsFunction",e[e.HasAncestor=256]="HasAncestor",e[e.IsPrimary=512]="IsPrimary",e[e.IsLeftHandSide=1024]="IsLeftHandSide",e[e.HasBind=2048]="HasBind",e[e.HasUnbind=4096]="HasUnbind",e[e.IsAssignable=8192]="IsAssignable",e[e.IsLiteral=16384]="IsLiteral",e[e.IsResource=32768]="IsResource",e[e.IsForDeclaration=65536]="IsForDeclaration",e[e.Type=31]="Type",e[e.AccessThis=1793]="AccessThis",e[e.AccessScope=10082]="AccessScope",e[e.ArrayLiteral=17955]="ArrayLiteral",e[e.ObjectLiteral=17956]="ObjectLiteral",e[e.PrimitiveLiteral=17925]="PrimitiveLiteral",e[e.Template=17958]="Template",e[e.Unary=39]="Unary",e[e.CallScope=1448]="CallScope",e[e.CallMember=1161]="CallMember",e[e.CallFunction=1162]="CallFunction",e[e.AccessMember=9323]="AccessMember",e[e.AccessKeyed=9324]="AccessKeyed",e[e.TaggedTemplate=1197]="TaggedTemplate",e[e.Binary=46]="Binary",e[e.Conditional=63]="Conditional",e[e.Assign=8208]="Assign",e[e.ValueConverter=36913]="ValueConverter",e[e.BindingBehavior=38962]="BindingBehavior",e[e.HtmlLiteral=51]="HtmlLiteral",e[e.ArrayBindingPattern=65556]="ArrayBindingPattern",e[e.ObjectBindingPattern=65557]="ObjectBindingPattern",e[e.BindingIdentifier=65558]="BindingIdentifier",e[e.ForOfStatement=6199]="ForOfStatement",e[e.Interpolation=24]="Interpolation"}(U||(U={}));class B{constructor(){this.text=""}static unparse(e){const t=new B;return e.accept(t),t.text}visitAccessMember(e){e.object.accept(this),this.text+=`.${e.name}`}visitAccessKeyed(e){e.object.accept(this),this.text+="[",e.key.accept(this),this.text+="]"}visitAccessThis(e){if(0===e.ancestor)return void(this.text+="$this");this.text+="$parent";let t=e.ancestor-1;for(;t--;)this.text+=".$parent"}visitAccessScope(e){let t=e.ancestor;for(;t--;)this.text+="$parent.";this.text+=e.name}visitArrayLiteral(e){const t=e.elements;this.text+="[";for(let e=0,n=t.length;e<n;++e)0!==e&&(this.text+=","),t[e].accept(this);this.text+="]"}visitObjectLiteral(e){const t=e.keys,n=e.values;this.text+="{";for(let e=0,r=t.length;e<r;++e)0!==e&&(this.text+=","),this.text+=`'${t[e]}':`,n[e].accept(this);this.text+="}"}visitPrimitiveLiteral(e){if(this.text+="(","string"==typeof e.value){const t=e.value.replace(/'/g,"\\'");this.text+=`'${t}'`}else this.text+=`${e.value}`;this.text+=")"}visitCallFunction(e){this.text+="(",e.func.accept(this),this.writeArgs(e.args),this.text+=")"}visitCallMember(e){this.text+="(",e.object.accept(this),this.text+=`.${e.name}`,this.writeArgs(e.args),this.text+=")"}visitCallScope(e){this.text+="(";let t=e.ancestor;for(;t--;)this.text+="$parent.";this.text+=e.name,this.writeArgs(e.args),this.text+=")"}visitTemplate(e){const{cooked:t,expressions:n}=e,r=n.length;this.text+="`",this.text+=t[0];for(let e=0;e<r;e++)n[e].accept(this),this.text+=t[e+1];this.text+="`"}visitTaggedTemplate(e){const{cooked:t,expressions:n}=e,r=n.length;e.func.accept(this),this.text+="`",this.text+=t[0];for(let e=0;e<r;e++)n[e].accept(this),this.text+=t[e+1];this.text+="`"}visitUnary(e){this.text+=`(${e.operation}`,e.operation.charCodeAt(0)>=97&&(this.text+=" "),e.expression.accept(this),this.text+=")"}visitBinary(e){this.text+="(",e.left.accept(this),105===e.operation.charCodeAt(0)?this.text+=` ${e.operation} `:this.text+=e.operation,e.right.accept(this),this.text+=")"}visitConditional(e){this.text+="(",e.condition.accept(this),this.text+="?",e.yes.accept(this),this.text+=":",e.no.accept(this),this.text+=")"}visitAssign(e){this.text+="(",e.target.accept(this),this.text+="=",e.value.accept(this),this.text+=")"}visitValueConverter(e){const t=e.args;e.expression.accept(this),this.text+=`|${e.name}`;for(let e=0,n=t.length;e<n;++e)this.text+=":",t[e].accept(this)}visitBindingBehavior(e){const t=e.args;e.expression.accept(this),this.text+=`&${e.name}`;for(let e=0,n=t.length;e<n;++e)this.text+=":",t[e].accept(this)}visitArrayBindingPattern(e){const t=e.elements;this.text+="[";for(let e=0,n=t.length;e<n;++e)0!==e&&(this.text+=","),t[e].accept(this);this.text+="]"}visitObjectBindingPattern(e){const t=e.keys,n=e.values;this.text+="{";for(let e=0,r=t.length;e<r;++e)0!==e&&(this.text+=","),this.text+=`'${t[e]}':`,n[e].accept(this);this.text+="}"}visitBindingIdentifier(e){this.text+=e.name}visitHtmlLiteral(e){throw new Error("visitHtmlLiteral")}visitForOfStatement(e){e.declaration.accept(this),this.text+=" of ",e.iterable.accept(this)}visitInterpolation(e){const{parts:t,expressions:n}=e,r=n.length;this.text+="${",this.text+=t[0];for(let e=0;e<r;e++)n[e].accept(this),this.text+=t[e+1];this.text+="}"}writeArgs(e){this.text+="(";for(let t=0,n=e.length;t<n;++t)0!==t&&(this.text+=","),e[t].accept(this);this.text+=")"}}function I(e,t,n){if(e){if(null==n)throw new Error("Host scope is missing. Are you using `$host` outside the `au-slot`? Or missing the `au-slot` attribute?");return n}return t}class j{constructor(e){this.value=e}evaluate(e,t,n,r,s){return this.value}}class V{constructor(e,t,n){this.expression=e,this.name=t,this.args=n,this.behaviorKey=$.keyFrom(t)}get $kind(){return 38962}get hasBind(){return!0}get hasUnbind(){return!0}evaluate(e,t,n,r,s){return this.expression.evaluate(e,t,n,r,s)}assign(e,t,n,r,s){return this.expression.assign(e,t,n,r,s)}bind(e,t,n,r){this.expression.hasBind&&this.expression.bind(e,t,n,r);const s=r.locator.get(this.behaviorKey);if(null==s)throw new Error(`BindingBehavior named '${this.name}' could not be found. Did you forget to register it as a dependency?`);if(!(s instanceof S)){if(void 0!==r[this.behaviorKey])throw new Error(`BindingBehavior named '${this.name}' already applied.`);r[this.behaviorKey]=s,s.bind.call(s,e,t,n,r,...this.args.map((s=>s.evaluate(e,t,n,r.locator,null))))}}unbind(e,t,n,r){const s=this.behaviorKey,i=r;void 0!==i[s]&&("function"==typeof i[s].unbind&&i[s].unbind(e,t,n,r),i[s]=void 0),this.expression.hasUnbind&&this.expression.unbind(e,t,n,r)}accept(e){return e.visitBindingBehavior(this)}toString(){return B.unparse(this)}}class P{constructor(e,t,n){this.expression=e,this.name=t,this.args=n,this.converterKey=A.keyFrom(t)}get $kind(){return 36913}get hasBind(){return!1}get hasUnbind(){return!0}evaluate(e,t,n,r,s){const i=r.get(this.converterKey);if(null==i)throw new Error(`ValueConverter named '${this.name}' could not be found. Did you forget to register it as a dependency?`);if(null!==s&&"handleChange"in s){const e=i.signals;if(null!=e){const t=r.get(w);for(let n=0,r=e.length;n<r;++n)t.addSignalListener(e[n],s)}}return"toView"in i?i.toView(this.expression.evaluate(e,t,n,r,s),...this.args.map((i=>i.evaluate(e,t,n,r,s)))):this.expression.evaluate(e,t,n,r,s)}assign(e,t,n,r,s){const i=r.get(this.converterKey);if(null==i)throw new Error(`ValueConverter named '${this.name}' could not be found. Did you forget to register it as a dependency?`);return"fromView"in i&&(s=i.fromView(s,...this.args.map((s=>s.evaluate(e,t,n,r,null))))),this.expression.assign(e,t,n,r,s)}unbind(e,t,n,r){const s=r.locator.get(this.converterKey);if(void 0===s.signals)return;const i=r.locator.get(w);for(let e=0;e<s.signals.length;++e)i.removeSignalListener(s.signals[e],r)}accept(e){return e.visitValueConverter(this)}toString(){return B.unparse(this)}}class M{constructor(e,t){this.target=e,this.value=t}get $kind(){return 8208}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){return this.target.assign(e,t,n,r,this.value.evaluate(e,t,n,r,s))}assign(e,t,n,r,s){return this.value.assign(e,t,n,r,s),this.target.assign(e,t,n,r,s)}accept(e){return e.visitAssign(this)}toString(){return B.unparse(this)}}class _{constructor(e,t,n){this.condition=e,this.yes=t,this.no=n}get $kind(){return 63}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){return this.condition.evaluate(e,t,n,r,s)?this.yes.evaluate(e,t,n,r,s):this.no.evaluate(e,t,n,r,s)}assign(e,t,n,r,s){}accept(e){return e.visitConditional(this)}toString(){return B.unparse(this)}}class F{constructor(e=0){this.ancestor=e}get $kind(){return 1793}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){var i;this===F.$host&&(t=I(!0,t,n));let o=t.overrideContext,a=t,u=this.ancestor;for(;u--&&o;)a=a.parentScope,o=null!==(i=null==a?void 0:a.overrideContext)&&void 0!==i?i:null;return u<1&&o?o.bindingContext:void 0}assign(e,t,n,r,s){}accept(e){return e.visitAccessThis(this)}toString(){return B.unparse(this)}}F.$this=new F(0),F.$host=new F(0),F.$parent=new F(1);class K{constructor(e,t=0,n=!1){this.name=e,this.ancestor=t,this.accessHostScope=n}get $kind(){return 10082}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){const i=v.get(I(this.accessHostScope,t,n),this.name,this.ancestor,e,n);null!==s&&s.observeProperty(i,this.name);const o=i[this.name];return 1&e?o:null==o?"":o}assign(e,t,n,r,s){var i;const o=v.get(I(this.accessHostScope,t,n),this.name,this.ancestor,e,n);if(o instanceof Object)return void 0!==(null===(i=o.$observers)||void 0===i?void 0:i[this.name])?(o.$observers[this.name].setValue(s,e),s):o[this.name]=s}accept(e){return e.visitAccessScope(this)}toString(){return B.unparse(this)}}class D{constructor(e,t){this.object=e,this.name=t}get $kind(){return 9323}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){const i=this.object.evaluate(e,t,n,r,(128&e)>0?null:s);return 1&e?null==i?i:(null!==s&&s.observeProperty(i,this.name),i[this.name]):(null!==s&&i instanceof Object&&s.observeProperty(i,this.name),i?i[this.name]:"")}assign(e,t,n,r,s){const i=this.object.evaluate(e,t,n,r,null);return i instanceof Object?void 0!==i.$observers&&void 0!==i.$observers[this.name]?i.$observers[this.name].setValue(s,e):i[this.name]=s:this.object.assign(e,t,n,r,{[this.name]:s}),s}accept(e){return e.visitAccessMember(this)}toString(){return B.unparse(this)}}class q{constructor(e,t){this.object=e,this.key=t}get $kind(){return 9324}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){const i=this.object.evaluate(e,t,n,r,(128&e)>0?null:s);if(i instanceof Object){const o=this.key.evaluate(e,t,n,r,(128&e)>0?null:s);return null!==s&&s.observeProperty(i,o),i[o]}}assign(e,t,n,r,s){return this.object.evaluate(e,t,n,r,null)[this.key.evaluate(e,t,n,r,null)]=s}accept(e){return e.visitAccessKeyed(this)}toString(){return B.unparse(this)}}class N{constructor(e,t,n=0,r=!1){this.name=e,this.args=t,this.ancestor=n,this.accessHostScope=r}get $kind(){return 1448}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){t=I(this.accessHostScope,t,n);const i=this.args.map((i=>i.evaluate(e,t,n,r,s))),o=v.get(t,this.name,this.ancestor,e,n),a=oe(e,o,this.name);if(a)return a.apply(o,i)}assign(e,t,n,r,s){}accept(e){return e.visitCallScope(this)}toString(){return B.unparse(this)}}class R{constructor(e,t,n){this.object=e,this.name=t,this.args=n}get $kind(){return 1161}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){const i=this.object.evaluate(e,t,n,r,(128&e)>0?null:s),o=this.args.map((i=>i.evaluate(e,t,n,r,s))),a=oe(e,i,this.name);if(a)return a.apply(i,o)}assign(e,t,n,r,s){}accept(e){return e.visitCallMember(this)}toString(){return B.unparse(this)}}class H{constructor(e,t){this.func=e,this.args=t}get $kind(){return 1162}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){const i=this.func.evaluate(e,t,n,r,s);if("function"==typeof i)return i(...this.args.map((i=>i.evaluate(e,t,n,r,s))));if(8&e||null!=i)throw new Error("Expression is not a function.")}assign(e,t,n,r,s){}accept(e){return e.visitCallFunction(this)}toString(){return B.unparse(this)}}class z{constructor(e,t,n){this.operation=e,this.left=t,this.right=n}get $kind(){return 46}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){switch(this.operation){case"&&":return this.left.evaluate(e,t,n,r,s)&&this.right.evaluate(e,t,n,r,s);case"||":return this.left.evaluate(e,t,n,r,s)||this.right.evaluate(e,t,n,r,s);case"==":return this.left.evaluate(e,t,n,r,s)==this.right.evaluate(e,t,n,r,s);case"===":return this.left.evaluate(e,t,n,r,s)===this.right.evaluate(e,t,n,r,s);case"!=":return this.left.evaluate(e,t,n,r,s)!=this.right.evaluate(e,t,n,r,s);case"!==":return this.left.evaluate(e,t,n,r,s)!==this.right.evaluate(e,t,n,r,s);case"instanceof":{const i=this.right.evaluate(e,t,n,r,s);return"function"==typeof i&&this.left.evaluate(e,t,n,r,s)instanceof i}case"in":{const i=this.right.evaluate(e,t,n,r,s);return i instanceof Object&&this.left.evaluate(e,t,n,r,s)in i}case"+":{const i=this.left.evaluate(e,t,n,r,s),o=this.right.evaluate(e,t,n,r,s);if((1&e)>0)return i+o;if(!i||!o){if(a(i)||a(o))return(i||0)+(o||0);if(u(i)||u(o))return(i||"")+(o||"")}return i+o}case"-":return this.left.evaluate(e,t,n,r,s)-this.right.evaluate(e,t,n,r,s);case"*":return this.left.evaluate(e,t,n,r,s)*this.right.evaluate(e,t,n,r,s);case"/":return this.left.evaluate(e,t,n,r,s)/this.right.evaluate(e,t,n,r,s);case"%":return this.left.evaluate(e,t,n,r,s)%this.right.evaluate(e,t,n,r,s);case"<":return this.left.evaluate(e,t,n,r,s)<this.right.evaluate(e,t,n,r,s);case">":return this.left.evaluate(e,t,n,r,s)>this.right.evaluate(e,t,n,r,s);case"<=":return this.left.evaluate(e,t,n,r,s)<=this.right.evaluate(e,t,n,r,s);case">=":return this.left.evaluate(e,t,n,r,s)>=this.right.evaluate(e,t,n,r,s);default:throw new Error(`Unknown binary operator: '${this.operation}'`)}}assign(e,t,n,r,s){}accept(e){return e.visitBinary(this)}toString(){return B.unparse(this)}}class Q{constructor(e,t){this.operation=e,this.expression=t}get $kind(){return 39}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){switch(this.operation){case"void":return void this.expression.evaluate(e,t,n,r,s);case"typeof":return typeof this.expression.evaluate(1|e,t,n,r,s);case"!":return!this.expression.evaluate(e,t,n,r,s);case"-":return-this.expression.evaluate(e,t,n,r,s);case"+":return+this.expression.evaluate(e,t,n,r,s);default:throw new Error(`Unknown unary operator: '${this.operation}'`)}}assign(e,t,n,r,s){}accept(e){return e.visitUnary(this)}toString(){return B.unparse(this)}}class W{constructor(e){this.value=e}get $kind(){return 17925}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){return this.value}assign(e,t,n,r,s){}accept(e){return e.visitPrimitiveLiteral(this)}toString(){return B.unparse(this)}}W.$undefined=new W(void 0),W.$null=new W(null),W.$true=new W(!0),W.$false=new W(!1),W.$empty=new W("");class G{constructor(e){this.parts=e}get $kind(){return 51}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){let i="";for(let o=0;o<this.parts.length;++o){const a=this.parts[o].evaluate(e,t,n,r,s);null!=a&&(i+=a)}return i}assign(e,t,n,r,s,i){}accept(e){return e.visitHtmlLiteral(this)}toString(){return B.unparse(this)}}class Z{constructor(e){this.elements=e}get $kind(){return 17955}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){return this.elements.map((i=>i.evaluate(e,t,n,r,s)))}assign(e,t,n,r,s){}accept(e){return e.visitArrayLiteral(this)}toString(){return B.unparse(this)}}Z.$empty=new Z(l);class J{constructor(e,t){this.keys=e,this.values=t}get $kind(){return 17956}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){const i={};for(let o=0;o<this.keys.length;++o)i[this.keys[o]]=this.values[o].evaluate(e,t,n,r,s);return i}assign(e,t,n,r,s){}accept(e){return e.visitObjectLiteral(this)}toString(){return B.unparse(this)}}J.$empty=new J(l,l);class X{constructor(e,t=l){this.cooked=e,this.expressions=t}get $kind(){return 17958}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){let i=this.cooked[0];for(let o=0;o<this.expressions.length;++o)i+=String(this.expressions[o].evaluate(e,t,n,r,s)),i+=this.cooked[o+1];return i}assign(e,t,n,r,s){}accept(e){return e.visitTemplate(this)}toString(){return B.unparse(this)}}X.$empty=new X([""]);class Y{constructor(e,t,n,r=l){this.cooked=e,this.func=n,this.expressions=r,e.raw=t}get $kind(){return 1197}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){const i=this.expressions.map((i=>i.evaluate(e,t,n,r,s))),o=this.func.evaluate(e,t,n,r,s);if("function"!=typeof o)throw new Error("Left-hand side of tagged template expression is not a function.");return o(this.cooked,...i)}assign(e,t,n,r,s){}accept(e){return e.visitTaggedTemplate(this)}toString(){return B.unparse(this)}}class ee{constructor(e){this.elements=e}get $kind(){return 65556}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){}assign(e,t,n,r,s){}accept(e){return e.visitArrayBindingPattern(this)}toString(){return B.unparse(this)}}class te{constructor(e,t){this.keys=e,this.values=t}get $kind(){return 65557}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){}assign(e,t,n,r,s){}accept(e){return e.visitObjectBindingPattern(this)}toString(){return B.unparse(this)}}class ne{constructor(e){this.name=e}get $kind(){return 65558}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){return this.name}accept(e){return e.visitBindingIdentifier(this)}toString(){return B.unparse(this)}}const re=Object.prototype.toString;class se{constructor(e,t){this.declaration=e,this.iterable=t}get $kind(){return 6199}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){return this.iterable.evaluate(e,t,n,r,s)}assign(e,t,n,r,s){}count(e,t){switch(re.call(t)){case"[object Array]":return t.length;case"[object Map]":case"[object Set]":return t.size;case"[object Number]":return t;case"[object Null]":case"[object Undefined]":return 0;default:throw new Error(`Cannot count ${re.call(t)}`)}}iterate(e,t,n){switch(re.call(t)){case"[object Array]":return ae(t,n);case"[object Map]":return function(e,t){const n=Array(e.size);let r=-1;for(const t of e.entries())n[++r]=t;ae(n,t)}(t,n);case"[object Set]":return function(e,t){const n=Array(e.size);let r=-1;for(const t of e.keys())n[++r]=t;ae(n,t)}(t,n);case"[object Number]":return function(e,t){const n=Array(e);for(let t=0;t<e;++t)n[t]=t;ae(n,t)}(t,n);case"[object Null]":case"[object Undefined]":return;default:throw new Error(`Cannot iterate over ${re.call(t)}`)}}bind(e,t,n,r){this.iterable.hasBind&&this.iterable.bind(e,t,n,r)}unbind(e,t,n,r){this.iterable.hasUnbind&&this.iterable.unbind(e,t,n,r)}accept(e){return e.visitForOfStatement(this)}toString(){return B.unparse(this)}}class ie{constructor(e,t=l){this.parts=e,this.expressions=t,this.isMulti=t.length>1,this.firstExpression=t[0]}get $kind(){return 24}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,n,r,s){if(this.isMulti){let i=this.parts[0];for(let o=0;o<this.expressions.length;++o)i+=String(this.expressions[o].evaluate(e,t,n,r,s)),i+=this.parts[o+1];return i}return`${this.parts[0]}${this.firstExpression.evaluate(e,t,n,r,s)}${this.parts[1]}`}assign(e,t,n,r,s){}accept(e){return e.visitInterpolation(this)}toString(){return B.unparse(this)}}function oe(e,t,n){const r=null==t?null:t[n];if("function"==typeof r)return r;if(!(8&e)&&null==r)return null;throw new Error(`Expected '${n}' to be a function`)}function ae(e,t){for(let n=0,r=e.length;n<r;++n)t(e,n,e[n])}const ue=Reflect.defineProperty;function le(e,t,n){ue(e,t,{enumerable:!1,configurable:!0,writable:!0,value:n})}function ce(e,t,n,r=!1){!r&&Object.prototype.hasOwnProperty.call(e,t)||le(e,t,n)}var he,de,pe,fe,ge,ve;function be(e,t){const{length:n}=e,r=Array(n);let s=0;for(;s<n;)r[s]=e[s],++s;return r.deletedItems=void 0!==t?t.slice(0):void 0!==e.deletedItems?e.deletedItems.slice(0):[],r.isIndexMap=!0,r}function ye(e=0){const t=Array(e);let n=0;for(;n<e;)t[n]=n++;return t.deletedItems=[],t.isIndexMap=!0,t}function me(e){const t=e.slice();return t.deletedItems=e.deletedItems.slice(),t.isIndexMap=!0,t}function we(e){return e instanceof Array&&!0===e.isIndexMap}function xe(e){return null==e?Ce:Ce(e)}function Ce(e){const t=e.prototype;ue(t,"subs",{get:Oe}),ce(t,"subscribe",Se),ce(t,"unsubscribe",Te)}!function(e){e[e.oneTime=1]="oneTime",e[e.toView=2]="toView",e[e.fromView=4]="fromView",e[e.twoWay=6]="twoWay",e[e.default=8]="default"}(he||(he={})),function(e){e[e.none=0]="none",e[e.persistentBindingFlags=961]="persistentBindingFlags",e[e.allowParentScopeTraversal=64]="allowParentScopeTraversal",e[e.observeLeafPropertiesOnly=128]="observeLeafPropertiesOnly",e[e.targetObserverFlags=769]="targetObserverFlags",e[e.noFlush=256]="noFlush",e[e.persistentTargetObserverQueue=512]="persistentTargetObserverQueue",e[e.bindingStrategy=1]="bindingStrategy",e[e.isStrictBindingStrategy=1]="isStrictBindingStrategy",e[e.fromBind=2]="fromBind",e[e.fromUnbind=4]="fromUnbind",e[e.mustEvaluate=8]="mustEvaluate",e[e.isTraversingParentScope=16]="isTraversingParentScope",e[e.dispose=32]="dispose"}(de||(de={})),function(e){e[e.None=0]="None",e[e.Subscriber0=1]="Subscriber0",e[e.Subscriber1=2]="Subscriber1",e[e.Subscriber2=4]="Subscriber2",e[e.SubscribersRest=8]="SubscribersRest",e[e.Any=15]="Any"}(pe||(pe={})),function(e){e[e.none=0]="none",e[e.capturing=1]="capturing",e[e.bubbling=2]="bubbling"}(fe||(fe={})),function(e){e[e.indexed=8]="indexed",e[e.keyed=4]="keyed",e[e.array=9]="array",e[e.map=6]="map",e[e.set=7]="set"}(ge||(ge={})),function(e){e[e.None=0]="None",e[e.Observer=1]="Observer",e[e.Node=2]="Node",e[e.Layout=4]="Layout",e[e.Primtive=8]="Primtive",e[e.Array=18]="Array",e[e.Set=34]="Set",e[e.Map=66]="Map"}(ve||(ve={}));class ke{constructor(){this._sf=0,this.count=0}add(e){if(this.has(e))return!1;const t=this._sf;return 0==(1&t)?(this._s0=e,this._sf|=1):0==(2&t)?(this._s1=e,this._sf|=2):0==(4&t)?(this._s2=e,this._sf|=4):0==(8&t)?(this._sr=[e],this._sf|=8):this._sr.push(e),++this.count,!0}has(e){const t=this._sf;if((1&t)>0&&this._s0===e)return!0;if((2&t)>0&&this._s1===e)return!0;if((4&t)>0&&this._s2===e)return!0;if((8&t)>0){const t=this._sr,n=t.length;let r=0;for(;r<n;++r)if(t[r]===e)return!0}return!1}any(){return 0!==this._sf}remove(e){const t=this._sf;if((1&t)>0&&this._s0===e)return this._s0=void 0,this._sf=1^(1|this._sf),--this.count,!0;if((2&t)>0&&this._s1===e)return this._s1=void 0,this._sf=2^(2|this._sf),--this.count,!0;if((4&t)>0&&this._s2===e)return this._s2=void 0,this._sf=4^(4|this._sf),--this.count,!0;if((8&t)>0){const t=this._sr,n=t.length;let r=0;for(;r<n;++r)if(t[r]===e)return t.splice(r,1),1===n&&(this._sf=8^(8|this._sf)),--this.count,!0}return!1}notify(e,t,n){const r=this._s0,s=this._s1,i=this._s2;let o=this._sr;if(void 0!==o&&(o=o.slice()),void 0!==r&&r.handleChange(e,t,n),void 0!==s&&s.handleChange(e,t,n),void 0!==i&&i.handleChange(e,t,n),void 0!==o){const r=o.length;let s,i=0;for(;i<r;++i)s=o[i],void 0!==s&&s.handleChange(e,t,n)}}notifyCollection(e,t){const n=this._s0,r=this._s1,s=this._s2;let i=this._sr;if(void 0!==i&&(i=i.slice()),void 0!==n&&n.handleCollectionChange(e,t),void 0!==r&&r.handleCollectionChange(e,t),void 0!==s&&s.handleCollectionChange(e,t),void 0!==i){const n=i.length;let r,s=0;for(;s<n;++s)r=i[s],void 0!==r&&r.handleCollectionChange(e,t)}}}function Oe(){const e=new ke;return le(this,"subs",e),e}function Se(e){return this.subs.add(e)}function Te(e){return this.subs.remove(e)}function $e(e){return null==e?Le:Le(e)}function Le(e){ue(e.prototype,"queue",{get:Ae})}class Ee{constructor(){this.flushing=!1,this.items=new Set}get count(){return this.items.size}add(e){if(this.items.add(e),this.flushing)return;this.flushing=!0;const t=this.items;let n;try{for(n of t)t.delete(n),n.flush()}finally{this.flushing=!1}}clear(){this.items.clear(),this.flushing=!1}}function Ae(){return Ee.instance}Ee.instance=new Ee;class Ue{constructor(e){this.owner=e,this.f=0,this.type=18,this.value=this.oldvalue=(this.obj=e.collection).length}getValue(){return this.obj.length}setValue(e,t){const n=this.value;e!==n&&c(e)&&(0==(256&t)&&(this.obj.length=e),this.value=e,this.oldvalue=n,this.f=t,this.queue.add(this))}handleCollectionChange(e,t){const n=this.value;(this.value=this.obj.length)!==n&&(this.oldvalue=n,this.f=t,this.queue.add(this))}flush(){Pe=this.oldvalue,this.oldvalue=this.value,this.subs.notify(this.value,Pe,this.f)}}class Be{constructor(e){this.owner=e,this.f=0,this.value=this.oldvalue=(this.obj=e.collection).size,this.type=this.obj instanceof Map?66:34}getValue(){return this.obj.size}setValue(){throw new Error('Map/Set "size" is a readonly property')}handleCollectionChange(e,t){const n=this.value;(this.value=this.obj.size)!==n&&(this.oldvalue=n,this.f=t,this.queue.add(this))}flush(){Pe=this.oldvalue,this.oldvalue=this.value,this.subs.notify(this.value,Pe,this.f)}}function Ie(e){const t=e.prototype;ce(t,"subscribe",je,!0),ce(t,"unsubscribe",Ve,!0),$e(e),xe(e)}function je(e){this.subs.add(e)&&1===this.subs.count&&this.owner.subscribe(this)}function Ve(e){this.subs.remove(e)&&0===this.subs.count&&this.owner.subscribe(this)}let Pe;Ie(Ue),Ie(Be);const Me=new WeakMap;function _e(e,t){return e===t?0:(e=null===e?"null":e.toString())<(t=null===t?"null":t.toString())?-1:1}function Fe(e,t){return void 0===e?void 0===t?0:1:void 0===t?-1:0}function Ke(e,t,n,r,s){let i,o,a,u,l,c,h;for(c=n+1;c<r;c++){for(i=e[c],o=t[c],h=c-1;h>=n&&(a=e[h],u=t[h],l=s(a,i),l>0);h--)e[h+1]=a,t[h+1]=u;e[h+1]=i,t[h+1]=o}}function De(e,t,n,r,s){let i,o,a,u,l,c,h,d,p,f,g,v,b,y,m,w,x,C,k,O=0,S=0;for(;;){if(r-n<=10)return void Ke(e,t,n,r,s);O=n+(r-n>>1),i=e[n],u=t[n],o=e[r-1],l=t[r-1],a=e[O],c=t[O],h=s(i,o),h>0&&(f=i,g=u,i=o,u=l,o=f,l=g),d=s(i,a),d>=0?(f=i,g=u,i=a,u=c,a=o,c=l,o=f,l=g):(p=s(o,a),p>0&&(f=o,g=l,o=a,l=c,a=f,c=g)),e[n]=i,t[n]=u,e[r-1]=a,t[r-1]=c,v=o,b=l,y=n+1,m=r-1,e[O]=e[y],t[O]=t[y],e[y]=v,t[y]=b;e:for(S=y+1;S<m;S++)if(w=e[S],x=t[S],C=s(w,v),C<0)e[S]=e[y],t[S]=t[y],e[y]=w,t[y]=x,y++;else if(C>0){do{if(m--,m==S)break e;k=e[m],C=s(k,v)}while(C>0);e[S]=e[m],t[S]=t[m],e[m]=w,t[m]=x,C<0&&(w=e[S],x=t[S],e[S]=e[y],t[S]=t[y],e[y]=w,t[y]=x,y++)}r-m<y-n?(De(e,t,m,r,s),r=y):(De(e,t,n,y,s),n=m)}}const qe=Array.prototype,Ne=qe.push,Re=qe.unshift,He=qe.pop,ze=qe.shift,Qe=qe.splice,We=qe.reverse,Ge=qe.sort,Ze={push:Ne,unshift:Re,pop:He,shift:ze,splice:Qe,reverse:We,sort:Ge},Je=["push","unshift","pop","shift","splice","reverse","sort"],Xe={push:function(...e){const t=Me.get(this);if(void 0===t)return Ne.apply(this,e);const n=this.length,r=e.length;if(0===r)return n;this.length=t.indexMap.length=n+r;let s=n;for(;s<this.length;)this[s]=e[s-n],t.indexMap[s]=-2,s++;return t.notify(),this.length},unshift:function(...e){const t=Me.get(this);if(void 0===t)return Re.apply(this,e);const n=e.length,r=new Array(n);let s=0;for(;s<n;)r[s++]=-2;Re.apply(t.indexMap,r);const i=Re.apply(this,e);return t.notify(),i},pop:function(){const e=Me.get(this);if(void 0===e)return He.call(this);const t=e.indexMap,n=He.call(this),r=t.length-1;return t[r]>-1&&t.deletedItems.push(t[r]),He.call(t),e.notify(),n},shift:function(){const e=Me.get(this);if(void 0===e)return ze.call(this);const t=e.indexMap,n=ze.call(this);return t[0]>-1&&t.deletedItems.push(t[0]),ze.call(t),e.notify(),n},splice:function(...e){const t=e[0],n=e[1],r=Me.get(this);if(void 0===r)return Qe.apply(this,e);const s=this.length,i=0|t,o=i<0?Math.max(s+i,0):Math.min(i,s),a=r.indexMap,u=e.length,l=0===u?0:1===u?s-o:n;if(l>0){let e=o;const t=e+l;for(;e<t;)a[e]>-1&&a.deletedItems.push(a[e]),e++}if(u>2){const e=u-2,r=new Array(e);let s=0;for(;s<e;)r[s++]=-2;Qe.call(a,t,n,...r)}else Qe.apply(a,e);const c=Qe.apply(this,e);return r.notify(),c},reverse:function(){const e=Me.get(this);if(void 0===e)return We.call(this),this;const t=this.length,n=t/2|0;let r=0;for(;r!==n;){const n=t-r-1,s=this[r],i=e.indexMap[r],o=e.indexMap[n];this[r]=this[n],e.indexMap[r]=o,this[n]=s,e.indexMap[n]=i,r++}return e.notify(),this},sort:function(e){const t=Me.get(this);if(void 0===t)return Ge.call(this,e),this;const n=this.length;if(n<2)return this;De(this,t.indexMap,0,n,Fe);let r=0;for(;r<n&&void 0!==this[r];)r++;return void 0!==e&&"function"==typeof e||(e=_e),De(this,t.indexMap,0,r,e),t.notify(),this}};for(const e of Je)ue(Xe[e],"observing",{value:!0,writable:!1,configurable:!1,enumerable:!1});let Ye=!1;function et(){for(const e of Je)!0!==qe[e].observing&&le(qe,e,Xe[e])}function tt(){for(const e of Je)!0===qe[e].observing&&le(qe,e,Ze[e])}class nt{constructor(e){this.type=18,Ye||(Ye=!0,et()),this.indexObservers={},this.collection=e,this.indexMap=ye(e.length),this.lenObs=void 0,Me.set(e,this)}notify(){const e=this.indexMap;this.indexMap=ye(this.collection.length),this.subs.notifyCollection(e,0)}getLengthObserver(){var e;return null!==(e=this.lenObs)&&void 0!==e?e:this.lenObs=new Ue(this)}getIndexObserver(e){var t,n;return null!==(t=(n=this.indexObservers)[e])&&void 0!==t?t:n[e]=new rt(this,e)}}class rt{constructor(e,t){this.owner=e,this.index=t,this.doNotCache=!0,this.value=this.getValue()}getValue(){return this.owner.collection[this.index]}setValue(e,t){if(e===this.getValue())return;const n=this.owner,r=this.index,s=n.indexMap;s[r]>-1&&s.deletedItems.push(s[r]),s[r]=-2,n.collection[r]=e,n.notify()}handleCollectionChange(e,t){const n=this.index;if(e[n]===n)return;const r=this.value,s=this.value=this.getValue();r!==s&&this.subs.notify(s,r,t)}subscribe(e){this.subs.add(e)&&1===this.subs.count&&this.owner.subscribe(this)}unsubscribe(e){this.subs.remove(e)&&0===this.subs.count&&this.owner.unsubscribe(this)}}function st(e){let t=Me.get(e);return void 0===t&&(t=new nt(e)),t}function it(e){let t=0,n=0;const r=e.length;for(let s=0;s<r;++s){for(;e.deletedItems[n]<=s-t;)++n,--t;-2===e[s]?++t:e[s]+=t}}function ot(e,t){const n=e.slice(),r=t.length;let s=0,i=0;for(;s<r;)i=t[s],-2!==i&&(e[s]=n[i]),++s}xe(nt),xe(rt);const at=new WeakMap,ut=Set.prototype,lt=ut.add,ct=ut.clear,ht=ut.delete,dt={add:lt,clear:ct,delete:ht},pt=["add","clear","delete"],ft={add:function(e){const t=at.get(this);if(void 0===t)return lt.call(this,e),this;const n=this.size;lt.call(this,e);return this.size===n||(t.indexMap[n]=-2,t.notify()),this},clear:function(){const e=at.get(this);if(void 0===e)return ct.call(this);if(this.size>0){const t=e.indexMap;let n=0;for(const e of this.keys())t[n]>-1&&t.deletedItems.push(t[n]),n++;ct.call(this),t.length=0,e.notify()}},delete:function(e){const t=at.get(this);if(void 0===t)return ht.call(this,e);if(0===this.size)return!1;let n=0;const r=t.indexMap;for(const s of this.keys()){if(s===e){r[n]>-1&&r.deletedItems.push(r[n]),r.splice(n,1);const s=ht.call(this,e);return!0===s&&t.notify(),s}n++}return!1}},gt={writable:!0,enumerable:!1,configurable:!0};for(const e of pt)ue(ft[e],"observing",{value:!0,writable:!1,configurable:!1,enumerable:!1});let vt=!1;function bt(){for(const e of pt)!0!==ut[e].observing&&ue(ut,e,{...gt,value:ft[e]})}function yt(){for(const e of pt)!0===ut[e].observing&&ue(ut,e,{...gt,value:dt[e]})}class mt{constructor(e){this.type=34,vt||(vt=!0,bt()),this.collection=e,this.indexMap=ye(e.size),this.lenObs=void 0,at.set(e,this)}notify(){const e=this.indexMap;this.indexMap=ye(this.collection.size),this.subs.notifyCollection(e,0)}getLengthObserver(){var e;return null!==(e=this.lenObs)&&void 0!==e?e:this.lenObs=new Be(this)}}function wt(e){let t=at.get(e);return void 0===t&&(t=new mt(e)),t}xe(mt);const xt=new WeakMap,Ct=Map.prototype,kt=Ct.set,Ot=Ct.clear,St=Ct.delete,Tt={set:kt,clear:Ot,delete:St},$t=["set","clear","delete"],Lt={set:function(e,t){const n=xt.get(this);if(void 0===n)return kt.call(this,e,t),this;const r=this.get(e),s=this.size;kt.call(this,e,t);if(this.size===s){let t=0;for(const s of this.entries()){if(s[0]===e)return s[1]!==r&&(n.indexMap.deletedItems.push(n.indexMap[t]),n.indexMap[t]=-2,n.notify()),this;t++}return this}return n.indexMap[s]=-2,n.notify(),this},clear:function(){const e=xt.get(this);if(void 0===e)return Ot.call(this);if(this.size>0){const t=e.indexMap;let n=0;for(const e of this.keys())t[n]>-1&&t.deletedItems.push(t[n]),n++;Ot.call(this),t.length=0,e.notify()}},delete:function(e){const t=xt.get(this);if(void 0===t)return St.call(this,e);if(0===this.size)return!1;let n=0;const r=t.indexMap;for(const s of this.keys()){if(s===e){r[n]>-1&&r.deletedItems.push(r[n]),r.splice(n,1);const s=St.call(this,e);return!0===s&&t.notify(),s}++n}return!1}},Et={writable:!0,enumerable:!1,configurable:!0};for(const e of $t)ue(Lt[e],"observing",{value:!0,writable:!1,configurable:!1,enumerable:!1});let At=!1;function Ut(){for(const e of $t)!0!==Ct[e].observing&&ue(Ct,e,{...Et,value:Lt[e]})}function Bt(){for(const e of $t)!0===Ct[e].observing&&ue(Ct,e,{...Et,value:Tt[e]})}class It{constructor(e){this.type=66,At||(At=!0,Ut()),this.collection=e,this.indexMap=ye(e.size),this.lenObs=void 0,xt.set(e,this)}notify(){const e=this.indexMap;this.indexMap=ye(this.collection.size),this.subs.notifyCollection(e,0)}getLengthObserver(){var e;return null!==(e=this.lenObs)&&void 0!==e?e:this.lenObs=new Be(this)}}function jt(e){let t=xt.get(e);return void 0===t&&(t=new It(e)),t}function Vt(e,t){const n=this.observerLocator.getObserver(e,t);this.obs.add(n)}function Pt(){const e=new Dt(this);return le(this,"obs",e),e}function Mt(e){let t;if(e instanceof Array)t=st(e);else if(e instanceof Set)t=wt(e);else{if(!(e instanceof Map))throw new Error("Unrecognised collection type.");t=jt(e)}this.obs.add(t)}function _t(e){this.obs.add(e)}function Ft(){throw new Error('method "handleChange" not implemented')}function Kt(){throw new Error('method "handleCollectionChange" not implemented')}xe(It);class Dt{constructor(e){this.binding=e,this.version=0,this.count=0,this.slots=0}handleChange(e,t,n){return this.binding.interceptor.handleChange(e,t,n)}handleCollectionChange(e,t){this.binding.interceptor.handleCollectionChange(e,t)}add(e){const t=this.slots;let n=t;for(;n--&&this[`_o${n}`]!==e;);if(-1===n){for(n=0;void 0!==this[`_o${n}`];)n++;this[`_o${n}`]=e,e.subscribe(this),n===t&&(this.slots=n+1),++this.count}this[`_v${n}`]=this.version}clear(e){const t=this.slots;let n,r,s=0;if(!0===e){for(;s<t;++s)n=`_o${s}`,r=this[n],void 0!==r&&(this[n]=void 0,r.unsubscribe(this));this.count=this.slots=0}else for(;s<t;++s)this[`_v${s}`]!==this.version&&(n=`_o${s}`,r=this[n],void 0!==r&&(this[n]=void 0,r.unsubscribe(this),this.count--))}}function qt(e){const t=e.prototype;return ce(t,"observeProperty",Vt,!0),ce(t,"observeCollection",Mt,!0),ce(t,"subscribeTo",_t,!0),ue(t,"obs",{get:Pt}),ce(t,"handleChange",Ft),ce(t,"handleCollectionChange",Kt),e}function Nt(e){return null==e?qt:qt(e)}class Rt{constructor(e,t,n,r){this.key=e,this.binding=t,this.observerLocator=n,this.locator=r,this.interceptor=this}$bind(){throw new Error("Method not implemented.")}$unbind(){throw new Error("Method not implemented.")}handleChange(e,t,n){this.binding[this.key](e,t,n)}}qt(Rt);const Ht=r.createInterface("IExpressionParser",(e=>e.singleton(zt)));class zt{constructor(){this.expressionLookup=Object.create(null),this.forOfLookup=Object.create(null),this.interpolationLookup=Object.create(null)}parse(e,t){switch(t){case 2048:{let n=this.interpolationLookup[e];return void 0===n&&(n=this.interpolationLookup[e]=this.$parse(e,t)),n}case 539:{let n=this.forOfLookup[e];return void 0===n&&(n=this.forOfLookup[e]=this.$parse(e,t)),n}default:{if(0===e.length&&55&t)return W.$empty;let n=this.expressionLookup[e];return void 0===n&&(n=this.expressionLookup[e]=this.$parse(e,t)),n}}}$parse(e,t){return un.input=e,un.length=e.length,un.index=0,un.currentChar=e.charCodeAt(0),cn(un,0,61,void 0===t?53:t)}}var Qt,Wt,Gt,Zt;function Jt(e){switch(e){case 98:return 8;case 116:return 9;case 110:return 10;case 118:return 11;case 102:return 12;case 114:return 13;case 34:return 34;case 39:return 39;case 92:return 92;default:return e}}!function(e){e[e.Null=0]="Null",e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.LineFeed=10]="LineFeed",e[e.VerticalTab=11]="VerticalTab",e[e.FormFeed=12]="FormFeed",e[e.CarriageReturn=13]="CarriageReturn",e[e.Space=32]="Space",e[e.Exclamation=33]="Exclamation",e[e.DoubleQuote=34]="DoubleQuote",e[e.Dollar=36]="Dollar",e[e.Percent=37]="Percent",e[e.Ampersand=38]="Ampersand",e[e.SingleQuote=39]="SingleQuote",e[e.OpenParen=40]="OpenParen",e[e.CloseParen=41]="CloseParen",e[e.Asterisk=42]="Asterisk",e[e.Plus=43]="Plus",e[e.Comma=44]="Comma",e[e.Minus=45]="Minus",e[e.Dot=46]="Dot",e[e.Slash=47]="Slash",e[e.Semicolon=59]="Semicolon",e[e.Backtick=96]="Backtick",e[e.OpenBracket=91]="OpenBracket",e[e.Backslash=92]="Backslash",e[e.CloseBracket=93]="CloseBracket",e[e.Caret=94]="Caret",e[e.Underscore=95]="Underscore",e[e.OpenBrace=123]="OpenBrace",e[e.Bar=124]="Bar",e[e.CloseBrace=125]="CloseBrace",e[e.Colon=58]="Colon",e[e.LessThan=60]="LessThan",e[e.Equals=61]="Equals",e[e.GreaterThan=62]="GreaterThan",e[e.Question=63]="Question",e[e.Zero=48]="Zero",e[e.One=49]="One",e[e.Two=50]="Two",e[e.Three=51]="Three",e[e.Four=52]="Four",e[e.Five=53]="Five",e[e.Six=54]="Six",e[e.Seven=55]="Seven",e[e.Eight=56]="Eight",e[e.Nine=57]="Nine",e[e.UpperA=65]="UpperA",e[e.UpperB=66]="UpperB",e[e.UpperC=67]="UpperC",e[e.UpperD=68]="UpperD",e[e.UpperE=69]="UpperE",e[e.UpperF=70]="UpperF",e[e.UpperG=71]="UpperG",e[e.UpperH=72]="UpperH",e[e.UpperI=73]="UpperI",e[e.UpperJ=74]="UpperJ",e[e.UpperK=75]="UpperK",e[e.UpperL=76]="UpperL",e[e.UpperM=77]="UpperM",e[e.UpperN=78]="UpperN",e[e.UpperO=79]="UpperO",e[e.UpperP=80]="UpperP",e[e.UpperQ=81]="UpperQ",e[e.UpperR=82]="UpperR",e[e.UpperS=83]="UpperS",e[e.UpperT=84]="UpperT",e[e.UpperU=85]="UpperU",e[e.UpperV=86]="UpperV",e[e.UpperW=87]="UpperW",e[e.UpperX=88]="UpperX",e[e.UpperY=89]="UpperY",e[e.UpperZ=90]="UpperZ",e[e.LowerA=97]="LowerA",e[e.LowerB=98]="LowerB",e[e.LowerC=99]="LowerC",e[e.LowerD=100]="LowerD",e[e.LowerE=101]="LowerE",e[e.LowerF=102]="LowerF",e[e.LowerG=103]="LowerG",e[e.LowerH=104]="LowerH",e[e.LowerI=105]="LowerI",e[e.LowerJ=106]="LowerJ",e[e.LowerK=107]="LowerK",e[e.LowerL=108]="LowerL",e[e.LowerM=109]="LowerM",e[e.LowerN=110]="LowerN",e[e.LowerO=111]="LowerO",e[e.LowerP=112]="LowerP",e[e.LowerQ=113]="LowerQ",e[e.LowerR=114]="LowerR",e[e.LowerS=115]="LowerS",e[e.LowerT=116]="LowerT",e[e.LowerU=117]="LowerU",e[e.LowerV=118]="LowerV",e[e.LowerW=119]="LowerW",e[e.LowerX=120]="LowerX",e[e.LowerY=121]="LowerY",e[e.LowerZ=122]="LowerZ"}(Qt||(Qt={})),function(e){e[e.Reset=0]="Reset",e[e.Ancestor=511]="Ancestor",e[e.This=512]="This",e[e.Scope=1024]="Scope",e[e.Member=2048]="Member",e[e.Keyed=4096]="Keyed"}(Wt||(Wt={})),function(e){e[e.Variadic=61]="Variadic",e[e.Assign=62]="Assign",e[e.Conditional=63]="Conditional",e[e.LogicalOR=64]="LogicalOR",e[e.LogicalAND=128]="LogicalAND",e[e.Equality=192]="Equality",e[e.Relational=256]="Relational",e[e.Additive=320]="Additive",e[e.Multiplicative=384]="Multiplicative",e[e.Binary=448]="Binary",e[e.LeftHandSide=449]="LeftHandSide",e[e.Primary=450]="Primary",e[e.Unary=451]="Unary"}(Gt||(Gt={})),function(e){e[e.EOF=1572864]="EOF",e[e.ExpressionTerminal=1048576]="ExpressionTerminal",e[e.AccessScopeTerminal=524288]="AccessScopeTerminal",e[e.ClosingToken=262144]="ClosingToken",e[e.OpeningToken=131072]="OpeningToken",e[e.BinaryOp=65536]="BinaryOp",e[e.UnaryOp=32768]="UnaryOp",e[e.LeftHandSide=16384]="LeftHandSide",e[e.StringOrNumericLiteral=12288]="StringOrNumericLiteral",e[e.NumericLiteral=8192]="NumericLiteral",e[e.StringLiteral=4096]="StringLiteral",e[e.IdentifierName=3072]="IdentifierName",e[e.Keyword=2048]="Keyword",e[e.Identifier=1024]="Identifier",e[e.Contextual=512]="Contextual",e[e.Precedence=448]="Precedence",e[e.Type=63]="Type",e[e.FalseKeyword=2048]="FalseKeyword",e[e.TrueKeyword=2049]="TrueKeyword",e[e.NullKeyword=2050]="NullKeyword",e[e.UndefinedKeyword=2051]="UndefinedKeyword",e[e.ThisScope=3076]="ThisScope",e[e.HostScope=3077]="HostScope",e[e.ParentScope=3078]="ParentScope",e[e.OpenParen=671751]="OpenParen",e[e.OpenBrace=131080]="OpenBrace",e[e.Dot=16393]="Dot",e[e.CloseBrace=1835018]="CloseBrace",e[e.CloseParen=1835019]="CloseParen",e[e.Comma=1572876]="Comma",e[e.OpenBracket=671757]="OpenBracket",e[e.CloseBracket=1835022]="CloseBracket",e[e.Colon=1572879]="Colon",e[e.Question=1572880]="Question",e[e.Ampersand=1572883]="Ampersand",e[e.Bar=1572884]="Bar",e[e.BarBar=1638549]="BarBar",e[e.AmpersandAmpersand=1638614]="AmpersandAmpersand",e[e.EqualsEquals=1638679]="EqualsEquals",e[e.ExclamationEquals=1638680]="ExclamationEquals",e[e.EqualsEqualsEquals=1638681]="EqualsEqualsEquals",e[e.ExclamationEqualsEquals=1638682]="ExclamationEqualsEquals",e[e.LessThan=1638747]="LessThan",e[e.GreaterThan=1638748]="GreaterThan",e[e.LessThanEquals=1638749]="LessThanEquals",e[e.GreaterThanEquals=1638750]="GreaterThanEquals",e[e.InKeyword=1640799]="InKeyword",e[e.InstanceOfKeyword=1640800]="InstanceOfKeyword",e[e.Plus=623009]="Plus",e[e.Minus=623010]="Minus",e[e.TypeofKeyword=34851]="TypeofKeyword",e[e.VoidKeyword=34852]="VoidKeyword",e[e.Asterisk=1638885]="Asterisk",e[e.Percent=1638886]="Percent",e[e.Slash=1638887]="Slash",e[e.Equals=1048616]="Equals",e[e.Exclamation=32809]="Exclamation",e[e.TemplateTail=540714]="TemplateTail",e[e.TemplateContinuation=540715]="TemplateContinuation",e[e.OfKeyword=1051180]="OfKeyword"}(Zt||(Zt={}));const Xt=W.$false,Yt=W.$true,en=W.$null,tn=W.$undefined,nn=F.$this,rn=F.$host,sn=F.$parent;var on;!function(e){e[e.None=0]="None",e[e.IgnoreAttr=4096]="IgnoreAttr",e[e.Interpolation=2048]="Interpolation",e[e.IsRef=5376]="IsRef",e[e.IsIterator=512]="IsIterator",e[e.IsCustom=256]="IsCustom",e[e.IsFunction=128]="IsFunction",e[e.IsEvent=64]="IsEvent",e[e.IsProperty=32]="IsProperty",e[e.IsCommand=16]="IsCommand",e[e.IsPropertyCommand=48]="IsPropertyCommand",e[e.IsEventCommand=80]="IsEventCommand",e[e.DelegationStrategyDelta=6]="DelegationStrategyDelta",e[e.Command=15]="Command",e[e.OneTimeCommand=49]="OneTimeCommand",e[e.ToViewCommand=50]="ToViewCommand",e[e.FromViewCommand=51]="FromViewCommand",e[e.TwoWayCommand=52]="TwoWayCommand",e[e.BindCommand=53]="BindCommand",e[e.TriggerCommand=4182]="TriggerCommand",e[e.CaptureCommand=4183]="CaptureCommand",e[e.DelegateCommand=4184]="DelegateCommand",e[e.CallCommand=153]="CallCommand",e[e.OptionsCommand=26]="OptionsCommand",e[e.ForCommand=539]="ForCommand",e[e.CustomCommand=284]="CustomCommand"}(on||(on={}));class an{constructor(e){this.input=e,this.index=0,this.startIndex=0,this.lastIndex=0,this.currentToken=1572864,this.tokenValue="",this.assignable=!0,this.length=e.length,this.currentChar=e.charCodeAt(0)}get tokenRaw(){return this.input.slice(this.startIndex,this.index)}}const un=new an("");function ln(e,t){return un.input=e,un.length=e.length,un.index=0,un.currentChar=e.charCodeAt(0),cn(un,0,61,void 0===t?53:t)}function cn(e,t,n,r){if(284===r)return new j(e.input);if(0===e.index){if(2048&r)return function(e){const t=[],n=[],r=e.length;let s="";for(;e.index<r;){switch(e.currentChar){case 36:if(123===e.input.charCodeAt(e.index+1)){t.push(s),s="",e.index+=2,e.currentChar=e.input.charCodeAt(e.index),dn(e);const r=cn(e,0,61,2048);n.push(r);continue}s+="$";break;case 92:s+=String.fromCharCode(Jt(pn(e)));break;default:s+=String.fromCharCode(e.currentChar)}pn(e)}if(n.length)return t.push(s),new ie(t,n);return null}(e);if(dn(e),1048576&e.currentToken)throw new Error(`Invalid start of expression: '${e.input}'`)}let s;if(e.assignable=448>n,32768&e.currentToken){const n=mn[63&e.currentToken];dn(e),s=new Q(n,cn(e,t,449,r)),e.assignable=!1}else{e:switch(e.currentToken){case 3078:e.assignable=!1;do{if(dn(e),t++,!bn(e,16393)){if(524288&e.currentToken){const e=511&t;s=0===e?nn:1===e?sn:new F(e),t=512;break e}throw new Error(`Invalid member expression: '${e.input}'`)}if(16393===e.currentToken)throw new Error(`Double dot and spread operators are not supported: '${e.input}'`);if(1572864===e.currentToken)throw new Error(`Expected identifier: '${e.input}'`)}while(3078===e.currentToken);case 1024:512&r?s=new ne(e.tokenValue):(s=new K(e.tokenValue,511&t),t=1024),e.assignable=!0,dn(e);break;case 3076:e.assignable=!1,dn(e),s=nn,t=512;break;case 3077:e.assignable=!1,dn(e),s=rn,t=512;break;case 671751:dn(e),s=cn(e,0,62,r),yn(e,1835019),t=0;break;case 671757:s=function(e,t,n){dn(e);const r=new Array;for(;1835022!==e.currentToken;)if(bn(e,1572876)){if(r.push(tn),1835022===e.currentToken)break}else{if(r.push(cn(e,t,62,-513&n)),!bn(e,1572876))break;if(1835022===e.currentToken)break}return yn(e,1835022),512&n?new ee(r):(e.assignable=!1,new Z(r))}(e,t,r),t=0;break;case 131080:s=function(e,t){const n=new Array,r=new Array;dn(e);for(;1835018!==e.currentToken;){if(n.push(e.tokenValue),12288&e.currentToken)dn(e),yn(e,1572879),r.push(cn(e,0,62,-513&t));else{if(!(3072&e.currentToken))throw new Error(`Invalid or unsupported property definition in object literal: '${e.input}'`);{const{currentChar:n,currentToken:s,index:i}=e;dn(e),bn(e,1572879)?r.push(cn(e,0,62,-513&t)):(e.currentChar=n,e.currentToken=s,e.index=i,r.push(cn(e,0,450,-513&t)))}}1835018!==e.currentToken&&yn(e,1572876)}return yn(e,1835018),512&t?new te(n,r):(e.assignable=!1,new J(n,r))}(e,r),t=0;break;case 540714:s=new X([e.tokenValue]),e.assignable=!1,dn(e),t=0;break;case 540715:s=hn(e,t,r,s,!1),t=0;break;case 4096:case 8192:s=new W(e.tokenValue),e.assignable=!1,dn(e),t=0;break;case 2050:case 2051:case 2049:case 2048:s=mn[63&e.currentToken],e.assignable=!1,dn(e),t=0;break;default:throw e.index>=e.length?new Error(`Unexpected end of expression: '${e.input}'`):new Error(`Unconsumed token: '${e.input}'`)}if(512&r)return function(e,t){if(0==(65536&t.$kind))throw new Error(`Invalid BindingIdentifier at left hand side of "of": '${e.input}'`);if(1051180!==e.currentToken)throw new Error(`Invalid BindingIdentifier at left hand side of "of": '${e.input}'`);dn(e);const n=t,r=cn(e,0,61,0);return new se(n,r)}(e,s);if(449<n)return s;let i=e.tokenValue;for(;(16384&e.currentToken)>0;){const n=[];let o;switch(e.currentToken){case 16393:if(e.assignable=!0,dn(e),0==(3072&e.currentToken))throw new Error(`Expected identifier: '${e.input}'`);if(i=e.tokenValue,dn(e),t=(1536&t)<<1|2048&t|(4096&t)>>1,671751===e.currentToken){0===t&&(t=2048);continue}s=1024&t?new K(i,s.ancestor,s===rn):new D(s,i);continue;case 671757:e.assignable=!0,dn(e),t=4096,s=new q(s,cn(e,0,62,r)),yn(e,1835022);break;case 671751:for(e.assignable=!1,dn(e);1835019!==e.currentToken&&(n.push(cn(e,0,62,r)),bn(e,1572876)););yn(e,1835019),s=1024&t?new N(i,n,s.ancestor,s===rn):2048&t?new R(s,i,n):new H(s,n),t=0;break;case 540714:e.assignable=!1,o=[e.tokenValue],s=new Y(o,o,s),dn(e);break;case 540715:s=hn(e,t,r,s,!0)}}}if(448<n)return s;for(;(65536&e.currentToken)>0;){const i=e.currentToken;if((448&i)<=n)break;dn(e),s=new z(mn[63&i],s,cn(e,t,448&i,r)),e.assignable=!1}if(63<n)return s;if(bn(e,1572880)){const n=cn(e,t,62,r);yn(e,1572879),s=new _(s,n,cn(e,t,62,r)),e.assignable=!1}if(62<n)return s;if(bn(e,1048616)){if(!e.assignable)throw new Error(`Left hand side of expression is not assignable: '${e.input}'`);s=new M(s,cn(e,t,62,r))}if(61<n)return s;for(;bn(e,1572884);){if(1572864===e.currentToken)throw new Error(`Expected identifier to come after ValueConverter operator: '${e.input}'`);const n=e.tokenValue;dn(e);const i=new Array;for(;bn(e,1572879);)i.push(cn(e,t,62,r));s=new P(s,n,i)}for(;bn(e,1572883);){if(1572864===e.currentToken)throw new Error(`Expected identifier to come after BindingBehavior operator: '${e.input}'`);const n=e.tokenValue;dn(e);const i=new Array;for(;bn(e,1572879);)i.push(cn(e,t,62,r));s=new V(s,n,i)}if(1572864!==e.currentToken){if(2048&r)return s;if("of"===e.tokenRaw)throw new Error(`Unexpected keyword "of": '${e.input}'`);throw new Error(`Unconsumed token: '${e.input}'`)}return s}function hn(e,t,n,r,s){const i=[e.tokenValue];yn(e,540715);const o=[cn(e,t,62,n)];for(;540714!==(e.currentToken=vn(e));)i.push(e.tokenValue),yn(e,540715),o.push(cn(e,t,62,n));return i.push(e.tokenValue),e.assignable=!1,s?(dn(e),new Y(i,i,r,o)):(dn(e),new X(i,o))}function dn(e){for(;e.index<e.length;)if(e.startIndex=e.index,null!=(e.currentToken=En[e.currentChar](e)))return;e.currentToken=1572864}function pn(e){return e.currentChar=e.input.charCodeAt(++e.index)}function fn(e,t){let n=e.currentChar;if(!1===t){do{n=pn(e)}while(n<=57&&n>=48);if(46!==n)return e.tokenValue=parseInt(e.tokenRaw,10),8192;if(n=pn(e),e.index>=e.length)return e.tokenValue=parseInt(e.tokenRaw.slice(0,-1),10),8192}if(n<=57&&n>=48)do{n=pn(e)}while(n<=57&&n>=48);else e.currentChar=e.input.charCodeAt(--e.index);return e.tokenValue=parseFloat(e.tokenRaw),8192}function gn(e){let t=!0,n="";for(;96!==pn(e);)if(36===e.currentChar){if(e.index+1<e.length&&123===e.input.charCodeAt(e.index+1)){e.index++,t=!1;break}n+="$"}else if(92===e.currentChar)n+=String.fromCharCode(Jt(pn(e)));else{if(e.index>=e.length)throw new Error(`Unterminated template string: '${e.input}'`);n+=String.fromCharCode(e.currentChar)}return pn(e),e.tokenValue=n,t?540714:540715}function vn(e){if(e.index>=e.length)throw new Error(`Unterminated template string: '${e.input}'`);return e.index--,gn(e)}function bn(e,t){return e.currentToken===t&&(dn(e),!0)}function yn(e,t){if(e.currentToken!==t)throw new Error(`Missing expected token: '${e.input}'`);dn(e)}const mn=[Xt,Yt,en,tn,"$this","$host","$parent","(","{",".","}",")",",","[","]",":","?","'",'"',"&","|","||","&&","==","!=","===","!==","<",">","<=",">=","in","instanceof","+","-","typeof","void","*","%","/","=","!",540714,540715,"of"],wn=Object.create(null);wn.true=2049,wn.null=2050,wn.false=2048,wn.undefined=2051,wn.$this=3076,wn.$host=3077,wn.$parent=3078,wn.in=1640799,wn.instanceof=1640800,wn.typeof=34851,wn.void=34852,wn.of=1051180;const xn=[36,0,48,58,65,91,95,0,97,123],Cn=[36,0,65,91,95,0,97,123,170,0,186,0,192,215,216,247,248,697,736,741,7424,7462,7468,7517,7522,7526,7531,7544,7545,7615,7680,7936,8305,0,8319,0,8336,8349,8490,8492,8498,0,8526,0,8544,8585,11360,11392,42786,42888,42891,42927,42928,42936,42999,43008,43824,43867,43868,43877,64256,64263,65313,65339,65345,65371],kn=[48,58],On=[0,33,127,161];function Sn(e,t,n,r){const s=n.length;for(let i=0;i<s;i+=2){const s=n[i];let o=n[i+1];if(o=o>0?o:s+1,e&&e.fill(r,s,o),t)for(let e=s;e<o;e++)t.add(e)}}function Tn(e){return t=>(pn(t),e)}const $n=e=>{throw new Error(`Unexpected character: '${e.input}'`)};$n.notMapped=!0;Sn(null,new Set,xn,!0);const Ln=new Uint8Array(65535);Sn(Ln,null,Cn,1),Sn(Ln,null,kn,1);const En=new Array(65535);En.fill($n,0,65535),Sn(En,null,On,(e=>(pn(e),null))),Sn(En,null,Cn,(function(e){for(;Ln[pn(e)];);const t=wn[e.tokenValue=e.tokenRaw];return void 0===t?1024:t})),Sn(En,null,kn,(e=>fn(e,!1))),En[34]=En[39]=e=>function(e){const t=e.currentChar;pn(e);let n=0;const r=new Array;let s=e.index;for(;e.currentChar!==t;)if(92===e.currentChar)r.push(e.input.slice(s,e.index)),pn(e),n=Jt(e.currentChar),pn(e),r.push(String.fromCharCode(n)),s=e.index;else{if(e.index>=e.length)throw new Error(`Unterminated quote in string literal: '${e.input}'`);pn(e)}const i=e.input.slice(s,e.index);pn(e),r.push(i);const o=r.join("");return e.tokenValue=o,4096}(e),En[96]=e=>gn(e),En[33]=e=>61!==pn(e)?32809:61!==pn(e)?1638680:(pn(e),1638682),En[61]=e=>61!==pn(e)?1048616:61!==pn(e)?1638679:(pn(e),1638681),En[38]=e=>38!==pn(e)?1572883:(pn(e),1638614),En[124]=e=>124!==pn(e)?1572884:(pn(e),1638549),En[46]=e=>pn(e)<=57&&e.currentChar>=48?fn(e,!0):16393,En[60]=e=>61!==pn(e)?1638747:(pn(e),1638749),En[62]=e=>61!==pn(e)?1638748:(pn(e),1638750),En[37]=Tn(1638886),En[40]=Tn(671751),En[41]=Tn(1835019),En[42]=Tn(1638885),En[43]=Tn(623009),En[44]=Tn(1572876),En[45]=Tn(623010),En[47]=Tn(1638887),En[58]=Tn(1572879),En[63]=Tn(1572880),En[91]=Tn(671757),En[93]=Tn(1835022),En[123]=Tn(131080),En[125]=Tn(1835018);let An=null;const Un=[];let Bn=!1;function In(){return An}function jn(e){if(null==e)throw new Error("Connectable cannot be null/undefined");if(null==An)return An=e,Un[0]=An,void(Bn=!0);if(An===e)throw new Error("Trying to enter an active connectable");Un.push(An),An=e,Bn=!0}function Vn(e){if(null==e)throw new Error("Connectable cannot be null/undefined");if(An!==e)throw new Error("Trying to exit an unactive connectable");Un.pop(),An=Un.length>0?Un[Un.length-1]:null,Bn=null!=An}const Pn=Object.freeze({get current(){return An},get connecting(){return Bn},enter:jn,exit:Vn,pause:function(){Bn=!1},resume:function(){Bn=!0}}),Mn=Reflect.get,_n=Object.prototype.toString,Fn=new WeakMap;function Kn(e){switch(_n.call(e)){case"[object Object]":case"[object Array]":case"[object Map]":case"[object Set]":return!0;default:return!1}}const Dn="__raw__";function qn(e){return Kn(e)?Nn(e):e}function Nn(e){var t;return null!==(t=Fn.get(e))&&void 0!==t?t:function(e){const t=e instanceof Array?Wn:e instanceof Map||e instanceof Set?br:Qn,n=new Proxy(e,t);return Fn.set(e,n),n}(e)}function Rn(e){var t;return null!==(t=e.__raw__)&&void 0!==t?t:e}function Hn(e){return Kn(e)&&e.__raw__||e}function zn(e){return"constructor"===e||"__proto__"===e||"$observers"===e||e===Symbol.toPrimitive||e===Symbol.toStringTag}const Qn={get(e,t,n){if(t===Dn)return e;const r=In();return!Bn||zn(t)||null==r?Mn(e,t,n):(r.observeProperty(e,t),qn(Mn(e,t,n)))}},Wn={get(e,t,n){if(t===Dn)return e;const r=In();if(!Bn||zn(t)||null==r)return Mn(e,t,n);switch(t){case"length":return r.observeProperty(e,"length"),e.length;case"map":return Gn;case"includes":return Xn;case"indexOf":return Yn;case"lastIndexOf":return er;case"every":return Zn;case"filter":return Jn;case"find":return nr;case"findIndex":return tr;case"flat":return rr;case"flatMap":return sr;case"join":return ir;case"push":return ar;case"pop":return or;case"reduce":return gr;case"reduceRight":return vr;case"reverse":return hr;case"shift":return ur;case"unshift":return lr;case"slice":return fr;case"splice":return cr;case"some":return dr;case"sort":return pr;case"keys":return Sr;case"values":case Symbol.iterator:return Tr;case"entries":return $r}return r.observeProperty(e,t),qn(Mn(e,t,n))},ownKeys(e){var t;return null===(t=In())||void 0===t||t.observeProperty(e,"length"),Reflect.ownKeys(e)}};function Gn(e,t){var n;const r=Rn(this),s=r.map(((n,r)=>Hn(e.call(t,qn(n),r,this))));return null===(n=In())||void 0===n||n.observeCollection(r),qn(s)}function Zn(e,t){var n;const r=Rn(this),s=r.every(((n,r)=>e.call(t,qn(n),r,this)));return null===(n=In())||void 0===n||n.observeCollection(r),s}function Jn(e,t){var n;const r=Rn(this),s=r.filter(((n,r)=>Hn(e.call(t,qn(n),r,this))));return null===(n=In())||void 0===n||n.observeCollection(r),qn(s)}function Xn(e){var t;const n=Rn(this),r=n.includes(Hn(e));return null===(t=In())||void 0===t||t.observeCollection(n),r}function Yn(e){var t;const n=Rn(this),r=n.indexOf(Hn(e));return null===(t=In())||void 0===t||t.observeCollection(n),r}function er(e){var t;const n=Rn(this),r=n.lastIndexOf(Hn(e));return null===(t=In())||void 0===t||t.observeCollection(n),r}function tr(e,t){var n;const r=Rn(this),s=r.findIndex(((n,r)=>Hn(e.call(t,qn(n),r,this))));return null===(n=In())||void 0===n||n.observeCollection(r),s}function nr(e,t){var n;const r=Rn(this),s=r.find(((t,n)=>e(qn(t),n,this)),t);return null===(n=In())||void 0===n||n.observeCollection(r),qn(s)}function rr(){var e;const t=Rn(this);return null===(e=In())||void 0===e||e.observeCollection(t),qn(t.flat())}function sr(e,t){var n;const r=Rn(this);return null===(n=In())||void 0===n||n.observeCollection(r),Nn(r.flatMap(((n,r)=>qn(e.call(t,qn(n),r,this)))))}function ir(e){var t;const n=Rn(this);return null===(t=In())||void 0===t||t.observeCollection(n),n.join(e)}function or(){return qn(Rn(this).pop())}function ar(...e){return Rn(this).push(...e)}function ur(){return qn(Rn(this).shift())}function lr(...e){return Rn(this).unshift(...e)}function cr(...e){return qn(Rn(this).splice(...e))}function hr(...e){var t;const n=Rn(this),r=n.reverse();return null===(t=In())||void 0===t||t.observeCollection(n),qn(r)}function dr(e,t){var n;const r=Rn(this),s=r.some(((n,r)=>Hn(e.call(t,qn(n),r,this))));return null===(n=In())||void 0===n||n.observeCollection(r),s}function pr(e){var t;const n=Rn(this),r=n.sort(e);return null===(t=In())||void 0===t||t.observeCollection(n),qn(r)}function fr(e,t){var n;const r=Rn(this);return null===(n=In())||void 0===n||n.observeCollection(r),Nn(r.slice(e,t))}function gr(e,t){var n;const r=Rn(this),s=r.reduce(((t,n,r)=>e(t,qn(n),r,this)),t);return null===(n=In())||void 0===n||n.observeCollection(r),qn(s)}function vr(e,t){var n;const r=Rn(this),s=r.reduceRight(((t,n,r)=>e(t,qn(n),r,this)),t);return null===(n=In())||void 0===n||n.observeCollection(r),qn(s)}const br={get(e,t,n){if(t===Dn)return e;const r=In();if(!Bn||zn(t)||null==r)return Mn(e,t,n);switch(t){case"size":return r.observeProperty(e,"size"),e.size;case"clear":return kr;case"delete":return Or;case"forEach":return yr;case"add":if(e instanceof Set)return Cr;break;case"get":if(e instanceof Map)return wr;break;case"set":if(e instanceof Map)return xr;break;case"has":return mr;case"keys":return Sr;case"values":return Tr;case"entries":return $r;case Symbol.iterator:return e instanceof Map?$r:Tr}return qn(Mn(e,t,n))}};function yr(e,t){var n;const r=Rn(this);return null===(n=In())||void 0===n||n.observeCollection(r),r.forEach(((n,r)=>{e.call(t,qn(n),qn(r),this)}))}function mr(e){var t;const n=Rn(this);return null===(t=In())||void 0===t||t.observeCollection(n),n.has(Hn(e))}function wr(e){var t;const n=Rn(this);return null===(t=In())||void 0===t||t.observeCollection(n),qn(n.get(Hn(e)))}function xr(e,t){return qn(Rn(this).set(Hn(e),Hn(t)))}function Cr(e){return qn(Rn(this).add(Hn(e)))}function kr(){return qn(Rn(this).clear())}function Or(e){return qn(Rn(this).delete(Hn(e)))}function Sr(){var e;const t=Rn(this);null===(e=In())||void 0===e||e.observeCollection(t);const n=t.keys();return{next(){const e=n.next(),t=e.done;return t?{value:void 0,done:t}:{value:qn(e.value),done:t}},[Symbol.iterator](){return this}}}function Tr(){var e;const t=Rn(this);null===(e=In())||void 0===e||e.observeCollection(t);const n=t.values();return{next(){const e=n.next(),t=e.done;return t?{value:void 0,done:t}:{value:qn(e.value),done:t}},[Symbol.iterator](){return this}}}function $r(){var e;const t=Rn(this);null===(e=In())||void 0===e||e.observeCollection(t);const n=t.entries();return{next(){const e=n.next(),t=e.value,r=e.done;return r?{value:void 0,done:r}:{value:[qn(t[0]),qn(t[1])],done:r}},[Symbol.iterator](){return this}}}const Lr=Object.freeze({getProxy:Nn,getRaw:Rn,wrap:qn,unwrap:Hn,rawKey:Dn});class Er{constructor(e,t,n,r,s){this.obj=e,this.get=t,this.set=n,this.useProxy=r,this.observerLocator=s,this.interceptor=this,this.type=1,this.value=void 0,this.oldValue=void 0,this.running=!1,this.isDirty=!1}static create(e,t,n,r,s){const i=new Er(e,n.get,n.set,s,r),o=()=>i.getValue();return o.getObserver=()=>i,ue(e,t,{enumerable:n.enumerable,configurable:!0,get:o,set:e=>{i.setValue(e,0)}}),i}getValue(){return 0===this.subs.count?this.get.call(this.obj,this):(this.isDirty&&(this.compute(),this.isDirty=!1),this.value)}setValue(e,t){if("function"!=typeof this.set)throw new Error("Property is readonly");e!==this.value&&(this.running=!0,this.set.call(this.obj,e),this.running=!1,this.run())}handleChange(){this.isDirty=!0,this.subs.count>0&&this.run()}handleCollectionChange(){this.isDirty=!0,this.subs.count>0&&this.run()}subscribe(e){this.subs.add(e)&&1===this.subs.count&&(this.compute(),this.isDirty=!1)}unsubscribe(e){this.subs.remove(e)&&0===this.subs.count&&(this.isDirty=!0,this.obs.clear(!0))}flush(){Ar=this.oldValue,this.oldValue=this.value,this.subs.notify(this.value,Ar,0)}run(){if(this.running)return;const e=this.value,t=this.compute();this.isDirty=!1,Object.is(t,e)||(this.oldValue=e,this.queue.add(this))}compute(){this.running=!0,this.obs.version++;try{return jn(this),this.value=Hn(this.get.call(this.useProxy?qn(this.obj):this.obj,this))}finally{this.obs.clear(!1),this.running=!1,Vn(this)}}}let Ar;Nt(Er),xe(Er),$e(Er);const Ur=r.createInterface("IDirtyChecker",(e=>e.singleton(jr))),Br={timeoutsPerCheck:25,disabled:!1,throw:!1,resetToDefault(){this.timeoutsPerCheck=6,this.disabled=!1,this.throw=!1}},Ir={persistent:!0};class jr{constructor(e){this.platform=e,this.tracked=[],this.task=null,this.elapsedFrames=0,this.check=()=>{if(Br.disabled)return;if(++this.elapsedFrames<Br.timeoutsPerCheck)return;this.elapsedFrames=0;const e=this.tracked,t=e.length;let n,r=0;for(;r<t;++r)n=e[r],n.isDirty()&&this.queue.add(n)}}createProperty(e,t){if(Br.throw)throw new Error(`Property '${t}' is being dirty-checked.`);return new Vr(this,e,t)}addProperty(e){this.tracked.push(e),1===this.tracked.length&&(this.task=this.platform.taskQueue.queueTask(this.check,Ir))}removeProperty(e){this.tracked.splice(this.tracked.indexOf(e),1),0===this.tracked.length&&(this.task.cancel(),this.task=null)}}jr.inject=[h],$e(jr);class Vr{constructor(e,t,n){this.dirtyChecker=e,this.obj=t,this.propertyKey=n,this.oldValue=void 0,this.type=0}getValue(){return this.obj[this.propertyKey]}setValue(e,t){throw new Error(`Trying to set value for property ${this.propertyKey} in dirty checker`)}isDirty(){return this.oldValue!==this.obj[this.propertyKey]}flush(){const e=this.oldValue,t=this.getValue();this.oldValue=t,this.subs.notify(t,e,0)}subscribe(e){this.subs.add(e)&&1===this.subs.count&&(this.oldValue=this.obj[this.propertyKey],this.dirtyChecker.addProperty(this))}unsubscribe(e){this.subs.remove(e)&&0===this.subs.count&&this.dirtyChecker.removeProperty(this)}}xe(Vr);class Pr{constructor(e,t){this.obj=e,this.propertyKey=t,this.type=0}get doNotCache(){return!0}getValue(){return this.obj[this.propertyKey]}setValue(){}subscribe(){}unsubscribe(){}}class Mr{constructor(){this.type=0}getValue(e,t){return e[t]}setValue(e,t,n,r){n[r]=e}}let _r;class Fr{constructor(e,t){this.obj=e,this.propertyKey=t,this.value=void 0,this.oldValue=void 0,this.observing=!1,this.type=1,this.f=0}getValue(){return this.value}setValue(e,t){if(this.observing){const n=this.value;if(Object.is(e,n))return;this.value=e,this.oldValue=n,this.f=t,this.queue.add(this)}else this.obj[this.propertyKey]=e}subscribe(e){!1===this.observing&&this.start(),this.subs.add(e)}flush(){_r=this.oldValue,this.oldValue=this.value,this.subs.notify(this.value,_r,this.f)}start(){return!1===this.observing&&(this.observing=!0,this.value=this.obj[this.propertyKey],ue(this.obj,this.propertyKey,{enumerable:!0,configurable:!0,get:()=>this.getValue(),set:e=>{this.setValue(e,0)}})),this}stop(){return this.observing&&(ue(this.obj,this.propertyKey,{enumerable:!0,configurable:!0,writable:!0,value:this.value}),this.observing=!1),this}}class Kr{constructor(e,t,n,r){this.type=1,this.v=void 0,this.oV=void 0,this.f=0,this.obj=e,this.s=n;const s=e[t];this.cb="function"==typeof s?s:void 0,this.v=r}getValue(){return this.v}setValue(e,t){var n;"function"==typeof this.s&&(e=this.s(e)),Object.is(e,this.v)||(this.oV=this.v,this.v=e,this.f=t,null===(n=this.cb)||void 0===n||n.call(this.obj,this.v,this.oV,t),this.queue.add(this))}flush(){_r=this.oV,this.oV=this.v,this.subs.notify(this.v,_r,this.f)}}xe(Fr),xe(Kr),$e(Fr),$e(Kr);const Dr=new Mr,qr=r.createInterface("IObserverLocator",(e=>e.singleton(Hr))),Nr=r.createInterface("INodeObserverLocator",(e=>e.cachedCallback((e=>(e.getAll(d).forEach((e=>{e.error("Using default INodeObserverLocator implementation. Will not be able to observe nodes (HTML etc...).")})),new Rr)))));class Rr{handles(){return!1}getObserver(){return Dr}getAccessor(){return Dr}}class Hr{constructor(e,t){this.dirtyChecker=e,this.nodeObserverLocator=t,this.adapters=[]}addAdapter(e){this.adapters.push(e)}getObserver(e,t){var n,r;return null!==(r=null===(n=e.$observers)||void 0===n?void 0:n[t])&&void 0!==r?r:this.cache(e,t,this.createObserver(e,t))}getAccessor(e,t){var n;const r=null===(n=e.$observers)||void 0===n?void 0:n[t];return void 0!==r?r:this.nodeObserverLocator.handles(e,t,this)?this.nodeObserverLocator.getAccessor(e,t,this):Dr}getArrayObserver(e){return st(e)}getMapObserver(e){return jt(e)}getSetObserver(e){return wt(e)}createObserver(e,t){var n,r,s,i;if(!(e instanceof Object))return new Pr(e,t);if(this.nodeObserverLocator.handles(e,t,this))return this.nodeObserverLocator.getObserver(e,t,this);switch(t){case"length":if(e instanceof Array)return st(e).getLengthObserver();break;case"size":if(e instanceof Map)return jt(e).getLengthObserver();if(e instanceof Set)return wt(e).getLengthObserver();break;default:if(e instanceof Array&&c(t))return st(e).getIndexObserver(Number(t))}let o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){let n=Object.getPrototypeOf(e);for(;null!==n&&(o=Object.getOwnPropertyDescriptor(n,t),void 0===o);)n=Object.getPrototypeOf(n)}if(void 0!==o&&!Object.prototype.hasOwnProperty.call(o,"value")){let a=this.getAdapterObserver(e,t,o);return null==a&&(a=null===(i=null!==(r=null===(n=o.get)||void 0===n?void 0:n.getObserver)&&void 0!==r?r:null===(s=o.set)||void 0===s?void 0:s.getObserver)||void 0===i?void 0:i(e,this)),null==a?o.configurable?Er.create(e,t,o,this,!0):this.dirtyChecker.createProperty(e,t):a}return new Fr(e,t)}getAdapterObserver(e,t,n){if(this.adapters.length>0)for(const r of this.adapters){const s=r.getObserver(e,t,n,this);if(null!=s)return s}return null}cache(e,t,n){return!0===n.doNotCache?n:void 0===e.$observers?(ue(e,"$observers",{value:{[t]:n}}),n):e.$observers[t]=n}}function zr(e){let t;return e instanceof Array?t=st(e):e instanceof Map?t=jt(e):e instanceof Set&&(t=wt(e)),t}Hr.inject=[Ur,Nr];const Qr=r.createInterface("IObservation",(e=>e.singleton(Wr)));class Wr{constructor(e){this.observerLocator=e}static get inject(){return[qr]}run(e){const t=new Gr(this.observerLocator,e);return t.run(),t}}class Gr{constructor(e,t){this.observerLocator=e,this.fn=t,this.interceptor=this,this.maxRunCount=10,this.queued=!1,this.running=!1,this.runCount=0,this.stopped=!1}handleChange(){this.queued=!0,this.run()}handleCollectionChange(){this.queued=!0,this.run()}run(){if(this.stopped)throw new Error("Effect has already been stopped");if(!this.running){++this.runCount,this.running=!0,this.queued=!1,++this.obs.version;try{jn(this),this.fn(this)}finally{this.obs.clear(!1),this.running=!1,Vn(this)}if(this.queued){if(this.runCount>this.maxRunCount)throw this.runCount=0,new Error("Maximum number of recursive effect run reached. Consider handle effect dependencies differently.");this.run()}else this.runCount=0}}stop(){this.stopped=!0,this.obs.clear(!0)}}Nt(Gr);const Zr={};function Jr(e,t,n){return null==t?(t,n,s)=>r(t,n,s,e):r(e,t,n);function r(e,t,n,r){var s;const i=void 0===t;if(r="object"!=typeof r?{name:r}:r||{},i&&(t=r.name),null==t||""===t)throw new Error("Invalid usage, cannot determine property name for @observable");const o=r.callback||`${String(t)}Changed`;let a=Zr;n?(delete n.value,delete n.writable,a=null===(s=n.initializer)||void 0===s?void 0:s.call(n),delete n.initializer):n={configurable:!0},"enumerable"in n||(n.enumerable=!0);const u=r.set;if(n.get=function(){var e;const n=Xr(this,t,o,a,u);return null===(e=In())||void 0===e||e.subscribeTo(n),n.getValue()},n.set=function(e){Xr(this,t,o,a,u).setValue(e,0)},n.get.getObserver=function(e){return Xr(e,t,o,a,u)},!i)return n;ue(e.prototype,t,n)}}function Xr(e,t,n,r,s){const i=function(e){return void 0===e.$observers&&ue(e,"$observers",{value:{}}),e.$observers}(e);let o=i[t];return null==o&&(o=new Kr(e,n,s,r===Zr?void 0:r),i[t]=o),o}export{Wt as Access,q as AccessKeyedExpression,D as AccessMemberExpression,K as AccessScopeExpression,F as AccessThisExpression,ve as AccessorType,ee as ArrayBindingPattern,rt as ArrayIndexObserver,Z as ArrayLiteralExpression,nt as ArrayObserver,M as AssignExpression,z as BinaryExpression,$ as BindingBehavior,O as BindingBehaviorDefinition,V as BindingBehaviorExpression,S as BindingBehaviorFactory,C as BindingBehaviorStrategy,v as BindingContext,ne as BindingIdentifier,T as BindingInterceptor,Rt as BindingMediator,he as BindingMode,Dt as BindingObserverRecord,on as BindingType,H as CallFunctionExpression,R as CallMemberExpression,N as CallScopeExpression,Qt as Char,ge as CollectionKind,Ue as CollectionLengthObserver,Be as CollectionSizeObserver,Er as ComputedObserver,_ as ConditionalExpression,Pn as ConnectableSwitcher,j as CustomExpression,fe as DelegationStrategy,Vr as DirtyCheckProperty,Br as DirtyCheckSettings,U as ExpressionKind,Ee as FlushQueue,se as ForOfStatement,G as HtmlLiteralExpression,Ur as IDirtyChecker,Ht as IExpressionParser,Nr as INodeObserverLocator,Qr as IObservation,qr as IObserverLocator,w as ISignaler,ie as Interpolation,de as LifecycleFlags,It as MapObserver,te as ObjectBindingPattern,J as ObjectLiteralExpression,Wr as Observation,Hr as ObserverLocator,m as OverrideContext,an as ParserState,Gt as Precedence,W as PrimitiveLiteralExpression,Pr as PrimitiveObserver,Mr as PropertyAccessor,Lr as ProxyObservable,y as Scope,mt as SetObserver,Fr as SetterObserver,ke as SubscriberRecord,Y as TaggedTemplateExpression,X as TemplateExpression,Q as UnaryExpression,A as ValueConverter,E as ValueConverterDefinition,P as ValueConverterExpression,p as alias,it as applyMutationsToIndices,k as bindingBehavior,me as cloneIndexMap,Nt as connectable,be as copyIndexMap,ye as createIndexMap,tt as disableArrayObservation,Bt as disableMapObservation,yt as disableSetObservation,et as enableArrayObservation,Ut as enableMapObservation,bt as enableSetObservation,zr as getCollectionObserver,we as isIndexMap,Jr as observable,cn as parse,ln as parseExpression,f as registerAliases,xe as subscriberCollection,ot as synchronizeIndices,L as valueConverter,$e as withFlushQueue};
