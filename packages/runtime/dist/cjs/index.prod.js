Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@aurelia/kernel"),t=require("@aurelia/platform");function r(t,r,n,s){for(let i=0,o=t.length;i<o;++i)e.Registration.aliasTo(n,r.keyFrom(t[i])).register(s)}const n=Object.freeze({});class s{constructor(e,t){if(void 0!==e)if(void 0!==t)this[e]=t;else for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this[t]=e[t])}static create(e,t){return new s(e,t)}static get(e,t,r,s,o){if(null==e&&null==o)throw new Error(`Scope is ${e} and HostScope is ${o}.`);const a=o!==e&&null!=o;let u=i(e,t,r,null);return null!==u&&(null!=u&&t in u||!a)||a&&(u=i(o,t,r,e),null!=u&&t in u)?u:16&s?n:e.bindingContext||e.overrideContext}}function i(e,t,r,n){var s,i;let o=e.overrideContext,a=e;if(r>0){for(;r>0;)if(r--,a=a.parentScope,null==(null==a?void 0:a.overrideContext))return;return o=a.overrideContext,t in o?o:o.bindingContext}for(;(!(null==a?void 0:a.isBoundary)||null!==n&&n!==a)&&o&&!(t in o)&&(!o.bindingContext||!(t in o.bindingContext));)a=null!==(s=a.parentScope)&&void 0!==s?s:null,o=null!==(i=null==a?void 0:a.overrideContext)&&void 0!==i?i:null;return o?t in o?o:o.bindingContext:null}class o{constructor(e,t,r,n){this.parentScope=e,this.bindingContext=t,this.overrideContext=r,this.isBoundary=n}static create(e,t,r){return new o(null,e,null==t?a.create(e):t,null!=r&&r)}static fromOverride(e){if(null==e)throw new Error(`OverrideContext is ${e}`);return new o(null,e.bindingContext,e,!1)}static fromParent(e,t){if(null==e)throw new Error(`ParentScope is ${e}`);return new o(e,t,a.create(t),!1)}}class a{constructor(e){this.bindingContext=e}static create(e){return new a(e)}}const u=e.DI.createInterface("ISignaler",(e=>e.singleton(c)));class c{constructor(){this.signals=Object.create(null)}dispatchSignal(e,t){const r=this.signals[e];if(void 0!==r)for(const e of r.keys())e.handleChange(void 0,void 0,t)}addSignalListener(e,t){const r=this.signals,n=r[e];void 0===n?r[e]=new Set([t]):n.add(t)}removeSignalListener(e,t){const r=this.signals[e];r&&r.delete(t)}}var l;exports.BindingBehaviorStrategy=void 0,(l=exports.BindingBehaviorStrategy||(exports.BindingBehaviorStrategy={}))[l.singleton=1]="singleton",l[l.interceptor=2]="interceptor";class h{constructor(e,t,r,n,s){this.Type=e,this.name=t,this.aliases=r,this.key=n,this.strategy=s}static create(t,r){let n,s;"string"==typeof t?(n=t,s={name:n}):(n=t.name,s=t);const i=Object.getPrototypeOf(r)===p;return new h(r,e.firstDefined(f.getAnnotation(r,"name"),n),e.mergeArrays(f.getAnnotation(r,"aliases"),s.aliases,r.aliases),f.keyFrom(n),e.fromAnnotationOrDefinitionOrTypeOrDefault("strategy",s,r,(()=>i?2:1)))}register(t){const{Type:n,key:s,aliases:i,strategy:o}=this;switch(o){case 1:e.Registration.singleton(s,n).register(t);break;case 2:e.Registration.instance(s,new d(t,n)).register(t)}e.Registration.aliasTo(s,n).register(t),r(i,f,s,t)}}class d{constructor(t,r){this.container=t,this.Type=r,this.deps=e.DI.getDependencies(r)}construct(e,t){const r=this.container,n=this.deps;switch(n.length){case 0:case 1:case 2:return new this.Type(e,t);case 3:return new this.Type(r.get(n[0]),e,t);case 4:return new this.Type(r.get(n[0]),r.get(n[1]),e,t);default:return new this.Type(...n.map((e=>r.get(e))),e,t)}}}class p{constructor(e,t){let r;for(this.binding=e,this.expr=t,this.interceptor=this;e.interceptor!==this;)r=e.interceptor,e.interceptor=this,e=r}get observerLocator(){return this.binding.observerLocator}get locator(){return this.binding.locator}get $scope(){return this.binding.$scope}get $hostScope(){return this.binding.$hostScope}get isBound(){return this.binding.isBound}get obs(){return this.binding.obs}get sourceExpression(){return this.binding.sourceExpression}updateTarget(e,t){this.binding.updateTarget(e,t)}updateSource(e,t){this.binding.updateSource(e,t)}callSource(e){return this.binding.callSource(e)}handleChange(e,t,r){this.binding.handleChange(e,t,r)}handleCollectionChange(e,t){this.binding.handleCollectionChange(e,t)}observeProperty(e,t){this.binding.observeProperty(e,t)}observeCollection(e){this.binding.observeCollection(e)}$bind(e,t,r){this.binding.$bind(e,t,r)}$unbind(e){this.binding.$unbind(e)}}const f={name:e.Protocol.resource.keyFor("binding-behavior"),keyFrom:e=>`${f.name}:${e}`,isType:t=>"function"==typeof t&&e.Metadata.hasOwn(f.name,t),define(t,r){const n=h.create(t,r);return e.Metadata.define(f.name,n,n.Type),e.Metadata.define(f.name,n,n),e.Protocol.resource.appendTo(r,f.name),n.Type},getDefinition(t){const r=e.Metadata.getOwn(f.name,t);if(void 0===r)throw new Error(`No definition found for type ${t.name}`);return r},annotate(t,r,n){e.Metadata.define(e.Protocol.annotation.keyFor(r),n,t)},getAnnotation:(t,r)=>e.Metadata.getOwn(e.Protocol.annotation.keyFor(r),t)};class g{constructor(e,t,r,n){this.Type=e,this.name=t,this.aliases=r,this.key=n}static create(t,r){let n,s;return"string"==typeof t?(n=t,s={name:n}):(n=t.name,s=t),new g(r,e.firstDefined(v.getAnnotation(r,"name"),n),e.mergeArrays(v.getAnnotation(r,"aliases"),s.aliases,r.aliases),v.keyFrom(n))}register(t){const{Type:n,key:s,aliases:i}=this;e.Registration.singleton(s,n).register(t),e.Registration.aliasTo(s,n).register(t),r(i,v,s,t)}}const v={name:e.Protocol.resource.keyFor("value-converter"),keyFrom:e=>`${v.name}:${e}`,isType:t=>"function"==typeof t&&e.Metadata.hasOwn(v.name,t),define(t,r){const n=g.create(t,r);return e.Metadata.define(v.name,n,n.Type),e.Metadata.define(v.name,n,n),e.Protocol.resource.appendTo(r,v.name),n.Type},getDefinition(t){const r=e.Metadata.getOwn(v.name,t);if(void 0===r)throw new Error(`No definition found for type ${t.name}`);return r},annotate(t,r,n){e.Metadata.define(e.Protocol.annotation.keyFor(r),n,t)},getAnnotation:(t,r)=>e.Metadata.getOwn(e.Protocol.annotation.keyFor(r),t)};var b;exports.ExpressionKind=void 0,(b=exports.ExpressionKind||(exports.ExpressionKind={}))[b.Connects=32]="Connects",b[b.Observes=64]="Observes",b[b.CallsFunction=128]="CallsFunction",b[b.HasAncestor=256]="HasAncestor",b[b.IsPrimary=512]="IsPrimary",b[b.IsLeftHandSide=1024]="IsLeftHandSide",b[b.HasBind=2048]="HasBind",b[b.HasUnbind=4096]="HasUnbind",b[b.IsAssignable=8192]="IsAssignable",b[b.IsLiteral=16384]="IsLiteral",b[b.IsResource=32768]="IsResource",b[b.IsForDeclaration=65536]="IsForDeclaration",b[b.Type=31]="Type",b[b.AccessThis=1793]="AccessThis",b[b.AccessScope=10082]="AccessScope",b[b.ArrayLiteral=17955]="ArrayLiteral",b[b.ObjectLiteral=17956]="ObjectLiteral",b[b.PrimitiveLiteral=17925]="PrimitiveLiteral",b[b.Template=17958]="Template",b[b.Unary=39]="Unary",b[b.CallScope=1448]="CallScope",b[b.CallMember=1161]="CallMember",b[b.CallFunction=1162]="CallFunction",b[b.AccessMember=9323]="AccessMember",b[b.AccessKeyed=9324]="AccessKeyed",b[b.TaggedTemplate=1197]="TaggedTemplate",b[b.Binary=46]="Binary",b[b.Conditional=63]="Conditional",b[b.Assign=8208]="Assign",b[b.ValueConverter=36913]="ValueConverter",b[b.BindingBehavior=38962]="BindingBehavior",b[b.HtmlLiteral=51]="HtmlLiteral",b[b.ArrayBindingPattern=65556]="ArrayBindingPattern",b[b.ObjectBindingPattern=65557]="ObjectBindingPattern",b[b.BindingIdentifier=65558]="BindingIdentifier",b[b.ForOfStatement=6199]="ForOfStatement",b[b.Interpolation=24]="Interpolation";class y{constructor(){this.text=""}static unparse(e){const t=new y;return e.accept(t),t.text}visitAccessMember(e){e.object.accept(this),this.text+=`.${e.name}`}visitAccessKeyed(e){e.object.accept(this),this.text+="[",e.key.accept(this),this.text+="]"}visitAccessThis(e){if(0===e.ancestor)return void(this.text+="$this");this.text+="$parent";let t=e.ancestor-1;for(;t--;)this.text+=".$parent"}visitAccessScope(e){let t=e.ancestor;for(;t--;)this.text+="$parent.";this.text+=e.name}visitArrayLiteral(e){const t=e.elements;this.text+="[";for(let e=0,r=t.length;e<r;++e)0!==e&&(this.text+=","),t[e].accept(this);this.text+="]"}visitObjectLiteral(e){const t=e.keys,r=e.values;this.text+="{";for(let e=0,n=t.length;e<n;++e)0!==e&&(this.text+=","),this.text+=`'${t[e]}':`,r[e].accept(this);this.text+="}"}visitPrimitiveLiteral(e){if(this.text+="(","string"==typeof e.value){const t=e.value.replace(/'/g,"\\'");this.text+=`'${t}'`}else this.text+=`${e.value}`;this.text+=")"}visitCallFunction(e){this.text+="(",e.func.accept(this),this.writeArgs(e.args),this.text+=")"}visitCallMember(e){this.text+="(",e.object.accept(this),this.text+=`.${e.name}`,this.writeArgs(e.args),this.text+=")"}visitCallScope(e){this.text+="(";let t=e.ancestor;for(;t--;)this.text+="$parent.";this.text+=e.name,this.writeArgs(e.args),this.text+=")"}visitTemplate(e){const{cooked:t,expressions:r}=e,n=r.length;this.text+="`",this.text+=t[0];for(let e=0;e<n;e++)r[e].accept(this),this.text+=t[e+1];this.text+="`"}visitTaggedTemplate(e){const{cooked:t,expressions:r}=e,n=r.length;e.func.accept(this),this.text+="`",this.text+=t[0];for(let e=0;e<n;e++)r[e].accept(this),this.text+=t[e+1];this.text+="`"}visitUnary(e){this.text+=`(${e.operation}`,e.operation.charCodeAt(0)>=97&&(this.text+=" "),e.expression.accept(this),this.text+=")"}visitBinary(e){this.text+="(",e.left.accept(this),105===e.operation.charCodeAt(0)?this.text+=` ${e.operation} `:this.text+=e.operation,e.right.accept(this),this.text+=")"}visitConditional(e){this.text+="(",e.condition.accept(this),this.text+="?",e.yes.accept(this),this.text+=":",e.no.accept(this),this.text+=")"}visitAssign(e){this.text+="(",e.target.accept(this),this.text+="=",e.value.accept(this),this.text+=")"}visitValueConverter(e){const t=e.args;e.expression.accept(this),this.text+=`|${e.name}`;for(let e=0,r=t.length;e<r;++e)this.text+=":",t[e].accept(this)}visitBindingBehavior(e){const t=e.args;e.expression.accept(this),this.text+=`&${e.name}`;for(let e=0,r=t.length;e<r;++e)this.text+=":",t[e].accept(this)}visitArrayBindingPattern(e){const t=e.elements;this.text+="[";for(let e=0,r=t.length;e<r;++e)0!==e&&(this.text+=","),t[e].accept(this);this.text+="]"}visitObjectBindingPattern(e){const t=e.keys,r=e.values;this.text+="{";for(let e=0,n=t.length;e<n;++e)0!==e&&(this.text+=","),this.text+=`'${t[e]}':`,r[e].accept(this);this.text+="}"}visitBindingIdentifier(e){this.text+=e.name}visitHtmlLiteral(e){throw new Error("visitHtmlLiteral")}visitForOfStatement(e){e.declaration.accept(this),this.text+=" of ",e.iterable.accept(this)}visitInterpolation(e){const{parts:t,expressions:r}=e,n=r.length;this.text+="${",this.text+=t[0];for(let e=0;e<n;e++)r[e].accept(this),this.text+=t[e+1];this.text+="}"}writeArgs(e){this.text+="(";for(let t=0,r=e.length;t<r;++t)0!==t&&(this.text+=","),e[t].accept(this);this.text+=")"}}function x(e,t,r){if(e){if(null==r)throw new Error("Host scope is missing. Are you using `$host` outside the `au-slot`? Or missing the `au-slot` attribute?");return r}return t}class m{constructor(e){this.value=e}evaluate(e,t,r,n,s){return this.value}}class w{constructor(e,t,r){this.expression=e,this.name=t,this.args=r,this.behaviorKey=f.keyFrom(t)}get $kind(){return 38962}get hasBind(){return!0}get hasUnbind(){return!0}evaluate(e,t,r,n,s){return this.expression.evaluate(e,t,r,n,s)}assign(e,t,r,n,s){return this.expression.assign(e,t,r,n,s)}bind(e,t,r,n){this.expression.hasBind&&this.expression.bind(e,t,r,n);const s=n.locator.get(this.behaviorKey);if(null==s)throw new Error(`BindingBehavior named '${this.name}' could not be found. Did you forget to register it as a dependency?`);if(!(s instanceof d)){if(void 0!==n[this.behaviorKey])throw new Error(`BindingBehavior named '${this.name}' already applied.`);n[this.behaviorKey]=s,s.bind.call(s,e,t,r,n,...this.args.map((s=>s.evaluate(e,t,r,n.locator,null))))}}unbind(e,t,r,n){const s=this.behaviorKey,i=n;void 0!==i[s]&&("function"==typeof i[s].unbind&&i[s].unbind(e,t,r,n),i[s]=void 0),this.expression.hasUnbind&&this.expression.unbind(e,t,r,n)}accept(e){return e.visitBindingBehavior(this)}toString(){return y.unparse(this)}}class C{constructor(e,t,r){this.expression=e,this.name=t,this.args=r,this.converterKey=v.keyFrom(t)}get $kind(){return 36913}get hasBind(){return!1}get hasUnbind(){return!0}evaluate(e,t,r,n,s){const i=n.get(this.converterKey);if(null==i)throw new Error(`ValueConverter named '${this.name}' could not be found. Did you forget to register it as a dependency?`);if(null!==s&&"handleChange"in s){const e=i.signals;if(null!=e){const t=n.get(u);for(let r=0,n=e.length;r<n;++r)t.addSignalListener(e[r],s)}}return"toView"in i?i.toView(this.expression.evaluate(e,t,r,n,s),...this.args.map((i=>i.evaluate(e,t,r,n,s)))):this.expression.evaluate(e,t,r,n,s)}assign(e,t,r,n,s){const i=n.get(this.converterKey);if(null==i)throw new Error(`ValueConverter named '${this.name}' could not be found. Did you forget to register it as a dependency?`);return"fromView"in i&&(s=i.fromView(s,...this.args.map((s=>s.evaluate(e,t,r,n,null))))),this.expression.assign(e,t,r,n,s)}unbind(e,t,r,n){const s=n.locator.get(this.converterKey);if(void 0===s.signals)return;const i=n.locator.get(u);for(let e=0;e<s.signals.length;++e)i.removeSignalListener(s.signals[e],n)}accept(e){return e.visitValueConverter(this)}toString(){return y.unparse(this)}}class k{constructor(e,t){this.target=e,this.value=t}get $kind(){return 8208}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){return this.target.assign(e,t,r,n,this.value.evaluate(e,t,r,n,s))}assign(e,t,r,n,s){return this.value.assign(e,t,r,n,s),this.target.assign(e,t,r,n,s)}accept(e){return e.visitAssign(this)}toString(){return y.unparse(this)}}class O{constructor(e,t,r){this.condition=e,this.yes=t,this.no=r}get $kind(){return 63}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){return this.condition.evaluate(e,t,r,n,s)?this.yes.evaluate(e,t,r,n,s):this.no.evaluate(e,t,r,n,s)}assign(e,t,r,n,s){}accept(e){return e.visitConditional(this)}toString(){return y.unparse(this)}}class S{constructor(e=0){this.ancestor=e}get $kind(){return 1793}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){var i;this===S.$host&&(t=x(!0,t,r));let o=t.overrideContext,a=t,u=this.ancestor;for(;u--&&o;)a=a.parentScope,o=null!==(i=null==a?void 0:a.overrideContext)&&void 0!==i?i:null;return u<1&&o?o.bindingContext:void 0}assign(e,t,r,n,s){}accept(e){return e.visitAccessThis(this)}toString(){return y.unparse(this)}}S.$this=new S(0),S.$host=new S(0),S.$parent=new S(1);class T{constructor(e,t=0,r=!1){this.name=e,this.ancestor=t,this.accessHostScope=r}get $kind(){return 10082}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,i){const o=s.get(x(this.accessHostScope,t,r),this.name,this.ancestor,e,r);null!==i&&i.observeProperty(o,this.name);const a=o[this.name];return 1&e?a:null==a?"":a}assign(e,t,r,n,i){var o;const a=s.get(x(this.accessHostScope,t,r),this.name,this.ancestor,e,r);if(a instanceof Object)return void 0!==(null===(o=a.$observers)||void 0===o?void 0:o[this.name])?(a.$observers[this.name].setValue(i,e),i):a[this.name]=i}accept(e){return e.visitAccessScope(this)}toString(){return y.unparse(this)}}class L{constructor(e,t){this.object=e,this.name=t}get $kind(){return 9323}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){const i=this.object.evaluate(e,t,r,n,(128&e)>0?null:s);return 1&e?null==i?i:(null!==s&&s.observeProperty(i,this.name),i[this.name]):(null!==s&&i instanceof Object&&s.observeProperty(i,this.name),i?i[this.name]:"")}assign(e,t,r,n,s){const i=this.object.evaluate(e,t,r,n,null);return i instanceof Object?void 0!==i.$observers&&void 0!==i.$observers[this.name]?i.$observers[this.name].setValue(s,e):i[this.name]=s:this.object.assign(e,t,r,n,{[this.name]:s}),s}accept(e){return e.visitAccessMember(this)}toString(){return y.unparse(this)}}class A{constructor(e,t){this.object=e,this.key=t}get $kind(){return 9324}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){const i=this.object.evaluate(e,t,r,n,(128&e)>0?null:s);if(i instanceof Object){const o=this.key.evaluate(e,t,r,n,(128&e)>0?null:s);return null!==s&&s.observeProperty(i,o),i[o]}}assign(e,t,r,n,s){return this.object.evaluate(e,t,r,n,null)[this.key.evaluate(e,t,r,n,null)]=s}accept(e){return e.visitAccessKeyed(this)}toString(){return y.unparse(this)}}class ${constructor(e,t,r=0,n=!1){this.name=e,this.args=t,this.ancestor=r,this.accessHostScope=n}get $kind(){return 1448}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,i){t=x(this.accessHostScope,t,r);const o=this.args.map((s=>s.evaluate(e,t,r,n,i))),a=s.get(t,this.name,this.ancestor,e,r),u=H(e,a,this.name);if(u)return u.apply(a,o)}assign(e,t,r,n,s){}accept(e){return e.visitCallScope(this)}toString(){return y.unparse(this)}}class E{constructor(e,t,r){this.object=e,this.name=t,this.args=r}get $kind(){return 1161}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){const i=this.object.evaluate(e,t,r,n,(128&e)>0?null:s),o=this.args.map((i=>i.evaluate(e,t,r,n,s))),a=H(e,i,this.name);if(a)return a.apply(i,o)}assign(e,t,r,n,s){}accept(e){return e.visitCallMember(this)}toString(){return y.unparse(this)}}class B{constructor(e,t){this.func=e,this.args=t}get $kind(){return 1162}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){const i=this.func.evaluate(e,t,r,n,s);if("function"==typeof i)return i(...this.args.map((i=>i.evaluate(e,t,r,n,s))));if(8&e||null!=i)throw new Error("Expression is not a function.")}assign(e,t,r,n,s){}accept(e){return e.visitCallFunction(this)}toString(){return y.unparse(this)}}class I{constructor(e,t,r){this.operation=e,this.left=t,this.right=r}get $kind(){return 46}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(t,r,n,s,i){switch(this.operation){case"&&":return this.left.evaluate(t,r,n,s,i)&&this.right.evaluate(t,r,n,s,i);case"||":return this.left.evaluate(t,r,n,s,i)||this.right.evaluate(t,r,n,s,i);case"==":return this.left.evaluate(t,r,n,s,i)==this.right.evaluate(t,r,n,s,i);case"===":return this.left.evaluate(t,r,n,s,i)===this.right.evaluate(t,r,n,s,i);case"!=":return this.left.evaluate(t,r,n,s,i)!=this.right.evaluate(t,r,n,s,i);case"!==":return this.left.evaluate(t,r,n,s,i)!==this.right.evaluate(t,r,n,s,i);case"instanceof":{const e=this.right.evaluate(t,r,n,s,i);return"function"==typeof e&&this.left.evaluate(t,r,n,s,i)instanceof e}case"in":{const e=this.right.evaluate(t,r,n,s,i);return e instanceof Object&&this.left.evaluate(t,r,n,s,i)in e}case"+":{const o=this.left.evaluate(t,r,n,s,i),a=this.right.evaluate(t,r,n,s,i);if((1&t)>0)return o+a;if(!o||!a){if(e.isNumberOrBigInt(o)||e.isNumberOrBigInt(a))return(o||0)+(a||0);if(e.isStringOrDate(o)||e.isStringOrDate(a))return(o||"")+(a||"")}return o+a}case"-":return this.left.evaluate(t,r,n,s,i)-this.right.evaluate(t,r,n,s,i);case"*":return this.left.evaluate(t,r,n,s,i)*this.right.evaluate(t,r,n,s,i);case"/":return this.left.evaluate(t,r,n,s,i)/this.right.evaluate(t,r,n,s,i);case"%":return this.left.evaluate(t,r,n,s,i)%this.right.evaluate(t,r,n,s,i);case"<":return this.left.evaluate(t,r,n,s,i)<this.right.evaluate(t,r,n,s,i);case">":return this.left.evaluate(t,r,n,s,i)>this.right.evaluate(t,r,n,s,i);case"<=":return this.left.evaluate(t,r,n,s,i)<=this.right.evaluate(t,r,n,s,i);case">=":return this.left.evaluate(t,r,n,s,i)>=this.right.evaluate(t,r,n,s,i);default:throw new Error(`Unknown binary operator: '${this.operation}'`)}}assign(e,t,r,n,s){}accept(e){return e.visitBinary(this)}toString(){return y.unparse(this)}}class P{constructor(e,t){this.operation=e,this.expression=t}get $kind(){return 39}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){switch(this.operation){case"void":return void this.expression.evaluate(e,t,r,n,s);case"typeof":return typeof this.expression.evaluate(1|e,t,r,n,s);case"!":return!this.expression.evaluate(e,t,r,n,s);case"-":return-this.expression.evaluate(e,t,r,n,s);case"+":return+this.expression.evaluate(e,t,r,n,s);default:throw new Error(`Unknown unary operator: '${this.operation}'`)}}assign(e,t,r,n,s){}accept(e){return e.visitUnary(this)}toString(){return y.unparse(this)}}class M{constructor(e){this.value=e}get $kind(){return 17925}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){return this.value}assign(e,t,r,n,s){}accept(e){return e.visitPrimitiveLiteral(this)}toString(){return y.unparse(this)}}M.$undefined=new M(void 0),M.$null=new M(null),M.$true=new M(!0),M.$false=new M(!1),M.$empty=new M("");class U{constructor(e){this.elements=e}get $kind(){return 17955}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){return this.elements.map((i=>i.evaluate(e,t,r,n,s)))}assign(e,t,r,n,s){}accept(e){return e.visitArrayLiteral(this)}toString(){return y.unparse(this)}}U.$empty=new U(e.emptyArray);class j{constructor(e,t){this.keys=e,this.values=t}get $kind(){return 17956}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){const i={};for(let o=0;o<this.keys.length;++o)i[this.keys[o]]=this.values[o].evaluate(e,t,r,n,s);return i}assign(e,t,r,n,s){}accept(e){return e.visitObjectLiteral(this)}toString(){return y.unparse(this)}}j.$empty=new j(e.emptyArray,e.emptyArray);class V{constructor(t,r=e.emptyArray){this.cooked=t,this.expressions=r}get $kind(){return 17958}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){let i=this.cooked[0];for(let o=0;o<this.expressions.length;++o)i+=String(this.expressions[o].evaluate(e,t,r,n,s)),i+=this.cooked[o+1];return i}assign(e,t,r,n,s){}accept(e){return e.visitTemplate(this)}toString(){return y.unparse(this)}}V.$empty=new V([""]);class F{constructor(t,r,n,s=e.emptyArray){this.cooked=t,this.func=n,this.expressions=s,t.raw=r}get $kind(){return 1197}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){const i=this.expressions.map((i=>i.evaluate(e,t,r,n,s))),o=this.func.evaluate(e,t,r,n,s);if("function"!=typeof o)throw new Error("Left-hand side of tagged template expression is not a function.");return o(this.cooked,...i)}assign(e,t,r,n,s){}accept(e){return e.visitTaggedTemplate(this)}toString(){return y.unparse(this)}}class _{constructor(e){this.elements=e}get $kind(){return 65556}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){}assign(e,t,r,n,s){}accept(e){return e.visitArrayBindingPattern(this)}toString(){return y.unparse(this)}}class D{constructor(e,t){this.keys=e,this.values=t}get $kind(){return 65557}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){}assign(e,t,r,n,s){}accept(e){return e.visitObjectBindingPattern(this)}toString(){return y.unparse(this)}}class K{constructor(e){this.name=e}get $kind(){return 65558}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){return this.name}accept(e){return e.visitBindingIdentifier(this)}toString(){return y.unparse(this)}}const q=Object.prototype.toString;class N{constructor(e,t){this.declaration=e,this.iterable=t}get $kind(){return 6199}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){return this.iterable.evaluate(e,t,r,n,s)}assign(e,t,r,n,s){}count(e,t){switch(q.call(t)){case"[object Array]":return t.length;case"[object Map]":case"[object Set]":return t.size;case"[object Number]":return t;case"[object Null]":case"[object Undefined]":return 0;default:throw new Error(`Cannot count ${q.call(t)}`)}}iterate(e,t,r){switch(q.call(t)){case"[object Array]":return z(t,r);case"[object Map]":return function(e,t){const r=Array(e.size);let n=-1;for(const t of e.entries())r[++n]=t;z(r,t)}(t,r);case"[object Set]":return function(e,t){const r=Array(e.size);let n=-1;for(const t of e.keys())r[++n]=t;z(r,t)}(t,r);case"[object Number]":return function(e,t){const r=Array(e);for(let t=0;t<e;++t)r[t]=t;z(r,t)}(t,r);case"[object Null]":case"[object Undefined]":return;default:throw new Error(`Cannot iterate over ${q.call(t)}`)}}bind(e,t,r,n){this.iterable.hasBind&&this.iterable.bind(e,t,r,n)}unbind(e,t,r,n){this.iterable.hasUnbind&&this.iterable.unbind(e,t,r,n)}accept(e){return e.visitForOfStatement(this)}toString(){return y.unparse(this)}}class R{constructor(t,r=e.emptyArray){this.parts=t,this.expressions=r,this.isMulti=r.length>1,this.firstExpression=r[0]}get $kind(){return 24}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){if(this.isMulti){let i=this.parts[0];for(let o=0;o<this.expressions.length;++o)i+=String(this.expressions[o].evaluate(e,t,r,n,s)),i+=this.parts[o+1];return i}return`${this.parts[0]}${this.firstExpression.evaluate(e,t,r,n,s)}${this.parts[1]}`}assign(e,t,r,n,s){}accept(e){return e.visitInterpolation(this)}toString(){return y.unparse(this)}}function H(e,t,r){const n=null==t?null:t[r];if("function"==typeof n)return n;if(!(8&e)&&null==n)return null;throw new Error(`Expected '${r}' to be a function`)}function z(e,t){for(let r=0,n=e.length;r<n;++r)t(e,r,e[r])}const Q=Reflect.defineProperty;function W(e,t,r){Q(e,t,{enumerable:!1,configurable:!0,writable:!0,value:r})}function G(e,t,r,n=!1){!n&&Object.prototype.hasOwnProperty.call(e,t)||W(e,t,r)}var Z,J,X,Y,ee,te;function re(e=0){const t=Array(e);let r=0;for(;r<e;)t[r]=r++;return t.deletedItems=[],t.isIndexMap=!0,t}function ne(e){return null==e?se:se(e)}function se(e){const t=e.prototype;Q(t,"subs",{get:oe}),G(t,"subscribe",ae),G(t,"unsubscribe",ue)}exports.BindingMode=void 0,(Z=exports.BindingMode||(exports.BindingMode={}))[Z.oneTime=1]="oneTime",Z[Z.toView=2]="toView",Z[Z.fromView=4]="fromView",Z[Z.twoWay=6]="twoWay",Z[Z.default=8]="default",exports.LifecycleFlags=void 0,(J=exports.LifecycleFlags||(exports.LifecycleFlags={}))[J.none=0]="none",J[J.persistentBindingFlags=961]="persistentBindingFlags",J[J.allowParentScopeTraversal=64]="allowParentScopeTraversal",J[J.observeLeafPropertiesOnly=128]="observeLeafPropertiesOnly",J[J.targetObserverFlags=769]="targetObserverFlags",J[J.noFlush=256]="noFlush",J[J.persistentTargetObserverQueue=512]="persistentTargetObserverQueue",J[J.bindingStrategy=1]="bindingStrategy",J[J.isStrictBindingStrategy=1]="isStrictBindingStrategy",J[J.fromBind=2]="fromBind",J[J.fromUnbind=4]="fromUnbind",J[J.mustEvaluate=8]="mustEvaluate",J[J.isTraversingParentScope=16]="isTraversingParentScope",J[J.dispose=32]="dispose",function(e){e[e.None=0]="None",e[e.Subscriber0=1]="Subscriber0",e[e.Subscriber1=2]="Subscriber1",e[e.Subscriber2=4]="Subscriber2",e[e.SubscribersRest=8]="SubscribersRest",e[e.Any=15]="Any"}(X||(X={})),exports.DelegationStrategy=void 0,(Y=exports.DelegationStrategy||(exports.DelegationStrategy={}))[Y.none=0]="none",Y[Y.capturing=1]="capturing",Y[Y.bubbling=2]="bubbling",exports.CollectionKind=void 0,(ee=exports.CollectionKind||(exports.CollectionKind={}))[ee.indexed=8]="indexed",ee[ee.keyed=4]="keyed",ee[ee.array=9]="array",ee[ee.map=6]="map",ee[ee.set=7]="set",exports.AccessorType=void 0,(te=exports.AccessorType||(exports.AccessorType={}))[te.None=0]="None",te[te.Observer=1]="Observer",te[te.Node=2]="Node",te[te.Layout=4]="Layout",te[te.Primtive=8]="Primtive",te[te.Array=18]="Array",te[te.Set=34]="Set",te[te.Map=66]="Map";class ie{constructor(){this._sf=0,this.count=0}add(e){if(this.has(e))return!1;const t=this._sf;return 0==(1&t)?(this._s0=e,this._sf|=1):0==(2&t)?(this._s1=e,this._sf|=2):0==(4&t)?(this._s2=e,this._sf|=4):0==(8&t)?(this._sr=[e],this._sf|=8):this._sr.push(e),++this.count,!0}has(e){const t=this._sf;if((1&t)>0&&this._s0===e)return!0;if((2&t)>0&&this._s1===e)return!0;if((4&t)>0&&this._s2===e)return!0;if((8&t)>0){const t=this._sr,r=t.length;let n=0;for(;n<r;++n)if(t[n]===e)return!0}return!1}any(){return 0!==this._sf}remove(e){const t=this._sf;if((1&t)>0&&this._s0===e)return this._s0=void 0,this._sf=1^(1|this._sf),--this.count,!0;if((2&t)>0&&this._s1===e)return this._s1=void 0,this._sf=2^(2|this._sf),--this.count,!0;if((4&t)>0&&this._s2===e)return this._s2=void 0,this._sf=4^(4|this._sf),--this.count,!0;if((8&t)>0){const t=this._sr,r=t.length;let n=0;for(;n<r;++n)if(t[n]===e)return t.splice(n,1),1===r&&(this._sf=8^(8|this._sf)),--this.count,!0}return!1}notify(e,t,r){const n=this._s0,s=this._s1,i=this._s2;let o=this._sr;if(void 0!==o&&(o=o.slice()),void 0!==n&&n.handleChange(e,t,r),void 0!==s&&s.handleChange(e,t,r),void 0!==i&&i.handleChange(e,t,r),void 0!==o){const n=o.length;let s,i=0;for(;i<n;++i)s=o[i],void 0!==s&&s.handleChange(e,t,r)}}notifyCollection(e,t){const r=this._s0,n=this._s1,s=this._s2;let i=this._sr;if(void 0!==i&&(i=i.slice()),void 0!==r&&r.handleCollectionChange(e,t),void 0!==n&&n.handleCollectionChange(e,t),void 0!==s&&s.handleCollectionChange(e,t),void 0!==i){const r=i.length;let n,s=0;for(;s<r;++s)n=i[s],void 0!==n&&n.handleCollectionChange(e,t)}}}function oe(){const e=new ie;return W(this,"subs",e),e}function ae(e){return this.subs.add(e)}function ue(e){return this.subs.remove(e)}function ce(e){return null==e?le:le(e)}function le(e){Q(e.prototype,"queue",{get:de})}class he{constructor(){this.flushing=!1,this.items=new Set}get count(){return this.items.size}add(e){if(this.items.add(e),this.flushing)return;this.flushing=!0;const t=this.items;let r;try{for(r of t)t.delete(r),r.flush()}finally{this.flushing=!1}}clear(){this.items.clear(),this.flushing=!1}}function de(){return he.instance}he.instance=new he;class pe{constructor(e){this.owner=e,this.f=0,this.type=18,this.value=this.oldvalue=(this.obj=e.collection).length}getValue(){return this.obj.length}setValue(t,r){const n=this.value;t!==n&&e.isArrayIndex(t)&&(0==(256&r)&&(this.obj.length=t),this.value=t,this.oldvalue=n,this.f=r,this.queue.add(this))}handleCollectionChange(e,t){const r=this.value;(this.value=this.obj.length)!==r&&(this.oldvalue=r,this.f=t,this.queue.add(this))}flush(){ye=this.oldvalue,this.oldvalue=this.value,this.subs.notify(this.value,ye,this.f)}}class fe{constructor(e){this.owner=e,this.f=0,this.value=this.oldvalue=(this.obj=e.collection).size,this.type=this.obj instanceof Map?66:34}getValue(){return this.obj.size}setValue(){throw new Error('Map/Set "size" is a readonly property')}handleCollectionChange(e,t){const r=this.value;(this.value=this.obj.size)!==r&&(this.oldvalue=r,this.f=t,this.queue.add(this))}flush(){ye=this.oldvalue,this.oldvalue=this.value,this.subs.notify(this.value,ye,this.f)}}function ge(e){const t=e.prototype;G(t,"subscribe",ve,!0),G(t,"unsubscribe",be,!0),ce(e),ne(e)}function ve(e){this.subs.add(e)&&1===this.subs.count&&this.owner.subscribe(this)}function be(e){this.subs.remove(e)&&0===this.subs.count&&this.owner.subscribe(this)}let ye;ge(pe),ge(fe);const xe=new WeakMap;function me(e,t){return e===t?0:(e=null===e?"null":e.toString())<(t=null===t?"null":t.toString())?-1:1}function we(e,t){return void 0===e?void 0===t?0:1:void 0===t?-1:0}function Ce(e,t,r,n,s){let i,o,a,u,c,l,h;for(l=r+1;l<n;l++){for(i=e[l],o=t[l],h=l-1;h>=r&&(a=e[h],u=t[h],c=s(a,i),c>0);h--)e[h+1]=a,t[h+1]=u;e[h+1]=i,t[h+1]=o}}function ke(e,t,r,n,s){let i,o,a,u,c,l,h,d,p,f,g,v,b,y,x,m,w,C,k,O=0,S=0;for(;;){if(n-r<=10)return void Ce(e,t,r,n,s);O=r+(n-r>>1),i=e[r],u=t[r],o=e[n-1],c=t[n-1],a=e[O],l=t[O],h=s(i,o),h>0&&(f=i,g=u,i=o,u=c,o=f,c=g),d=s(i,a),d>=0?(f=i,g=u,i=a,u=l,a=o,l=c,o=f,c=g):(p=s(o,a),p>0&&(f=o,g=c,o=a,c=l,a=f,l=g)),e[r]=i,t[r]=u,e[n-1]=a,t[n-1]=l,v=o,b=c,y=r+1,x=n-1,e[O]=e[y],t[O]=t[y],e[y]=v,t[y]=b;e:for(S=y+1;S<x;S++)if(m=e[S],w=t[S],C=s(m,v),C<0)e[S]=e[y],t[S]=t[y],e[y]=m,t[y]=w,y++;else if(C>0){do{if(x--,x==S)break e;k=e[x],C=s(k,v)}while(C>0);e[S]=e[x],t[S]=t[x],e[x]=m,t[x]=w,C<0&&(m=e[S],w=t[S],e[S]=e[y],t[S]=t[y],e[y]=m,t[y]=w,y++)}n-x<y-r?(ke(e,t,x,n,s),n=y):(ke(e,t,r,y,s),r=x)}}const Oe=Array.prototype,Se=Oe.push,Te=Oe.unshift,Le=Oe.pop,Ae=Oe.shift,$e=Oe.splice,Ee=Oe.reverse,Be=Oe.sort,Ie={push:Se,unshift:Te,pop:Le,shift:Ae,splice:$e,reverse:Ee,sort:Be},Pe=["push","unshift","pop","shift","splice","reverse","sort"],Me={push:function(...e){const t=xe.get(this);if(void 0===t)return Se.apply(this,e);const r=this.length,n=e.length;if(0===n)return r;this.length=t.indexMap.length=r+n;let s=r;for(;s<this.length;)this[s]=e[s-r],t.indexMap[s]=-2,s++;return t.notify(),this.length},unshift:function(...e){const t=xe.get(this);if(void 0===t)return Te.apply(this,e);const r=e.length,n=new Array(r);let s=0;for(;s<r;)n[s++]=-2;Te.apply(t.indexMap,n);const i=Te.apply(this,e);return t.notify(),i},pop:function(){const e=xe.get(this);if(void 0===e)return Le.call(this);const t=e.indexMap,r=Le.call(this),n=t.length-1;return t[n]>-1&&t.deletedItems.push(t[n]),Le.call(t),e.notify(),r},shift:function(){const e=xe.get(this);if(void 0===e)return Ae.call(this);const t=e.indexMap,r=Ae.call(this);return t[0]>-1&&t.deletedItems.push(t[0]),Ae.call(t),e.notify(),r},splice:function(...e){const t=e[0],r=e[1],n=xe.get(this);if(void 0===n)return $e.apply(this,e);const s=this.length,i=0|t,o=i<0?Math.max(s+i,0):Math.min(i,s),a=n.indexMap,u=e.length,c=0===u?0:1===u?s-o:r;if(c>0){let e=o;const t=e+c;for(;e<t;)a[e]>-1&&a.deletedItems.push(a[e]),e++}if(u>2){const e=u-2,n=new Array(e);let s=0;for(;s<e;)n[s++]=-2;$e.call(a,t,r,...n)}else $e.apply(a,e);const l=$e.apply(this,e);return n.notify(),l},reverse:function(){const e=xe.get(this);if(void 0===e)return Ee.call(this),this;const t=this.length,r=t/2|0;let n=0;for(;n!==r;){const r=t-n-1,s=this[n],i=e.indexMap[n],o=e.indexMap[r];this[n]=this[r],e.indexMap[n]=o,this[r]=s,e.indexMap[r]=i,n++}return e.notify(),this},sort:function(e){const t=xe.get(this);if(void 0===t)return Be.call(this,e),this;const r=this.length;if(r<2)return this;ke(this,t.indexMap,0,r,we);let n=0;for(;n<r&&void 0!==this[n];)n++;return void 0!==e&&"function"==typeof e||(e=me),ke(this,t.indexMap,0,n,e),t.notify(),this}};for(const e of Pe)Q(Me[e],"observing",{value:!0,writable:!1,configurable:!1,enumerable:!1});let Ue=!1;function je(){for(const e of Pe)!0!==Oe[e].observing&&W(Oe,e,Me[e])}class Ve{constructor(e){this.type=18,Ue||(Ue=!0,je()),this.indexObservers={},this.collection=e,this.indexMap=re(e.length),this.lenObs=void 0,xe.set(e,this)}notify(){const e=this.indexMap;this.indexMap=re(this.collection.length),this.subs.notifyCollection(e,0)}getLengthObserver(){var e;return null!==(e=this.lenObs)&&void 0!==e?e:this.lenObs=new pe(this)}getIndexObserver(e){var t,r;return null!==(t=(r=this.indexObservers)[e])&&void 0!==t?t:r[e]=new Fe(this,e)}}class Fe{constructor(e,t){this.owner=e,this.index=t,this.doNotCache=!0,this.value=this.getValue()}getValue(){return this.owner.collection[this.index]}setValue(e,t){if(e===this.getValue())return;const r=this.owner,n=this.index,s=r.indexMap;s[n]>-1&&s.deletedItems.push(s[n]),s[n]=-2,r.collection[n]=e,r.notify()}handleCollectionChange(e,t){const r=this.index;if(e[r]===r)return;const n=this.value,s=this.value=this.getValue();n!==s&&this.subs.notify(s,n,t)}subscribe(e){this.subs.add(e)&&1===this.subs.count&&this.owner.subscribe(this)}unsubscribe(e){this.subs.remove(e)&&0===this.subs.count&&this.owner.unsubscribe(this)}}function _e(e){let t=xe.get(e);return void 0===t&&(t=new Ve(e)),t}ne(Ve),ne(Fe);const De=new WeakMap,Ke=Set.prototype,qe=Ke.add,Ne=Ke.clear,Re=Ke.delete,He={add:qe,clear:Ne,delete:Re},ze=["add","clear","delete"],Qe={add:function(e){const t=De.get(this);if(void 0===t)return qe.call(this,e),this;const r=this.size;qe.call(this,e);return this.size===r||(t.indexMap[r]=-2,t.notify()),this},clear:function(){const e=De.get(this);if(void 0===e)return Ne.call(this);if(this.size>0){const t=e.indexMap;let r=0;for(const e of this.keys())t[r]>-1&&t.deletedItems.push(t[r]),r++;Ne.call(this),t.length=0,e.notify()}},delete:function(e){const t=De.get(this);if(void 0===t)return Re.call(this,e);if(0===this.size)return!1;let r=0;const n=t.indexMap;for(const s of this.keys()){if(s===e){n[r]>-1&&n.deletedItems.push(n[r]),n.splice(r,1);const s=Re.call(this,e);return!0===s&&t.notify(),s}r++}return!1}},We={writable:!0,enumerable:!1,configurable:!0};for(const e of ze)Q(Qe[e],"observing",{value:!0,writable:!1,configurable:!1,enumerable:!1});let Ge=!1;function Ze(){for(const e of ze)!0!==Ke[e].observing&&Q(Ke,e,{...We,value:Qe[e]})}class Je{constructor(e){this.type=34,Ge||(Ge=!0,Ze()),this.collection=e,this.indexMap=re(e.size),this.lenObs=void 0,De.set(e,this)}notify(){const e=this.indexMap;this.indexMap=re(this.collection.size),this.subs.notifyCollection(e,0)}getLengthObserver(){var e;return null!==(e=this.lenObs)&&void 0!==e?e:this.lenObs=new fe(this)}}function Xe(e){let t=De.get(e);return void 0===t&&(t=new Je(e)),t}ne(Je);const Ye=new WeakMap,et=Map.prototype,tt=et.set,rt=et.clear,nt=et.delete,st={set:tt,clear:rt,delete:nt},it=["set","clear","delete"],ot={set:function(e,t){const r=Ye.get(this);if(void 0===r)return tt.call(this,e,t),this;const n=this.get(e),s=this.size;tt.call(this,e,t);if(this.size===s){let t=0;for(const s of this.entries()){if(s[0]===e)return s[1]!==n&&(r.indexMap.deletedItems.push(r.indexMap[t]),r.indexMap[t]=-2,r.notify()),this;t++}return this}return r.indexMap[s]=-2,r.notify(),this},clear:function(){const e=Ye.get(this);if(void 0===e)return rt.call(this);if(this.size>0){const t=e.indexMap;let r=0;for(const e of this.keys())t[r]>-1&&t.deletedItems.push(t[r]),r++;rt.call(this),t.length=0,e.notify()}},delete:function(e){const t=Ye.get(this);if(void 0===t)return nt.call(this,e);if(0===this.size)return!1;let r=0;const n=t.indexMap;for(const s of this.keys()){if(s===e){n[r]>-1&&n.deletedItems.push(n[r]),n.splice(r,1);const s=nt.call(this,e);return!0===s&&t.notify(),s}++r}return!1}},at={writable:!0,enumerable:!1,configurable:!0};for(const e of it)Q(ot[e],"observing",{value:!0,writable:!1,configurable:!1,enumerable:!1});let ut=!1;function ct(){for(const e of it)!0!==et[e].observing&&Q(et,e,{...at,value:ot[e]})}class lt{constructor(e){this.type=66,ut||(ut=!0,ct()),this.collection=e,this.indexMap=re(e.size),this.lenObs=void 0,Ye.set(e,this)}notify(){const e=this.indexMap;this.indexMap=re(this.collection.size),this.subs.notifyCollection(e,0)}getLengthObserver(){var e;return null!==(e=this.lenObs)&&void 0!==e?e:this.lenObs=new fe(this)}}function ht(e){let t=Ye.get(e);return void 0===t&&(t=new lt(e)),t}function dt(e,t){const r=this.observerLocator.getObserver(e,t);this.obs.add(r)}function pt(){const e=new yt(this);return W(this,"obs",e),e}function ft(e){let t;if(e instanceof Array)t=_e(e);else if(e instanceof Set)t=Xe(e);else{if(!(e instanceof Map))throw new Error("Unrecognised collection type.");t=ht(e)}this.obs.add(t)}function gt(e){this.obs.add(e)}function vt(){throw new Error('method "handleChange" not implemented')}function bt(){throw new Error('method "handleCollectionChange" not implemented')}ne(lt);class yt{constructor(e){this.binding=e,this.version=0,this.count=0,this.slots=0}handleChange(e,t,r){return this.binding.interceptor.handleChange(e,t,r)}handleCollectionChange(e,t){this.binding.interceptor.handleCollectionChange(e,t)}add(e){const t=this.slots;let r=t;for(;r--&&this[`_o${r}`]!==e;);if(-1===r){for(r=0;void 0!==this[`_o${r}`];)r++;this[`_o${r}`]=e,e.subscribe(this),r===t&&(this.slots=r+1),++this.count}this[`_v${r}`]=this.version}clear(e){const t=this.slots;let r,n,s=0;if(!0===e){for(;s<t;++s)r=`_o${s}`,n=this[r],void 0!==n&&(this[r]=void 0,n.unsubscribe(this));this.count=this.slots=0}else for(;s<t;++s)this[`_v${s}`]!==this.version&&(r=`_o${s}`,n=this[r],void 0!==n&&(this[r]=void 0,n.unsubscribe(this),this.count--))}}function xt(e){const t=e.prototype;return G(t,"observeProperty",dt,!0),G(t,"observeCollection",ft,!0),G(t,"subscribeTo",gt,!0),Q(t,"obs",{get:pt}),G(t,"handleChange",vt),G(t,"handleCollectionChange",bt),e}function mt(e){return null==e?xt:xt(e)}class wt{constructor(e,t,r,n){this.key=e,this.binding=t,this.observerLocator=r,this.locator=n,this.interceptor=this}$bind(){throw new Error("Method not implemented.")}$unbind(){throw new Error("Method not implemented.")}handleChange(e,t,r){this.binding[this.key](e,t,r)}}xt(wt);const Ct=e.DI.createInterface("IExpressionParser",(e=>e.singleton(kt)));class kt{constructor(){this.expressionLookup=Object.create(null),this.forOfLookup=Object.create(null),this.interpolationLookup=Object.create(null)}parse(e,t){switch(t){case 2048:{let r=this.interpolationLookup[e];return void 0===r&&(r=this.interpolationLookup[e]=this.$parse(e,t)),r}case 539:{let r=this.forOfLookup[e];return void 0===r&&(r=this.forOfLookup[e]=this.$parse(e,t)),r}default:{if(0===e.length&&55&t)return M.$empty;let r=this.expressionLookup[e];return void 0===r&&(r=this.expressionLookup[e]=this.$parse(e,t)),r}}}$parse(e,t){return Ft.input=e,Ft.length=e.length,Ft.index=0,Ft.currentChar=e.charCodeAt(0),_t(Ft,0,61,void 0===t?53:t)}}var Ot,St,Tt,Lt;function At(e){switch(e){case 98:return 8;case 116:return 9;case 110:return 10;case 118:return 11;case 102:return 12;case 114:return 13;case 34:return 34;case 39:return 39;case 92:return 92;default:return e}}exports.Char=void 0,(Ot=exports.Char||(exports.Char={}))[Ot.Null=0]="Null",Ot[Ot.Backspace=8]="Backspace",Ot[Ot.Tab=9]="Tab",Ot[Ot.LineFeed=10]="LineFeed",Ot[Ot.VerticalTab=11]="VerticalTab",Ot[Ot.FormFeed=12]="FormFeed",Ot[Ot.CarriageReturn=13]="CarriageReturn",Ot[Ot.Space=32]="Space",Ot[Ot.Exclamation=33]="Exclamation",Ot[Ot.DoubleQuote=34]="DoubleQuote",Ot[Ot.Dollar=36]="Dollar",Ot[Ot.Percent=37]="Percent",Ot[Ot.Ampersand=38]="Ampersand",Ot[Ot.SingleQuote=39]="SingleQuote",Ot[Ot.OpenParen=40]="OpenParen",Ot[Ot.CloseParen=41]="CloseParen",Ot[Ot.Asterisk=42]="Asterisk",Ot[Ot.Plus=43]="Plus",Ot[Ot.Comma=44]="Comma",Ot[Ot.Minus=45]="Minus",Ot[Ot.Dot=46]="Dot",Ot[Ot.Slash=47]="Slash",Ot[Ot.Semicolon=59]="Semicolon",Ot[Ot.Backtick=96]="Backtick",Ot[Ot.OpenBracket=91]="OpenBracket",Ot[Ot.Backslash=92]="Backslash",Ot[Ot.CloseBracket=93]="CloseBracket",Ot[Ot.Caret=94]="Caret",Ot[Ot.Underscore=95]="Underscore",Ot[Ot.OpenBrace=123]="OpenBrace",Ot[Ot.Bar=124]="Bar",Ot[Ot.CloseBrace=125]="CloseBrace",Ot[Ot.Colon=58]="Colon",Ot[Ot.LessThan=60]="LessThan",Ot[Ot.Equals=61]="Equals",Ot[Ot.GreaterThan=62]="GreaterThan",Ot[Ot.Question=63]="Question",Ot[Ot.Zero=48]="Zero",Ot[Ot.One=49]="One",Ot[Ot.Two=50]="Two",Ot[Ot.Three=51]="Three",Ot[Ot.Four=52]="Four",Ot[Ot.Five=53]="Five",Ot[Ot.Six=54]="Six",Ot[Ot.Seven=55]="Seven",Ot[Ot.Eight=56]="Eight",Ot[Ot.Nine=57]="Nine",Ot[Ot.UpperA=65]="UpperA",Ot[Ot.UpperB=66]="UpperB",Ot[Ot.UpperC=67]="UpperC",Ot[Ot.UpperD=68]="UpperD",Ot[Ot.UpperE=69]="UpperE",Ot[Ot.UpperF=70]="UpperF",Ot[Ot.UpperG=71]="UpperG",Ot[Ot.UpperH=72]="UpperH",Ot[Ot.UpperI=73]="UpperI",Ot[Ot.UpperJ=74]="UpperJ",Ot[Ot.UpperK=75]="UpperK",Ot[Ot.UpperL=76]="UpperL",Ot[Ot.UpperM=77]="UpperM",Ot[Ot.UpperN=78]="UpperN",Ot[Ot.UpperO=79]="UpperO",Ot[Ot.UpperP=80]="UpperP",Ot[Ot.UpperQ=81]="UpperQ",Ot[Ot.UpperR=82]="UpperR",Ot[Ot.UpperS=83]="UpperS",Ot[Ot.UpperT=84]="UpperT",Ot[Ot.UpperU=85]="UpperU",Ot[Ot.UpperV=86]="UpperV",Ot[Ot.UpperW=87]="UpperW",Ot[Ot.UpperX=88]="UpperX",Ot[Ot.UpperY=89]="UpperY",Ot[Ot.UpperZ=90]="UpperZ",Ot[Ot.LowerA=97]="LowerA",Ot[Ot.LowerB=98]="LowerB",Ot[Ot.LowerC=99]="LowerC",Ot[Ot.LowerD=100]="LowerD",Ot[Ot.LowerE=101]="LowerE",Ot[Ot.LowerF=102]="LowerF",Ot[Ot.LowerG=103]="LowerG",Ot[Ot.LowerH=104]="LowerH",Ot[Ot.LowerI=105]="LowerI",Ot[Ot.LowerJ=106]="LowerJ",Ot[Ot.LowerK=107]="LowerK",Ot[Ot.LowerL=108]="LowerL",Ot[Ot.LowerM=109]="LowerM",Ot[Ot.LowerN=110]="LowerN",Ot[Ot.LowerO=111]="LowerO",Ot[Ot.LowerP=112]="LowerP",Ot[Ot.LowerQ=113]="LowerQ",Ot[Ot.LowerR=114]="LowerR",Ot[Ot.LowerS=115]="LowerS",Ot[Ot.LowerT=116]="LowerT",Ot[Ot.LowerU=117]="LowerU",Ot[Ot.LowerV=118]="LowerV",Ot[Ot.LowerW=119]="LowerW",Ot[Ot.LowerX=120]="LowerX",Ot[Ot.LowerY=121]="LowerY",Ot[Ot.LowerZ=122]="LowerZ",exports.Access=void 0,(St=exports.Access||(exports.Access={}))[St.Reset=0]="Reset",St[St.Ancestor=511]="Ancestor",St[St.This=512]="This",St[St.Scope=1024]="Scope",St[St.Member=2048]="Member",St[St.Keyed=4096]="Keyed",exports.Precedence=void 0,(Tt=exports.Precedence||(exports.Precedence={}))[Tt.Variadic=61]="Variadic",Tt[Tt.Assign=62]="Assign",Tt[Tt.Conditional=63]="Conditional",Tt[Tt.LogicalOR=64]="LogicalOR",Tt[Tt.LogicalAND=128]="LogicalAND",Tt[Tt.Equality=192]="Equality",Tt[Tt.Relational=256]="Relational",Tt[Tt.Additive=320]="Additive",Tt[Tt.Multiplicative=384]="Multiplicative",Tt[Tt.Binary=448]="Binary",Tt[Tt.LeftHandSide=449]="LeftHandSide",Tt[Tt.Primary=450]="Primary",Tt[Tt.Unary=451]="Unary",function(e){e[e.EOF=1572864]="EOF",e[e.ExpressionTerminal=1048576]="ExpressionTerminal",e[e.AccessScopeTerminal=524288]="AccessScopeTerminal",e[e.ClosingToken=262144]="ClosingToken",e[e.OpeningToken=131072]="OpeningToken",e[e.BinaryOp=65536]="BinaryOp",e[e.UnaryOp=32768]="UnaryOp",e[e.LeftHandSide=16384]="LeftHandSide",e[e.StringOrNumericLiteral=12288]="StringOrNumericLiteral",e[e.NumericLiteral=8192]="NumericLiteral",e[e.StringLiteral=4096]="StringLiteral",e[e.IdentifierName=3072]="IdentifierName",e[e.Keyword=2048]="Keyword",e[e.Identifier=1024]="Identifier",e[e.Contextual=512]="Contextual",e[e.Precedence=448]="Precedence",e[e.Type=63]="Type",e[e.FalseKeyword=2048]="FalseKeyword",e[e.TrueKeyword=2049]="TrueKeyword",e[e.NullKeyword=2050]="NullKeyword",e[e.UndefinedKeyword=2051]="UndefinedKeyword",e[e.ThisScope=3076]="ThisScope",e[e.HostScope=3077]="HostScope",e[e.ParentScope=3078]="ParentScope",e[e.OpenParen=671751]="OpenParen",e[e.OpenBrace=131080]="OpenBrace",e[e.Dot=16393]="Dot",e[e.CloseBrace=1835018]="CloseBrace",e[e.CloseParen=1835019]="CloseParen",e[e.Comma=1572876]="Comma",e[e.OpenBracket=671757]="OpenBracket",e[e.CloseBracket=1835022]="CloseBracket",e[e.Colon=1572879]="Colon",e[e.Question=1572880]="Question",e[e.Ampersand=1572883]="Ampersand",e[e.Bar=1572884]="Bar",e[e.BarBar=1638549]="BarBar",e[e.AmpersandAmpersand=1638614]="AmpersandAmpersand",e[e.EqualsEquals=1638679]="EqualsEquals",e[e.ExclamationEquals=1638680]="ExclamationEquals",e[e.EqualsEqualsEquals=1638681]="EqualsEqualsEquals",e[e.ExclamationEqualsEquals=1638682]="ExclamationEqualsEquals",e[e.LessThan=1638747]="LessThan",e[e.GreaterThan=1638748]="GreaterThan",e[e.LessThanEquals=1638749]="LessThanEquals",e[e.GreaterThanEquals=1638750]="GreaterThanEquals",e[e.InKeyword=1640799]="InKeyword",e[e.InstanceOfKeyword=1640800]="InstanceOfKeyword",e[e.Plus=623009]="Plus",e[e.Minus=623010]="Minus",e[e.TypeofKeyword=34851]="TypeofKeyword",e[e.VoidKeyword=34852]="VoidKeyword",e[e.Asterisk=1638885]="Asterisk",e[e.Percent=1638886]="Percent",e[e.Slash=1638887]="Slash",e[e.Equals=1048616]="Equals",e[e.Exclamation=32809]="Exclamation",e[e.TemplateTail=540714]="TemplateTail",e[e.TemplateContinuation=540715]="TemplateContinuation",e[e.OfKeyword=1051180]="OfKeyword"}(Lt||(Lt={}));const $t=M.$false,Et=M.$true,Bt=M.$null,It=M.$undefined,Pt=S.$this,Mt=S.$host,Ut=S.$parent;var jt;exports.BindingType=void 0,(jt=exports.BindingType||(exports.BindingType={}))[jt.None=0]="None",jt[jt.IgnoreAttr=4096]="IgnoreAttr",jt[jt.Interpolation=2048]="Interpolation",jt[jt.IsRef=5376]="IsRef",jt[jt.IsIterator=512]="IsIterator",jt[jt.IsCustom=256]="IsCustom",jt[jt.IsFunction=128]="IsFunction",jt[jt.IsEvent=64]="IsEvent",jt[jt.IsProperty=32]="IsProperty",jt[jt.IsCommand=16]="IsCommand",jt[jt.IsPropertyCommand=48]="IsPropertyCommand",jt[jt.IsEventCommand=80]="IsEventCommand",jt[jt.DelegationStrategyDelta=6]="DelegationStrategyDelta",jt[jt.Command=15]="Command",jt[jt.OneTimeCommand=49]="OneTimeCommand",jt[jt.ToViewCommand=50]="ToViewCommand",jt[jt.FromViewCommand=51]="FromViewCommand",jt[jt.TwoWayCommand=52]="TwoWayCommand",jt[jt.BindCommand=53]="BindCommand",jt[jt.TriggerCommand=4182]="TriggerCommand",jt[jt.CaptureCommand=4183]="CaptureCommand",jt[jt.DelegateCommand=4184]="DelegateCommand",jt[jt.CallCommand=153]="CallCommand",jt[jt.OptionsCommand=26]="OptionsCommand",jt[jt.ForCommand=539]="ForCommand",jt[jt.CustomCommand=284]="CustomCommand";class Vt{constructor(e){this.input=e,this.index=0,this.startIndex=0,this.lastIndex=0,this.currentToken=1572864,this.tokenValue="",this.assignable=!0,this.length=e.length,this.currentChar=e.charCodeAt(0)}get tokenRaw(){return this.input.slice(this.startIndex,this.index)}}const Ft=new Vt("");function _t(e,t,r,n){if(284===n)return new m(e.input);if(0===e.index){if(2048&n)return function(e){const t=[],r=[],n=e.length;let s="";for(;e.index<n;){switch(e.currentChar){case 36:if(123===e.input.charCodeAt(e.index+1)){t.push(s),s="",e.index+=2,e.currentChar=e.input.charCodeAt(e.index),Kt(e);const n=_t(e,0,61,2048);r.push(n);continue}s+="$";break;case 92:s+=String.fromCharCode(At(qt(e)));break;default:s+=String.fromCharCode(e.currentChar)}qt(e)}if(r.length)return t.push(s),new R(t,r);return null}(e);if(Kt(e),1048576&e.currentToken)throw new Error(`Invalid start of expression: '${e.input}'`)}let s;if(e.assignable=448>r,32768&e.currentToken){const r=Wt[63&e.currentToken];Kt(e),s=new P(r,_t(e,t,449,n)),e.assignable=!1}else{e:switch(e.currentToken){case 3078:e.assignable=!1;do{if(Kt(e),t++,!zt(e,16393)){if(524288&e.currentToken){const e=511&t;s=0===e?Pt:1===e?Ut:new S(e),t=512;break e}throw new Error(`Invalid member expression: '${e.input}'`)}if(16393===e.currentToken)throw new Error(`Double dot and spread operators are not supported: '${e.input}'`);if(1572864===e.currentToken)throw new Error(`Expected identifier: '${e.input}'`)}while(3078===e.currentToken);case 1024:512&n?s=new K(e.tokenValue):(s=new T(e.tokenValue,511&t),t=1024),e.assignable=!0,Kt(e);break;case 3076:e.assignable=!1,Kt(e),s=Pt,t=512;break;case 3077:e.assignable=!1,Kt(e),s=Mt,t=512;break;case 671751:Kt(e),s=_t(e,0,62,n),Qt(e,1835019),t=0;break;case 671757:s=function(e,t,r){Kt(e);const n=new Array;for(;1835022!==e.currentToken;)if(zt(e,1572876)){if(n.push(It),1835022===e.currentToken)break}else{if(n.push(_t(e,t,62,-513&r)),!zt(e,1572876))break;if(1835022===e.currentToken)break}return Qt(e,1835022),512&r?new _(n):(e.assignable=!1,new U(n))}(e,t,n),t=0;break;case 131080:s=function(e,t){const r=new Array,n=new Array;Kt(e);for(;1835018!==e.currentToken;){if(r.push(e.tokenValue),12288&e.currentToken)Kt(e),Qt(e,1572879),n.push(_t(e,0,62,-513&t));else{if(!(3072&e.currentToken))throw new Error(`Invalid or unsupported property definition in object literal: '${e.input}'`);{const{currentChar:r,currentToken:s,index:i}=e;Kt(e),zt(e,1572879)?n.push(_t(e,0,62,-513&t)):(e.currentChar=r,e.currentToken=s,e.index=i,n.push(_t(e,0,450,-513&t)))}}1835018!==e.currentToken&&Qt(e,1572876)}return Qt(e,1835018),512&t?new D(r,n):(e.assignable=!1,new j(r,n))}(e,n),t=0;break;case 540714:s=new V([e.tokenValue]),e.assignable=!1,Kt(e),t=0;break;case 540715:s=Dt(e,t,n,s,!1),t=0;break;case 4096:case 8192:s=new M(e.tokenValue),e.assignable=!1,Kt(e),t=0;break;case 2050:case 2051:case 2049:case 2048:s=Wt[63&e.currentToken],e.assignable=!1,Kt(e),t=0;break;default:throw e.index>=e.length?new Error(`Unexpected end of expression: '${e.input}'`):new Error(`Unconsumed token: '${e.input}'`)}if(512&n)return function(e,t){if(0==(65536&t.$kind))throw new Error(`Invalid BindingIdentifier at left hand side of "of": '${e.input}'`);if(1051180!==e.currentToken)throw new Error(`Invalid BindingIdentifier at left hand side of "of": '${e.input}'`);Kt(e);const r=t,n=_t(e,0,61,0);return new N(r,n)}(e,s);if(449<r)return s;let i=e.tokenValue;for(;(16384&e.currentToken)>0;){const r=[];let o;switch(e.currentToken){case 16393:if(e.assignable=!0,Kt(e),0==(3072&e.currentToken))throw new Error(`Expected identifier: '${e.input}'`);if(i=e.tokenValue,Kt(e),t=(1536&t)<<1|2048&t|(4096&t)>>1,671751===e.currentToken){0===t&&(t=2048);continue}s=1024&t?new T(i,s.ancestor,s===Mt):new L(s,i);continue;case 671757:e.assignable=!0,Kt(e),t=4096,s=new A(s,_t(e,0,62,n)),Qt(e,1835022);break;case 671751:for(e.assignable=!1,Kt(e);1835019!==e.currentToken&&(r.push(_t(e,0,62,n)),zt(e,1572876)););Qt(e,1835019),s=1024&t?new $(i,r,s.ancestor,s===Mt):2048&t?new E(s,i,r):new B(s,r),t=0;break;case 540714:e.assignable=!1,o=[e.tokenValue],s=new F(o,o,s),Kt(e);break;case 540715:s=Dt(e,t,n,s,!0)}}}if(448<r)return s;for(;(65536&e.currentToken)>0;){const i=e.currentToken;if((448&i)<=r)break;Kt(e),s=new I(Wt[63&i],s,_t(e,t,448&i,n)),e.assignable=!1}if(63<r)return s;if(zt(e,1572880)){const r=_t(e,t,62,n);Qt(e,1572879),s=new O(s,r,_t(e,t,62,n)),e.assignable=!1}if(62<r)return s;if(zt(e,1048616)){if(!e.assignable)throw new Error(`Left hand side of expression is not assignable: '${e.input}'`);s=new k(s,_t(e,t,62,n))}if(61<r)return s;for(;zt(e,1572884);){if(1572864===e.currentToken)throw new Error(`Expected identifier to come after ValueConverter operator: '${e.input}'`);const r=e.tokenValue;Kt(e);const i=new Array;for(;zt(e,1572879);)i.push(_t(e,t,62,n));s=new C(s,r,i)}for(;zt(e,1572883);){if(1572864===e.currentToken)throw new Error(`Expected identifier to come after BindingBehavior operator: '${e.input}'`);const r=e.tokenValue;Kt(e);const i=new Array;for(;zt(e,1572879);)i.push(_t(e,t,62,n));s=new w(s,r,i)}if(1572864!==e.currentToken){if(2048&n)return s;if("of"===e.tokenRaw)throw new Error(`Unexpected keyword "of": '${e.input}'`);throw new Error(`Unconsumed token: '${e.input}'`)}return s}function Dt(e,t,r,n,s){const i=[e.tokenValue];Qt(e,540715);const o=[_t(e,t,62,r)];for(;540714!==(e.currentToken=Ht(e));)i.push(e.tokenValue),Qt(e,540715),o.push(_t(e,t,62,r));return i.push(e.tokenValue),e.assignable=!1,s?(Kt(e),new F(i,i,n,o)):(Kt(e),new V(i,o))}function Kt(e){for(;e.index<e.length;)if(e.startIndex=e.index,null!=(e.currentToken=sr[e.currentChar](e)))return;e.currentToken=1572864}function qt(e){return e.currentChar=e.input.charCodeAt(++e.index)}function Nt(e,t){let r=e.currentChar;if(!1===t){do{r=qt(e)}while(r<=57&&r>=48);if(46!==r)return e.tokenValue=parseInt(e.tokenRaw,10),8192;if(r=qt(e),e.index>=e.length)return e.tokenValue=parseInt(e.tokenRaw.slice(0,-1),10),8192}if(r<=57&&r>=48)do{r=qt(e)}while(r<=57&&r>=48);else e.currentChar=e.input.charCodeAt(--e.index);return e.tokenValue=parseFloat(e.tokenRaw),8192}function Rt(e){let t=!0,r="";for(;96!==qt(e);)if(36===e.currentChar){if(e.index+1<e.length&&123===e.input.charCodeAt(e.index+1)){e.index++,t=!1;break}r+="$"}else if(92===e.currentChar)r+=String.fromCharCode(At(qt(e)));else{if(e.index>=e.length)throw new Error(`Unterminated template string: '${e.input}'`);r+=String.fromCharCode(e.currentChar)}return qt(e),e.tokenValue=r,t?540714:540715}function Ht(e){if(e.index>=e.length)throw new Error(`Unterminated template string: '${e.input}'`);return e.index--,Rt(e)}function zt(e,t){return e.currentToken===t&&(Kt(e),!0)}function Qt(e,t){if(e.currentToken!==t)throw new Error(`Missing expected token: '${e.input}'`);Kt(e)}const Wt=[$t,Et,Bt,It,"$this","$host","$parent","(","{",".","}",")",",","[","]",":","?","'",'"',"&","|","||","&&","==","!=","===","!==","<",">","<=",">=","in","instanceof","+","-","typeof","void","*","%","/","=","!",540714,540715,"of"],Gt=Object.create(null);Gt.true=2049,Gt.null=2050,Gt.false=2048,Gt.undefined=2051,Gt.$this=3076,Gt.$host=3077,Gt.$parent=3078,Gt.in=1640799,Gt.instanceof=1640800,Gt.typeof=34851,Gt.void=34852,Gt.of=1051180;const Zt=[36,0,48,58,65,91,95,0,97,123],Jt=[36,0,65,91,95,0,97,123,170,0,186,0,192,215,216,247,248,697,736,741,7424,7462,7468,7517,7522,7526,7531,7544,7545,7615,7680,7936,8305,0,8319,0,8336,8349,8490,8492,8498,0,8526,0,8544,8585,11360,11392,42786,42888,42891,42927,42928,42936,42999,43008,43824,43867,43868,43877,64256,64263,65313,65339,65345,65371],Xt=[48,58],Yt=[0,33,127,161];function er(e,t,r,n){const s=r.length;for(let i=0;i<s;i+=2){const s=r[i];let o=r[i+1];if(o=o>0?o:s+1,e&&e.fill(n,s,o),t)for(let e=s;e<o;e++)t.add(e)}}function tr(e){return t=>(qt(t),e)}const rr=e=>{throw new Error(`Unexpected character: '${e.input}'`)};rr.notMapped=!0;er(null,new Set,Zt,!0);const nr=new Uint8Array(65535);er(nr,null,Jt,1),er(nr,null,Xt,1);const sr=new Array(65535);sr.fill(rr,0,65535),er(sr,null,Yt,(e=>(qt(e),null))),er(sr,null,Jt,(function(e){for(;nr[qt(e)];);const t=Gt[e.tokenValue=e.tokenRaw];return void 0===t?1024:t})),er(sr,null,Xt,(e=>Nt(e,!1))),sr[34]=sr[39]=e=>function(e){const t=e.currentChar;qt(e);let r=0;const n=new Array;let s=e.index;for(;e.currentChar!==t;)if(92===e.currentChar)n.push(e.input.slice(s,e.index)),qt(e),r=At(e.currentChar),qt(e),n.push(String.fromCharCode(r)),s=e.index;else{if(e.index>=e.length)throw new Error(`Unterminated quote in string literal: '${e.input}'`);qt(e)}const i=e.input.slice(s,e.index);qt(e),n.push(i);const o=n.join("");return e.tokenValue=o,4096}(e),sr[96]=e=>Rt(e),sr[33]=e=>61!==qt(e)?32809:61!==qt(e)?1638680:(qt(e),1638682),sr[61]=e=>61!==qt(e)?1048616:61!==qt(e)?1638679:(qt(e),1638681),sr[38]=e=>38!==qt(e)?1572883:(qt(e),1638614),sr[124]=e=>124!==qt(e)?1572884:(qt(e),1638549),sr[46]=e=>qt(e)<=57&&e.currentChar>=48?Nt(e,!0):16393,sr[60]=e=>61!==qt(e)?1638747:(qt(e),1638749),sr[62]=e=>61!==qt(e)?1638748:(qt(e),1638750),sr[37]=tr(1638886),sr[40]=tr(671751),sr[41]=tr(1835019),sr[42]=tr(1638885),sr[43]=tr(623009),sr[44]=tr(1572876),sr[45]=tr(623010),sr[47]=tr(1638887),sr[58]=tr(1572879),sr[63]=tr(1572880),sr[91]=tr(671757),sr[93]=tr(1835022),sr[123]=tr(131080),sr[125]=tr(1835018);let ir=null;const or=[];let ar=!1;function ur(){return ir}function cr(e){if(null==e)throw new Error("Connectable cannot be null/undefined");if(null==ir)return ir=e,or[0]=ir,void(ar=!0);if(ir===e)throw new Error("Trying to enter an active connectable");or.push(ir),ir=e,ar=!0}function lr(e){if(null==e)throw new Error("Connectable cannot be null/undefined");if(ir!==e)throw new Error("Trying to exit an unactive connectable");or.pop(),ir=or.length>0?or[or.length-1]:null,ar=null!=ir}const hr=Object.freeze({get current(){return ir},get connecting(){return ar},enter:cr,exit:lr,pause:function(){ar=!1},resume:function(){ar=!0}}),dr=Reflect.get,pr=Object.prototype.toString,fr=new WeakMap;function gr(e){switch(pr.call(e)){case"[object Object]":case"[object Array]":case"[object Map]":case"[object Set]":return!0;default:return!1}}const vr="__raw__";function br(e){return gr(e)?yr(e):e}function yr(e){var t;return null!==(t=fr.get(e))&&void 0!==t?t:function(e){const t=e instanceof Array?kr:e instanceof Map||e instanceof Set?zr:Cr,r=new Proxy(e,t);return fr.set(e,r),r}(e)}function xr(e){var t;return null!==(t=e.__raw__)&&void 0!==t?t:e}function mr(e){return gr(e)&&e.__raw__||e}function wr(e){return"constructor"===e||"__proto__"===e||"$observers"===e||e===Symbol.toPrimitive||e===Symbol.toStringTag}const Cr={get(e,t,r){if(t===vr)return e;const n=ur();return!ar||wr(t)||null==n?dr(e,t,r):(n.observeProperty(e,t),br(dr(e,t,r)))}},kr={get(e,t,r){if(t===vr)return e;const n=ur();if(!ar||wr(t)||null==n)return dr(e,t,r);switch(t){case"length":return n.observeProperty(e,"length"),e.length;case"map":return Or;case"includes":return Lr;case"indexOf":return Ar;case"lastIndexOf":return $r;case"every":return Sr;case"filter":return Tr;case"find":return Br;case"findIndex":return Er;case"flat":return Ir;case"flatMap":return Pr;case"join":return Mr;case"push":return jr;case"pop":return Ur;case"reduce":return Rr;case"reduceRight":return Hr;case"reverse":return Dr;case"shift":return Vr;case"unshift":return Fr;case"slice":return Nr;case"splice":return _r;case"some":return Kr;case"sort":return qr;case"keys":return en;case"values":case Symbol.iterator:return tn;case"entries":return rn}return n.observeProperty(e,t),br(dr(e,t,r))},ownKeys(e){var t;return null===(t=ur())||void 0===t||t.observeProperty(e,"length"),Reflect.ownKeys(e)}};function Or(e,t){var r;const n=xr(this),s=n.map(((r,n)=>mr(e.call(t,br(r),n,this))));return null===(r=ur())||void 0===r||r.observeCollection(n),br(s)}function Sr(e,t){var r;const n=xr(this),s=n.every(((r,n)=>e.call(t,br(r),n,this)));return null===(r=ur())||void 0===r||r.observeCollection(n),s}function Tr(e,t){var r;const n=xr(this),s=n.filter(((r,n)=>mr(e.call(t,br(r),n,this))));return null===(r=ur())||void 0===r||r.observeCollection(n),br(s)}function Lr(e){var t;const r=xr(this),n=r.includes(mr(e));return null===(t=ur())||void 0===t||t.observeCollection(r),n}function Ar(e){var t;const r=xr(this),n=r.indexOf(mr(e));return null===(t=ur())||void 0===t||t.observeCollection(r),n}function $r(e){var t;const r=xr(this),n=r.lastIndexOf(mr(e));return null===(t=ur())||void 0===t||t.observeCollection(r),n}function Er(e,t){var r;const n=xr(this),s=n.findIndex(((r,n)=>mr(e.call(t,br(r),n,this))));return null===(r=ur())||void 0===r||r.observeCollection(n),s}function Br(e,t){var r;const n=xr(this),s=n.find(((t,r)=>e(br(t),r,this)),t);return null===(r=ur())||void 0===r||r.observeCollection(n),br(s)}function Ir(){var e;const t=xr(this);return null===(e=ur())||void 0===e||e.observeCollection(t),br(t.flat())}function Pr(e,t){var r;const n=xr(this);return null===(r=ur())||void 0===r||r.observeCollection(n),yr(n.flatMap(((r,n)=>br(e.call(t,br(r),n,this)))))}function Mr(e){var t;const r=xr(this);return null===(t=ur())||void 0===t||t.observeCollection(r),r.join(e)}function Ur(){return br(xr(this).pop())}function jr(...e){return xr(this).push(...e)}function Vr(){return br(xr(this).shift())}function Fr(...e){return xr(this).unshift(...e)}function _r(...e){return br(xr(this).splice(...e))}function Dr(...e){var t;const r=xr(this),n=r.reverse();return null===(t=ur())||void 0===t||t.observeCollection(r),br(n)}function Kr(e,t){var r;const n=xr(this),s=n.some(((r,n)=>mr(e.call(t,br(r),n,this))));return null===(r=ur())||void 0===r||r.observeCollection(n),s}function qr(e){var t;const r=xr(this),n=r.sort(e);return null===(t=ur())||void 0===t||t.observeCollection(r),br(n)}function Nr(e,t){var r;const n=xr(this);return null===(r=ur())||void 0===r||r.observeCollection(n),yr(n.slice(e,t))}function Rr(e,t){var r;const n=xr(this),s=n.reduce(((t,r,n)=>e(t,br(r),n,this)),t);return null===(r=ur())||void 0===r||r.observeCollection(n),br(s)}function Hr(e,t){var r;const n=xr(this),s=n.reduceRight(((t,r,n)=>e(t,br(r),n,this)),t);return null===(r=ur())||void 0===r||r.observeCollection(n),br(s)}const zr={get(e,t,r){if(t===vr)return e;const n=ur();if(!ar||wr(t)||null==n)return dr(e,t,r);switch(t){case"size":return n.observeProperty(e,"size"),e.size;case"clear":return Xr;case"delete":return Yr;case"forEach":return Qr;case"add":if(e instanceof Set)return Jr;break;case"get":if(e instanceof Map)return Gr;break;case"set":if(e instanceof Map)return Zr;break;case"has":return Wr;case"keys":return en;case"values":return tn;case"entries":return rn;case Symbol.iterator:return e instanceof Map?rn:tn}return br(dr(e,t,r))}};function Qr(e,t){var r;const n=xr(this);return null===(r=ur())||void 0===r||r.observeCollection(n),n.forEach(((r,n)=>{e.call(t,br(r),br(n),this)}))}function Wr(e){var t;const r=xr(this);return null===(t=ur())||void 0===t||t.observeCollection(r),r.has(mr(e))}function Gr(e){var t;const r=xr(this);return null===(t=ur())||void 0===t||t.observeCollection(r),br(r.get(mr(e)))}function Zr(e,t){return br(xr(this).set(mr(e),mr(t)))}function Jr(e){return br(xr(this).add(mr(e)))}function Xr(){return br(xr(this).clear())}function Yr(e){return br(xr(this).delete(mr(e)))}function en(){var e;const t=xr(this);null===(e=ur())||void 0===e||e.observeCollection(t);const r=t.keys();return{next(){const e=r.next(),t=e.done;return t?{value:void 0,done:t}:{value:br(e.value),done:t}},[Symbol.iterator](){return this}}}function tn(){var e;const t=xr(this);null===(e=ur())||void 0===e||e.observeCollection(t);const r=t.values();return{next(){const e=r.next(),t=e.done;return t?{value:void 0,done:t}:{value:br(e.value),done:t}},[Symbol.iterator](){return this}}}function rn(){var e;const t=xr(this);null===(e=ur())||void 0===e||e.observeCollection(t);const r=t.entries();return{next(){const e=r.next(),t=e.value,n=e.done;return n?{value:void 0,done:n}:{value:[br(t[0]),br(t[1])],done:n}},[Symbol.iterator](){return this}}}const nn=Object.freeze({getProxy:yr,getRaw:xr,wrap:br,unwrap:mr,rawKey:vr});class sn{constructor(e,t,r,n,s){this.obj=e,this.get=t,this.set=r,this.useProxy=n,this.observerLocator=s,this.interceptor=this,this.type=1,this.value=void 0,this.oldValue=void 0,this.running=!1,this.isDirty=!1}static create(e,t,r,n,s){const i=new sn(e,r.get,r.set,s,n),o=()=>i.getValue();return o.getObserver=()=>i,Q(e,t,{enumerable:r.enumerable,configurable:!0,get:o,set:e=>{i.setValue(e,0)}}),i}getValue(){return 0===this.subs.count?this.get.call(this.obj,this):(this.isDirty&&(this.compute(),this.isDirty=!1),this.value)}setValue(e,t){if("function"!=typeof this.set)throw new Error("Property is readonly");e!==this.value&&(this.running=!0,this.set.call(this.obj,e),this.running=!1,this.run())}handleChange(){this.isDirty=!0,this.subs.count>0&&this.run()}handleCollectionChange(){this.isDirty=!0,this.subs.count>0&&this.run()}subscribe(e){this.subs.add(e)&&1===this.subs.count&&(this.compute(),this.isDirty=!1)}unsubscribe(e){this.subs.remove(e)&&0===this.subs.count&&(this.isDirty=!0,this.obs.clear(!0))}flush(){on=this.oldValue,this.oldValue=this.value,this.subs.notify(this.value,on,0)}run(){if(this.running)return;const e=this.value,t=this.compute();this.isDirty=!1,Object.is(t,e)||(this.oldValue=e,this.queue.add(this))}compute(){this.running=!0,this.obs.version++;try{return cr(this),this.value=mr(this.get.call(this.useProxy?br(this.obj):this.obj,this))}finally{this.obs.clear(!1),this.running=!1,lr(this)}}}let on;mt(sn),ne(sn),ce(sn);const an=e.DI.createInterface("IDirtyChecker",(e=>e.singleton(ln))),un={timeoutsPerCheck:25,disabled:!1,throw:!1,resetToDefault(){this.timeoutsPerCheck=6,this.disabled=!1,this.throw=!1}},cn={persistent:!0};class ln{constructor(e){this.platform=e,this.tracked=[],this.task=null,this.elapsedFrames=0,this.check=()=>{if(un.disabled)return;if(++this.elapsedFrames<un.timeoutsPerCheck)return;this.elapsedFrames=0;const e=this.tracked,t=e.length;let r,n=0;for(;n<t;++n)r=e[n],r.isDirty()&&this.queue.add(r)}}createProperty(e,t){if(un.throw)throw new Error(`Property '${t}' is being dirty-checked.`);return new hn(this,e,t)}addProperty(e){this.tracked.push(e),1===this.tracked.length&&(this.task=this.platform.taskQueue.queueTask(this.check,cn))}removeProperty(e){this.tracked.splice(this.tracked.indexOf(e),1),0===this.tracked.length&&(this.task.cancel(),this.task=null)}}ln.inject=[e.IPlatform],ce(ln);class hn{constructor(e,t,r){this.dirtyChecker=e,this.obj=t,this.propertyKey=r,this.oldValue=void 0,this.type=0}getValue(){return this.obj[this.propertyKey]}setValue(e,t){throw new Error(`Trying to set value for property ${this.propertyKey} in dirty checker`)}isDirty(){return this.oldValue!==this.obj[this.propertyKey]}flush(){const e=this.oldValue,t=this.getValue();this.oldValue=t,this.subs.notify(t,e,0)}subscribe(e){this.subs.add(e)&&1===this.subs.count&&(this.oldValue=this.obj[this.propertyKey],this.dirtyChecker.addProperty(this))}unsubscribe(e){this.subs.remove(e)&&0===this.subs.count&&this.dirtyChecker.removeProperty(this)}}ne(hn);class dn{constructor(e,t){this.obj=e,this.propertyKey=t,this.type=0}get doNotCache(){return!0}getValue(){return this.obj[this.propertyKey]}setValue(){}subscribe(){}unsubscribe(){}}class pn{constructor(){this.type=0}getValue(e,t){return e[t]}setValue(e,t,r,n){r[n]=e}}let fn;class gn{constructor(e,t){this.obj=e,this.propertyKey=t,this.value=void 0,this.oldValue=void 0,this.observing=!1,this.type=1,this.f=0}getValue(){return this.value}setValue(e,t){if(this.observing){const r=this.value;if(Object.is(e,r))return;this.value=e,this.oldValue=r,this.f=t,this.queue.add(this)}else this.obj[this.propertyKey]=e}subscribe(e){!1===this.observing&&this.start(),this.subs.add(e)}flush(){fn=this.oldValue,this.oldValue=this.value,this.subs.notify(this.value,fn,this.f)}start(){return!1===this.observing&&(this.observing=!0,this.value=this.obj[this.propertyKey],Q(this.obj,this.propertyKey,{enumerable:!0,configurable:!0,get:()=>this.getValue(),set:e=>{this.setValue(e,0)}})),this}stop(){return this.observing&&(Q(this.obj,this.propertyKey,{enumerable:!0,configurable:!0,writable:!0,value:this.value}),this.observing=!1),this}}class vn{constructor(e,t,r,n){this.type=1,this.v=void 0,this.oV=void 0,this.f=0,this.obj=e,this.s=r;const s=e[t];this.cb="function"==typeof s?s:void 0,this.v=n}getValue(){return this.v}setValue(e,t){var r;"function"==typeof this.s&&(e=this.s(e)),Object.is(e,this.v)||(this.oV=this.v,this.v=e,this.f=t,null===(r=this.cb)||void 0===r||r.call(this.obj,this.v,this.oV,t),this.queue.add(this))}flush(){fn=this.oV,this.oV=this.v,this.subs.notify(this.v,fn,this.f)}}ne(gn),ne(vn),ce(gn),ce(vn);const bn=new pn,yn=e.DI.createInterface("IObserverLocator",(e=>e.singleton(wn))),xn=e.DI.createInterface("INodeObserverLocator",(t=>t.cachedCallback((t=>(t.getAll(e.ILogger).forEach((e=>{e.error("Using default INodeObserverLocator implementation. Will not be able to observe nodes (HTML etc...).")})),new mn)))));class mn{handles(){return!1}getObserver(){return bn}getAccessor(){return bn}}class wn{constructor(e,t){this.dirtyChecker=e,this.nodeObserverLocator=t,this.adapters=[]}addAdapter(e){this.adapters.push(e)}getObserver(e,t){var r,n;return null!==(n=null===(r=e.$observers)||void 0===r?void 0:r[t])&&void 0!==n?n:this.cache(e,t,this.createObserver(e,t))}getAccessor(e,t){var r;const n=null===(r=e.$observers)||void 0===r?void 0:r[t];return void 0!==n?n:this.nodeObserverLocator.handles(e,t,this)?this.nodeObserverLocator.getAccessor(e,t,this):bn}getArrayObserver(e){return _e(e)}getMapObserver(e){return ht(e)}getSetObserver(e){return Xe(e)}createObserver(t,r){var n,s,i,o;if(!(t instanceof Object))return new dn(t,r);if(this.nodeObserverLocator.handles(t,r,this))return this.nodeObserverLocator.getObserver(t,r,this);switch(r){case"length":if(t instanceof Array)return _e(t).getLengthObserver();break;case"size":if(t instanceof Map)return ht(t).getLengthObserver();if(t instanceof Set)return Xe(t).getLengthObserver();break;default:if(t instanceof Array&&e.isArrayIndex(r))return _e(t).getIndexObserver(Number(r))}let a=Object.getOwnPropertyDescriptor(t,r);if(void 0===a){let e=Object.getPrototypeOf(t);for(;null!==e&&(a=Object.getOwnPropertyDescriptor(e,r),void 0===a);)e=Object.getPrototypeOf(e)}if(void 0!==a&&!Object.prototype.hasOwnProperty.call(a,"value")){let e=this.getAdapterObserver(t,r,a);return null==e&&(e=null===(o=null!==(s=null===(n=a.get)||void 0===n?void 0:n.getObserver)&&void 0!==s?s:null===(i=a.set)||void 0===i?void 0:i.getObserver)||void 0===o?void 0:o(t,this)),null==e?a.configurable?sn.create(t,r,a,this,!0):this.dirtyChecker.createProperty(t,r):e}return new gn(t,r)}getAdapterObserver(e,t,r){if(this.adapters.length>0)for(const n of this.adapters){const s=n.getObserver(e,t,r,this);if(null!=s)return s}return null}cache(e,t,r){return!0===r.doNotCache?r:void 0===e.$observers?(Q(e,"$observers",{value:{[t]:r}}),r):e.$observers[t]=r}}wn.inject=[an,xn];const Cn=e.DI.createInterface("IObservation",(e=>e.singleton(kn)));class kn{constructor(e){this.observerLocator=e}static get inject(){return[yn]}run(e){const t=new On(this.observerLocator,e);return t.run(),t}}class On{constructor(e,t){this.observerLocator=e,this.fn=t,this.interceptor=this,this.maxRunCount=10,this.queued=!1,this.running=!1,this.runCount=0,this.stopped=!1}handleChange(){this.queued=!0,this.run()}handleCollectionChange(){this.queued=!0,this.run()}run(){if(this.stopped)throw new Error("Effect has already been stopped");if(!this.running){++this.runCount,this.running=!0,this.queued=!1,++this.obs.version;try{cr(this),this.fn(this)}finally{this.obs.clear(!1),this.running=!1,lr(this)}if(this.queued){if(this.runCount>this.maxRunCount)throw this.runCount=0,new Error("Maximum number of recursive effect run reached. Consider handle effect dependencies differently.");this.run()}else this.runCount=0}}stop(){this.stopped=!0,this.obs.clear(!0)}}mt(On);const Sn={};function Tn(e,t,r,n,s){const i=function(e){return void 0===e.$observers&&Q(e,"$observers",{value:{}}),e.$observers}(e);let o=i[t];return null==o&&(o=new vn(e,r,s,n===Sn?void 0:n),i[t]=o),o}Object.defineProperty(exports,"IPlatform",{enumerable:!0,get:function(){return e.IPlatform}}),Object.defineProperty(exports,"Platform",{enumerable:!0,get:function(){return t.Platform}}),Object.defineProperty(exports,"Task",{enumerable:!0,get:function(){return t.Task}}),Object.defineProperty(exports,"TaskAbortError",{enumerable:!0,get:function(){return t.TaskAbortError}}),Object.defineProperty(exports,"TaskQueue",{enumerable:!0,get:function(){return t.TaskQueue}}),Object.defineProperty(exports,"TaskQueuePriority",{enumerable:!0,get:function(){return t.TaskQueuePriority}}),Object.defineProperty(exports,"TaskStatus",{enumerable:!0,get:function(){return t.TaskStatus}}),exports.AccessKeyedExpression=A,exports.AccessMemberExpression=L,exports.AccessScopeExpression=T,exports.AccessThisExpression=S,exports.ArrayBindingPattern=_,exports.ArrayIndexObserver=Fe,exports.ArrayLiteralExpression=U,exports.ArrayObserver=Ve,exports.AssignExpression=k,exports.BinaryExpression=I,exports.BindingBehavior=f,exports.BindingBehaviorDefinition=h,exports.BindingBehaviorExpression=w,exports.BindingBehaviorFactory=d,exports.BindingContext=s,exports.BindingIdentifier=K,exports.BindingInterceptor=p,exports.BindingMediator=wt,exports.BindingObserverRecord=yt,exports.CallFunctionExpression=B,exports.CallMemberExpression=E,exports.CallScopeExpression=$,exports.CollectionLengthObserver=pe,exports.CollectionSizeObserver=fe,exports.ComputedObserver=sn,exports.ConditionalExpression=O,exports.ConnectableSwitcher=hr,exports.CustomExpression=m,exports.DirtyCheckProperty=hn,exports.DirtyCheckSettings=un,exports.FlushQueue=he,exports.ForOfStatement=N,exports.HtmlLiteralExpression=class{constructor(e){this.parts=e}get $kind(){return 51}get hasBind(){return!1}get hasUnbind(){return!1}evaluate(e,t,r,n,s){let i="";for(let o=0;o<this.parts.length;++o){const a=this.parts[o].evaluate(e,t,r,n,s);null!=a&&(i+=a)}return i}assign(e,t,r,n,s,i){}accept(e){return e.visitHtmlLiteral(this)}toString(){return y.unparse(this)}},exports.IDirtyChecker=an,exports.IExpressionParser=Ct,exports.INodeObserverLocator=xn,exports.IObservation=Cn,exports.IObserverLocator=yn,exports.ISignaler=u,exports.Interpolation=R,exports.MapObserver=lt,exports.ObjectBindingPattern=D,exports.ObjectLiteralExpression=j,exports.Observation=kn,exports.ObserverLocator=wn,exports.OverrideContext=a,exports.ParserState=Vt,exports.PrimitiveLiteralExpression=M,exports.PrimitiveObserver=dn,exports.PropertyAccessor=pn,exports.ProxyObservable=nn,exports.Scope=o,exports.SetObserver=Je,exports.SetterObserver=gn,exports.SubscriberRecord=ie,exports.TaggedTemplateExpression=F,exports.TemplateExpression=V,exports.UnaryExpression=P,exports.ValueConverter=v,exports.ValueConverterDefinition=g,exports.ValueConverterExpression=C,exports.alias=function(...t){return function(r){const n=e.Protocol.annotation.keyFor("aliases"),s=e.Metadata.getOwn(n,r);void 0===s?e.Metadata.define(n,t,r):s.push(...t)}},exports.applyMutationsToIndices=function(e){let t=0,r=0;const n=e.length;for(let s=0;s<n;++s){for(;e.deletedItems[r]<=s-t;)++r,--t;-2===e[s]?++t:e[s]+=t}},exports.bindingBehavior=function(e){return function(t){return f.define(e,t)}},exports.cloneIndexMap=function(e){const t=e.slice();return t.deletedItems=e.deletedItems.slice(),t.isIndexMap=!0,t},exports.connectable=mt,exports.copyIndexMap=function(e,t){const{length:r}=e,n=Array(r);let s=0;for(;s<r;)n[s]=e[s],++s;return n.deletedItems=void 0!==t?t.slice(0):void 0!==e.deletedItems?e.deletedItems.slice(0):[],n.isIndexMap=!0,n},exports.createIndexMap=re,exports.disableArrayObservation=function(){for(const e of Pe)!0===Oe[e].observing&&W(Oe,e,Ie[e])},exports.disableMapObservation=function(){for(const e of it)!0===et[e].observing&&Q(et,e,{...at,value:st[e]})},exports.disableSetObservation=function(){for(const e of ze)!0===Ke[e].observing&&Q(Ke,e,{...We,value:He[e]})},exports.enableArrayObservation=je,exports.enableMapObservation=ct,exports.enableSetObservation=Ze,exports.getCollectionObserver=function(e){let t;return e instanceof Array?t=_e(e):e instanceof Map?t=ht(e):e instanceof Set&&(t=Xe(e)),t},exports.isIndexMap=function(e){return e instanceof Array&&!0===e.isIndexMap},exports.observable=function(e,t,r){return null==t?(t,r,s)=>n(t,r,s,e):n(e,t,r);function n(e,t,r,n){var s;const i=void 0===t;if(n="object"!=typeof n?{name:n}:n||{},i&&(t=n.name),null==t||""===t)throw new Error("Invalid usage, cannot determine property name for @observable");const o=n.callback||`${String(t)}Changed`;let a=Sn;r?(delete r.value,delete r.writable,a=null===(s=r.initializer)||void 0===s?void 0:s.call(r),delete r.initializer):r={configurable:!0},"enumerable"in r||(r.enumerable=!0);const u=n.set;if(r.get=function(){var e;const r=Tn(this,t,o,a,u);return null===(e=ur())||void 0===e||e.subscribeTo(r),r.getValue()},r.set=function(e){Tn(this,t,o,a,u).setValue(e,0)},r.get.getObserver=function(e){return Tn(e,t,o,a,u)},!i)return r;Q(e.prototype,t,r)}},exports.parse=_t,exports.parseExpression=function(e,t){return Ft.input=e,Ft.length=e.length,Ft.index=0,Ft.currentChar=e.charCodeAt(0),_t(Ft,0,61,void 0===t?53:t)},exports.registerAliases=r,exports.subscriberCollection=ne,exports.synchronizeIndices=function(e,t){const r=e.slice(),n=t.length;let s=0,i=0;for(;s<n;)i=t[s],-2!==i&&(e[s]=r[i]),++s},exports.valueConverter=function(e){return function(t){return v.define(e,t)}},exports.withFlushQueue=ce;
